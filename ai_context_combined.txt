Project Root: C:\Users\isy73\boteda-connect-flow
Included Targets: public, supabase, src



============================================================
File Path: .env
============================================================
VITE_SUPABASE_PROJECT_ID="mhqugrephjdofovafohl"
VITE_SUPABASE_PUBLISHABLE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ocXVncmVwaGpkb2ZvdmFmb2hsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1NjUzMjAsImV4cCI6MjA4NDE0MTMyMH0.wIwuiDDn4aLccS2aFXzndvhp7n05prWawT4WZWX5YXs"
VITE_SUPABASE_URL="https://mhqugrephjdofovafohl.supabase.co"




============================================================
File Path: components.json
============================================================
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}



============================================================
File Path: eslint.config.js
============================================================
import js from "@eslint/js";
import globals from "globals";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import tseslint from "typescript-eslint";

export default tseslint.config(
  { ignores: ["dist"] },
  {
    extends: [js.configs.recommended, ...tseslint.configs.recommended],
    files: ["**/*.{ts,tsx}"],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
    plugins: {
      "react-hooks": reactHooks,
      "react-refresh": reactRefresh,
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      "react-refresh/only-export-components": ["warn", { allowConstantExport: true }],
      "@typescript-eslint/no-unused-vars": "off",
    },
  },
);



============================================================
File Path: index.html
============================================================
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Boteda OS - ì°¨ì„¸ëŒ€ ì—”í„°í”„ë¼ì´ì¦ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <meta name="description" content="Boteda Management Solution - ë©€í‹° í…Œë„ŒíŠ¸ ì•„í‚¤í…ì²˜ ê¸°ë°˜ì˜ ì˜¬ì¸ì› ë¹„ì¦ˆë‹ˆìŠ¤ ìš´ì˜ í”Œë«í¼. ì²­êµ¬ ê´€ë¦¬ë¶€í„° ì „ìê²°ì¬, ê·¸ë£¹ì›¨ì–´ê¹Œì§€." />
    <meta name="author" content="Boteda" />
    <meta name="robots" content="index, follow" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <meta property="og:title" content="Boteda OS - ì°¨ì„¸ëŒ€ ì—”í„°í”„ë¼ì´ì¦ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ" />
    <meta property="og:description" content="Boteda Management Solution - ë©€í‹° í…Œë„ŒíŠ¸ ì•„í‚¤í…ì²˜ ê¸°ë°˜ì˜ ì˜¬ì¸ì› ë¹„ì¦ˆë‹ˆìŠ¤ ìš´ì˜ í”Œë«í¼" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@BotedaOS" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>



============================================================
File Path: package.json
============================================================
{
  "name": "vite_react_shadcn_ts",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "build:dev": "vite build --mode development",
    "lint": "eslint .",
    "preview": "vite preview",
    "test": "vitest run",
    "test:watch": "vitest"
  },
  "dependencies": {
    "@hookform/resolvers": "^3.10.0",
    "@radix-ui/react-accordion": "^1.2.11",
    "@radix-ui/react-alert-dialog": "^1.1.14",
    "@radix-ui/react-aspect-ratio": "^1.1.7",
    "@radix-ui/react-avatar": "^1.1.10",
    "@radix-ui/react-checkbox": "^1.3.2",
    "@radix-ui/react-collapsible": "^1.1.11",
    "@radix-ui/react-context-menu": "^2.2.15",
    "@radix-ui/react-dialog": "^1.1.14",
    "@radix-ui/react-dropdown-menu": "^2.1.15",
    "@radix-ui/react-hover-card": "^1.1.14",
    "@radix-ui/react-label": "^2.1.7",
    "@radix-ui/react-menubar": "^1.1.15",
    "@radix-ui/react-navigation-menu": "^1.2.13",
    "@radix-ui/react-popover": "^1.1.14",
    "@radix-ui/react-progress": "^1.1.7",
    "@radix-ui/react-radio-group": "^1.3.7",
    "@radix-ui/react-scroll-area": "^1.2.9",
    "@radix-ui/react-select": "^2.2.5",
    "@radix-ui/react-separator": "^1.1.7",
    "@radix-ui/react-slider": "^1.3.5",
    "@radix-ui/react-slot": "^1.2.3",
    "@radix-ui/react-switch": "^1.2.5",
    "@radix-ui/react-tabs": "^1.1.12",
    "@radix-ui/react-toast": "^1.2.14",
    "@radix-ui/react-toggle": "^1.1.9",
    "@radix-ui/react-toggle-group": "^1.1.10",
    "@radix-ui/react-tooltip": "^1.2.7",
    "@supabase/supabase-js": "^2.90.1",
    "@tanstack/react-query": "^5.83.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.1.1",
    "date-fns": "^3.6.0",
    "embla-carousel-react": "^8.6.0",
    "input-otp": "^1.4.2",
    "lucide-react": "^0.462.0",
    "next-themes": "^0.3.0",
    "react": "^18.3.1",
    "react-day-picker": "^8.10.1",
    "react-dom": "^18.3.1",
    "react-hook-form": "^7.61.1",
    "react-resizable-panels": "^2.1.9",
    "react-router-dom": "^6.30.1",
    "recharts": "^2.15.4",
    "sonner": "^1.7.4",
    "tailwind-merge": "^2.6.0",
    "tailwindcss-animate": "^1.0.7",
    "vaul": "^0.9.9",
    "zod": "^3.25.76"
  },
  "devDependencies": {
    "@eslint/js": "^9.32.0",
    "@tailwindcss/typography": "^0.5.16",
    "@testing-library/jest-dom": "^6.6.0",
    "@testing-library/react": "^16.0.0",
    "@types/node": "^22.16.5",
    "@types/react": "^18.3.23",
    "@types/react-dom": "^18.3.7",
    "@vitejs/plugin-react-swc": "^3.11.0",
    "autoprefixer": "^10.4.21",
    "eslint": "^9.32.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.20",
    "globals": "^15.15.0",
    "jsdom": "^20.0.3",
    "lovable-tagger": "^1.1.13",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.17",
    "typescript": "^5.8.3",
    "typescript-eslint": "^8.38.0",
    "vite": "^5.4.19",
    "vitest": "^3.2.4"
  }
}



============================================================
File Path: postcss.config.js
============================================================
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};



============================================================
File Path: README.md
============================================================
# Welcome to your Lovable project

## Project info

**URL**: https://lovable.dev/projects/REPLACE_WITH_PROJECT_ID

## How can I edit this code?

There are several ways of editing your application.

**Use Lovable**

Simply visit the [Lovable Project](https://lovable.dev/projects/REPLACE_WITH_PROJECT_ID) and start prompting.

Changes made via Lovable will be committed automatically to this repo.

**Use your preferred IDE**

If you want to work locally using your own IDE, you can clone this repo and push changes. Pushed changes will also be reflected in Lovable.

The only requirement is having Node.js & npm installed - [install with nvm](https://github.com/nvm-sh/nvm#installing-and-updating)

Follow these steps:

```sh
# Step 1: Clone the repository using the project's Git URL.
git clone <YOUR_GIT_URL>

# Step 2: Navigate to the project directory.
cd <YOUR_PROJECT_NAME>

# Step 3: Install the necessary dependencies.
npm i

# Step 4: Start the development server with auto-reloading and an instant preview.
npm run dev
```

**Edit a file directly in GitHub**

- Navigate to the desired file(s).
- Click the "Edit" button (pencil icon) at the top right of the file view.
- Make your changes and commit the changes.

**Use GitHub Codespaces**

- Navigate to the main page of your repository.
- Click on the "Code" button (green button) near the top right.
- Select the "Codespaces" tab.
- Click on "New codespace" to launch a new Codespace environment.
- Edit files directly within the Codespace and commit and push your changes once you're done.

## What technologies are used for this project?

This project is built with:

- Vite
- TypeScript
- React
- shadcn-ui
- Tailwind CSS

## How can I deploy this project?

Simply open [Lovable](https://lovable.dev/projects/REPLACE_WITH_PROJECT_ID) and click on Share -> Publish.

## Can I connect a custom domain to my Lovable project?

Yes, you can!

To connect a domain, navigate to Project > Settings > Domains and click Connect Domain.

Read more here: [Setting up a custom domain](https://docs.lovable.dev/features/custom-domain#custom-domain)



============================================================
File Path: tsconfig.app.json
============================================================
{
  "compilerOptions": {
    "types": ["vitest/globals"],
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": false,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noImplicitAny": false,
    "noFallthroughCasesInSwitch": false,

    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"]
}



============================================================
File Path: tsconfig.json
============================================================
{
  "files": [],
  "references": [{ "path": "./tsconfig.app.json" }, { "path": "./tsconfig.node.json" }],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "noImplicitAny": false,
    "noUnusedParameters": false,
    "skipLibCheck": true,
    "allowJs": true,
    "noUnusedLocals": false,
    "strictNullChecks": false
  }
}



============================================================
File Path: tsconfig.node.json
============================================================
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["vite.config.ts"]
}



============================================================
File Path: public/robots.txt
============================================================
User-agent: Googlebot
Allow: /

User-agent: Bingbot
Allow: /

User-agent: Twitterbot
Allow: /

User-agent: facebookexternalhit
Allow: /

User-agent: *
Allow: /



============================================================
File Path: supabase/config.toml
============================================================
project_id = "gvnaphdkhftituwrsfrg"


============================================================
File Path: supabase/.temp/cli-latest
============================================================
v2.72.7


============================================================
File Path: supabase/.temp/gotrue-version
============================================================
v2.185.0


============================================================
File Path: supabase/.temp/pooler-url
============================================================
postgresql://postgres.mhqugrephjdofovafohl@aws-1-ap-northeast-1.pooler.supabase.com:5432/postgres


============================================================
File Path: supabase/.temp/postgres-version
============================================================
17.6.1.063


============================================================
File Path: supabase/.temp/project-ref
============================================================
mhqugrephjdofovafohl


============================================================
File Path: supabase/.temp/rest-version
============================================================
v14.1


============================================================
File Path: supabase/.temp/storage-migration
============================================================
buckets-objects-grants-postgres


============================================================
File Path: supabase/.temp/storage-version
============================================================
v1.33.0


============================================================
File Path: supabase/functions/backup-to-drive/index.ts
============================================================
import { serve } from "https://deno.land/std@0.168.0/http/server.ts";
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
};

interface BackupRequest {
  tenantId: string;
}

serve(async (req) => {
  // Handle CORS preflight
  if (req.method === "OPTIONS") {
    return new Response(null, { headers: corsHeaders });
  }

  try {
    // Verify authorization
    const authHeader = req.headers.get("Authorization");
    if (!authHeader) {
      return new Response(
        JSON.stringify({ error: "Authorization required" }),
        { status: 401, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Initialize Supabase client
    const supabaseUrl = Deno.env.get("SUPABASE_URL")!;
    const supabaseServiceKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")!;
    const supabase = createClient(supabaseUrl, supabaseServiceKey);

    // Verify user token
    const token = authHeader.replace("Bearer ", "");
    const { data: { user }, error: authError } = await supabase.auth.getUser(token);
    
    if (authError || !user) {
      return new Response(
        JSON.stringify({ error: "Invalid token" }),
        { status: 401, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Parse request body
    const { tenantId }: BackupRequest = await req.json();

    if (!tenantId) {
      return new Response(
        JSON.stringify({ error: "Missing required field: tenantId" }),
        { status: 400, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Check user is admin of tenant
    const { data: membership, error: membershipError } = await supabase
      .from("tenant_memberships")
      .select("role")
      .eq("tenant_id", tenantId)
      .eq("user_id", user.id)
      .single();

    if (membershipError || !membership || membership.role !== "company_admin") {
      return new Response(
        JSON.stringify({ error: "Only company admins can create backups" }),
        { status: 403, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Get tenant's Google credentials
    const { data: tenant, error: tenantError } = await supabase
      .from("tenants")
      .select("*")
      .eq("id", tenantId)
      .single();

    if (tenantError || !tenant) {
      return new Response(
        JSON.stringify({ error: "Tenant not found" }),
        { status: 404, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    if (!tenant.google_credentials || !tenant.drive_folder_id) {
      return new Response(
        JSON.stringify({ error: "Google Drive not configured for this tenant" }),
        { status: 400, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Collect all tenant data
    const backupData = await collectTenantData(supabase, tenantId);

    // Decode credentials (base64 -> JSON)
    const credentialsJson = atob(tenant.google_credentials);
    const credentials = JSON.parse(credentialsJson);

    // Get Google access token
    const accessToken = await getGoogleAccessToken(credentials);

    // Create backup folder
    const backupFolderId = await getOrCreateSubfolder(accessToken, tenant.drive_folder_id, "Backups");

    // Generate backup file
    const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
    const fileName = `backup_${tenant.name}_${timestamp}.json`;
    const fileContent = btoa(unescape(encodeURIComponent(JSON.stringify(backupData, null, 2))));

    // Upload to Google Drive
    const driveResult = await uploadToGoogleDrive(
      accessToken,
      backupFolderId,
      fileName,
      fileContent,
      "application/json"
    );

    return new Response(
      JSON.stringify({
        success: true,
        message: "Backup created successfully",
        fileId: driveResult.id,
        fileName: driveResult.name,
        webViewLink: driveResult.webViewLink,
        backupTimestamp: new Date().toISOString(),
        recordCounts: {
          tenant: 1,
          memberships: backupData.memberships.length,
          invoices: backupData.invoices.length,
          attachments: backupData.attachments.length,
        },
      }),
      { headers: { ...corsHeaders, "Content-Type": "application/json" } }
    );
  } catch (err) {
    console.error("Backup error:", err);
    const errorMessage = err instanceof Error ? err.message : "Backup failed";
    return new Response(
      JSON.stringify({ error: errorMessage }),
      { status: 500, headers: { ...corsHeaders, "Content-Type": "application/json" } }
    );
  }
});

// Collect all tenant-related data
// deno-lint-ignore no-explicit-any
async function collectTenantData(supabase: any, tenantId: string) {
  // Get memberships with profile data
  const { data: memberships } = await supabase
    .from("tenant_memberships")
    .select(`
      id,
      role,
      department,
      job_title,
      created_at,
      user_id,
      profiles:user_id (
        email,
        full_name,
        phone
      )
    `)
    .eq("tenant_id", tenantId);

  // Get invoices
  const { data: invoices } = await supabase
    .from("vendor_invoices")
    .select("*")
    .eq("tenant_id", tenantId);

  // Get attachments for invoices
  // deno-lint-ignore no-explicit-any
  const invoiceIds = invoices?.map((i: any) => i.id) || [];
  const { data: attachments } = await supabase
    .from("invoice_attachments")
    .select("*")
    .in("invoice_id", invoiceIds.length > 0 ? invoiceIds : ["none"]);

  return {
    backupVersion: "1.0",
    createdAt: new Date().toISOString(),
    tenantId,
    memberships: memberships || [],
    invoices: invoices || [],
    attachments: attachments || [],
  };
}

// Get Google OAuth2 access token using service account
async function getGoogleAccessToken(credentials: {
  client_email: string;
  private_key: string;
}): Promise<string> {
  const now = Math.floor(Date.now() / 1000);
  const payload = {
    iss: credentials.client_email,
    scope: "https://www.googleapis.com/auth/drive.file",
    aud: "https://oauth2.googleapis.com/token",
    iat: now,
    exp: now + 3600,
  };

  const header = { alg: "RS256", typ: "JWT" };
  const encodedHeader = base64UrlEncode(JSON.stringify(header));
  const encodedPayload = base64UrlEncode(JSON.stringify(payload));
  const signatureInput = `${encodedHeader}.${encodedPayload}`;

  const privateKey = await crypto.subtle.importKey(
    "pkcs8",
    pemToArrayBuffer(credentials.private_key),
    { name: "RSASSA-PKCS1-v1_5", hash: "SHA-256" },
    false,
    ["sign"]
  );

  const signature = await crypto.subtle.sign(
    "RSASSA-PKCS1-v1_5",
    privateKey,
    new TextEncoder().encode(signatureInput)
  );

  const encodedSignature = base64UrlEncode(String.fromCharCode(...new Uint8Array(signature)));
  const jwt = `${signatureInput}.${encodedSignature}`;

  const tokenResponse = await fetch("https://oauth2.googleapis.com/token", {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body: new URLSearchParams({
      grant_type: "urn:ietf:params:oauth:grant-type:jwt-bearer",
      assertion: jwt,
    }),
  });

  const tokenData = await tokenResponse.json();
  if (!tokenData.access_token) {
    throw new Error("Failed to get Google access token");
  }

  return tokenData.access_token;
}

// Upload file to Google Drive
async function uploadToGoogleDrive(
  accessToken: string,
  folderId: string,
  fileName: string,
  fileContent: string,
  mimeType: string
): Promise<{ id: string; name: string; webViewLink: string }> {
  const binaryContent = Uint8Array.from(atob(fileContent), (c) => c.charCodeAt(0));

  const boundary = "---MultipartBoundary" + Date.now();
  const metadata = { name: fileName, parents: [folderId] };
  const metadataPart = JSON.stringify(metadata);

  const multipartBody = new Uint8Array([
    ...new TextEncoder().encode(
      `--${boundary}\r\nContent-Type: application/json; charset=UTF-8\r\n\r\n${metadataPart}\r\n--${boundary}\r\nContent-Type: ${mimeType}\r\nContent-Transfer-Encoding: base64\r\n\r\n`
    ),
    ...binaryContent,
    ...new TextEncoder().encode(`\r\n--${boundary}--`),
  ]);

  const response = await fetch(
    "https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,webViewLink",
    {
      method: "POST",
      headers: {
        Authorization: `Bearer ${accessToken}`,
        "Content-Type": `multipart/related; boundary=${boundary}`,
      },
      body: multipartBody,
    }
  );

  if (!response.ok) {
    const error = await response.text();
    throw new Error(`Google Drive upload failed: ${error}`);
  }

  return response.json();
}

// Get or create subfolder
async function getOrCreateSubfolder(
  accessToken: string,
  parentId: string,
  folderName: string
): Promise<string> {
  const searchResponse = await fetch(
    `https://www.googleapis.com/drive/v3/files?q=name='${encodeURIComponent(folderName)}' and '${parentId}' in parents and mimeType='application/vnd.google-apps.folder' and trashed=false`,
    { headers: { Authorization: `Bearer ${accessToken}` } }
  );

  const searchResult = await searchResponse.json();
  if (searchResult.files && searchResult.files.length > 0) {
    return searchResult.files[0].id;
  }

  const createResponse = await fetch("https://www.googleapis.com/drive/v3/files", {
    method: "POST",
    headers: {
      Authorization: `Bearer ${accessToken}`,
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      name: folderName,
      mimeType: "application/vnd.google-apps.folder",
      parents: [parentId],
    }),
  });

  const folder = await createResponse.json();
  return folder.id;
}

function base64UrlEncode(str: string): string {
  return btoa(str).replace(/\+/g, "-").replace(/\//g, "_").replace(/=+$/, "");
}

function pemToArrayBuffer(pem: string): ArrayBuffer {
  const b64 = pem
    .replace(/-----BEGIN PRIVATE KEY-----/, "")
    .replace(/-----END PRIVATE KEY-----/, "")
    .replace(/\s/g, "");
  const binary = atob(b64);
  const buffer = new ArrayBuffer(binary.length);
  const view = new Uint8Array(buffer);
  for (let i = 0; i < binary.length; i++) {
    view[i] = binary.charCodeAt(i);
  }
  return buffer;
}



============================================================
File Path: supabase/functions/polish-text/index.ts
============================================================
import { serve } from "https://deno.land/std@0.168.0/http/server.ts";
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
};

serve(async (req) => {
  // CORS í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ ì²˜ë¦¬
  if (req.method === "OPTIONS") {
    return new Response("ok", { headers: corsHeaders });
  }

  try {
    console.log("ğŸš€ Edge Function 'polish-text' ì‹œì‘ë¨");

    // 1. Supabase Admin í´ë¼ì´ì–¸íŠ¸ ìƒì„±
    // Supabaseê°€ ìë™ìœ¼ë¡œ ì£¼ì…í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜ í™•ì¸
    const supabaseUrl = Deno.env.get("DB_URL") ?? Deno.env.get("SUPABASE_URL");
    const supabaseServiceKey = Deno.env.get("DB_ADMIN_KEY") ?? Deno.env.get("SUPABASE_SERVICE_ROLE_KEY");

    if (!supabaseUrl || !supabaseServiceKey) {
      throw new Error("ê´€ë¦¬ì ë¹„ë°€í‚¤(DB_ADMIN_KEY)ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    }

    const supabaseAdmin = createClient(supabaseUrl, supabaseServiceKey);

    // 2. DBì—ì„œ ì„¤ì • ê°’(í† í°, ëª¨ë¸) ê°€ì ¸ì˜¤ê¸°
    console.log("ğŸ” DBì—ì„œ ì‹œìŠ¤í…œ ì„¤ì • ì¡°íšŒ ì¤‘...");
    const { data: configs, error: configError } = await supabaseAdmin
      .from("system_configs")
      .select("key, value")
      .in("key", ["huggingface_token", "huggingface_model"]);

    if (configError) {
      console.error("âŒ DB ì¡°íšŒ ì—ëŸ¬:", configError);
      throw new Error("ì‹œìŠ¤í…œ ì„¤ì •ì„ DBì—ì„œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    if (!configs || configs.length === 0) {
      throw new Error("system_configs í…Œì´ë¸”ì— ì„¤ì • ê°’ì´ ì—†ìŠµë‹ˆë‹¤. ìŠˆí¼ ì–´ë“œë¯¼ í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì„¸ìš”.");
    }

    // ë°°ì—´ì„ ê°ì²´ë¡œ ë³€í™˜
    const settings = configs.reduce((acc, curr) => ({ ...acc, [curr.key]: curr.value }), {} as Record<string, string>);
    
    const HF_TOKEN = settings["huggingface_token"];
    const MODEL_ID = settings["huggingface_model"];

    // í† í° ê°’ ê²€ì¦
    if (!HF_TOKEN || HF_TOKEN.trim() === "") {
      throw new Error("Hugging Face í† í°ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤. [ìŠˆí¼ ì–´ë“œë¯¼ > ì‹œìŠ¤í…œ API ì„¤ì •]ì—ì„œ í† í°ì„ ì €ì¥í•´ì£¼ì„¸ìš”.");
    }

    // 3. í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ ë°ì´í„° ë°›ê¸°
    const { text } = await req.json();
    if (!text) throw new Error("ì…ë ¥ëœ í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");

    console.log(`ğŸ“ í…ìŠ¤íŠ¸ ì²˜ë¦¬ ìš”ì²­ (ê¸¸ì´: ${text.length}ì)`);

    // 4. Hugging Face API í˜¸ì¶œ
    console.log(`ğŸ¤– AI ëª¨ë¸ í˜¸ì¶œ ì¤‘ (${MODEL_ID})...`);
    
    const response = await fetch(
      `https://router.huggingface.co/v1/chat/completions`, 
      {
        method: "POST",
        headers: {
          Authorization: `Bearer ${HF_TOKEN}`,
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          model: MODEL_ID,
          messages: [
            { role: "system", content: "ë‹¹ì‹ ì€ ì „ë¬¸ì ì¸ ì—ë””í„°ì…ë‹ˆë‹¤. ì…ë ¥ëœ ë¬¸ì¥ì„ ì •ì¤‘í•˜ê³  ì„¸ë ¨ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì²´ë¡œ ë‹¤ë“¬ì–´ì£¼ì„¸ìš”. ì„¤ëª… ì—†ì´ ê²°ê³¼ ë¬¸ì¥ë§Œ ì¶œë ¥í•˜ì„¸ìš”." },
            { role: "user", content: `ë‹¤ìŒ ë¬¸ì¥ì„ ë‹¤ë“¬ì–´ì¤˜:\n\n${text}` }
          ],
          max_tokens: 500,
          temperature: 0.2,
        }),
      }
    );

    const result = await response.json();

    // AI ì‘ë‹µ ì—ëŸ¬ ì²´í¬
    if (result.error) {
      console.error("âŒ Hugging Face API ì—ëŸ¬:", result.error);
      
      // ëª¨ë¸ ë¡œë”© ì¤‘ ì—ëŸ¬(ìì£¼ ë°œìƒí•¨)ì— ëŒ€í•œ ì¹œì ˆí•œ ë©”ì‹œì§€ ì²˜ë¦¬
      if (typeof result.error === 'string' && result.error.includes("loading")) {
        throw new Error("AI ëª¨ë¸ì„ ì„œë²„ì— ë¡œë”© ì¤‘ì…ë‹ˆë‹¤. ì•½ 30ì´ˆ ë’¤ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. (Estimated time error)");
      }
      
      throw new Error(`AI í˜¸ì¶œ ì‹¤íŒ¨: ${JSON.stringify(result.error)}`);
    }

    console.log("âœ… ë³€í™˜ ì„±ê³µ!");

    return new Response(JSON.stringify({ result: result.choices[0].message.content }), {
      headers: { ...corsHeaders, "Content-Type": "application/json" },
    });

  } catch (error: any) {
    // ğŸ”¥ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„: ì—ëŸ¬ë¥¼ ë¡œê·¸ì— ë¹¨ê°›ê²Œ ì¶œë ¥
    console.error("ğŸ”¥ Edge Function ë‚´ë¶€ ì˜¤ë¥˜ ë°œìƒ:", error);

    return new Response(JSON.stringify({ error: error.message || "ì•Œ ìˆ˜ ì—†ëŠ” ì„œë²„ ì˜¤ë¥˜" }), {
      status: 500,
      headers: { ...corsHeaders, "Content-Type": "application/json" },
    });
  }
});


============================================================
File Path: supabase/functions/send-invitation-email/index.ts
============================================================
import { serve } from "https://deno.land/std@0.190.0/http/server.ts";
import { Resend } from "https://esm.sh/resend@2.0.0";

// CORS í—¤ë” ì„¤ì •
const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
  "Access-Control-Allow-Methods": "POST, OPTIONS",
};

interface InvitationEmailRequest {
  email: string;
  companyName: string;
  role: string;
  department?: string;
  jobTitle?: string;
  inviterName?: string;
  signupUrl: string;
}

const getRoleLabel = (role: string): string => {
  switch (role) {
    case "company_admin":
      return "ê´€ë¦¬ì";
    case "manager":
      return "ë§¤ë‹ˆì €";
    default:
      return "ì‚¬ì›";
  }
};

const handler = async (req: Request): Promise<Response> => {
  // 1. CORS í”„ë¦¬í”Œë¼ì´íŠ¸(ì‚¬ì „ ê²€ì‚¬) ìš”ì²­ ì²˜ë¦¬
  if (req.method === "OPTIONS") {
    return new Response("ok", { 
      status: 200, 
      headers: corsHeaders 
    });
  }

  try {
    // Resend API í‚¤ í™•ì¸
    const resendKey = Deno.env.get("RESEND_API_KEY");
    if (!resendKey) {
      throw new Error("RESEND_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    }
    const resend = new Resend(resendKey);

    // ìš”ì²­ ë°ì´í„° íŒŒì‹±
    const {
      email,
      companyName,
      role,
      department,
      jobTitle,
      inviterName,
      signupUrl,
    }: InvitationEmailRequest = await req.json();

    console.log(`Sending invitation email to: ${email} for company: ${companyName}`);

    const roleLabel = getRoleLabel(role);
    const positionInfo = [department, jobTitle].filter(Boolean).join(" Â· ");

    // ì´ë©”ì¼ ë°œì†¡
    const { data, error: sendError } = await resend.emails.send({
      from: "Boteda OS <onboarding@resend.dev>",
      to: [email],
      subject: `[Boteda OS] ${companyName}ì—ì„œ ì´ˆëŒ€í•©ë‹ˆë‹¤`,
      html: `
        <!DOCTYPE html>
        <html lang="ko">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
        </head>
        <body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f4f4f5;">
          <div style="max-width: 600px; margin: 0 auto; padding: 40px 20px;">
            <div style="background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); border-radius: 16px 16px 0 0; padding: 40px 32px; text-align: center;">
              <div style="display: inline-flex; align-items: center; gap: 8px; margin-bottom: 16px;">
                <div style="width: 48px; height: 48px; background: rgba(255,255,255,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                  <span style="color: white; font-weight: bold; font-size: 24px;">B</span>
                </div>
              </div>
              <h1 style="color: white; margin: 0; font-size: 28px; font-weight: 700;">Boteda OS</h1>
              <p style="color: rgba(255,255,255,0.9); margin: 8px 0 0 0; font-size: 14px;">ì—”í„°í…Œì¸ë¨¼íŠ¸ ê¸°ì—… í†µí•© ê´€ë¦¬ ì†”ë£¨ì…˜</p>
            </div>
            
            <div style="background: white; border-radius: 0 0 16px 16px; padding: 40px 32px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);">
              <h2 style="color: #18181b; margin: 0 0 24px 0; font-size: 22px; font-weight: 600;">
                ğŸ‰ ${companyName}ì—ì„œ ì´ˆëŒ€í–ˆìŠµë‹ˆë‹¤
              </h2>
              
              <p style="color: #52525b; margin: 0 0 24px 0; font-size: 16px; line-height: 1.6;">
                ${inviterName ? `${inviterName}ë‹˜ì´` : 'íšŒì‚¬ ê´€ë¦¬ìê°€'} ê·€í•˜ë¥¼ <strong>${companyName}</strong>ì˜ ${roleLabel}ë¡œ ì´ˆëŒ€í–ˆìŠµë‹ˆë‹¤.
              </p>
              
              ${positionInfo ? `
              <div style="background: #f4f4f5; border-radius: 12px; padding: 16px 20px; margin-bottom: 24px;">
                <p style="color: #71717a; margin: 0 0 4px 0; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">ë°°ì •ëœ ì§ì±…</p>
                <p style="color: #18181b; margin: 0; font-size: 16px; font-weight: 600;">${positionInfo}</p>
              </div>
              ` : ''}
              
              <p style="color: #52525b; margin: 0 0 32px 0; font-size: 15px; line-height: 1.6;">
                ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ íšŒì›ê°€ì…ì„ ì™„ë£Œí•˜ì‹œë©´, ë°”ë¡œ ${companyName} ì‹œìŠ¤í…œì— ì ‘ì†í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
              </p>
              
              <div style="text-align: center; margin-bottom: 32px;">
                <a href="${signupUrl}" style="display: inline-block; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); color: white; text-decoration: none; padding: 16px 48px; border-radius: 12px; font-size: 16px; font-weight: 600; box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.4);">
                  íšŒì›ê°€ì… í•˜ê¸°
                </a>
              </div>
              
              <div style="border-top: 1px solid #e4e4e7; padding-top: 24px;">
                <p style="color: #a1a1aa; margin: 0; font-size: 13px; line-height: 1.5;">
                  ì´ ì´ˆëŒ€ëŠ” 7ì¼ í›„ ë§Œë£Œë©ë‹ˆë‹¤.<br>
                  ë³¸ì¸ì´ ìš”ì²­í•˜ì§€ ì•Šì€ ì´ˆëŒ€ë¼ë©´ ì´ ì´ë©”ì¼ì„ ë¬´ì‹œí•˜ì…”ë„ ë©ë‹ˆë‹¤.
                </p>
              </div>
            </div>
            
            <p style="text-align: center; color: #a1a1aa; margin: 24px 0 0 0; font-size: 12px;">
              Â© 2025 Boteda OS. All rights reserved.
            </p>
          </div>
        </body>
        </html>
      `,
    });

    if (sendError) throw sendError;

    console.log("Email sent successfully:", data);

    return new Response(JSON.stringify(data), {
      status: 200,
      headers: { ...corsHeaders, "Content-Type": "application/json" },
    });
  } catch (error: any) {
    console.error("Error in send-invitation-email function:", error);
    return new Response(
      JSON.stringify({ error: error.message }),
      {
        status: 500,
        headers: { ...corsHeaders, "Content-Type": "application/json" },
      }
    );
  }
};

serve(handler);


============================================================
File Path: supabase/functions/upload-to-drive/index.ts
============================================================
import { serve } from "https://deno.land/std@0.168.0/http/server.ts";
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
};

interface UploadRequest {
  tenantId: string;
  fileName: string;
  fileContent: string; // base64 encoded
  mimeType: string;
  subfolder?: string;
}

serve(async (req) => {
  // Handle CORS preflight
  if (req.method === "OPTIONS") {
    return new Response(null, { headers: corsHeaders });
  }

  try {
    // Verify authorization
    const authHeader = req.headers.get("Authorization");
    if (!authHeader) {
      return new Response(
        JSON.stringify({ error: "Authorization required" }),
        { status: 401, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Initialize Supabase client
    const supabaseUrl = Deno.env.get("SUPABASE_URL")!;
    const supabaseServiceKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")!;
    const supabase = createClient(supabaseUrl, supabaseServiceKey);

    // Verify user token
    const token = authHeader.replace("Bearer ", "");
    const { data: { user }, error: authError } = await supabase.auth.getUser(token);
    
    if (authError || !user) {
      return new Response(
        JSON.stringify({ error: "Invalid token" }),
        { status: 401, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Parse request body
    const { tenantId, fileName, fileContent, mimeType, subfolder }: UploadRequest = await req.json();

    if (!tenantId || !fileName || !fileContent || !mimeType) {
      return new Response(
        JSON.stringify({ error: "Missing required fields: tenantId, fileName, fileContent, mimeType" }),
        { status: 400, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Check user is member of tenant
    const { data: membership, error: membershipError } = await supabase
      .from("tenant_memberships")
      .select("id")
      .eq("tenant_id", tenantId)
      .eq("user_id", user.id)
      .single();

    if (membershipError || !membership) {
      return new Response(
        JSON.stringify({ error: "Not a member of this tenant" }),
        { status: 403, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Get tenant's Google credentials
    const { data: tenant, error: tenantError } = await supabase
      .from("tenants")
      .select("google_credentials, drive_folder_id, name")
      .eq("id", tenantId)
      .single();

    if (tenantError || !tenant) {
      return new Response(
        JSON.stringify({ error: "Tenant not found" }),
        { status: 404, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    if (!tenant.google_credentials || !tenant.drive_folder_id) {
      return new Response(
        JSON.stringify({ error: "Google Drive not configured for this tenant" }),
        { status: 400, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Decode credentials (base64 -> JSON)
    const credentialsJson = atob(tenant.google_credentials);
    const credentials = JSON.parse(credentialsJson);

    // Get Google access token using service account
    const accessToken = await getGoogleAccessToken(credentials);

    // Determine target folder (create subfolder if needed)
    let targetFolderId = tenant.drive_folder_id;
    if (subfolder) {
      targetFolderId = await getOrCreateSubfolder(accessToken, tenant.drive_folder_id, subfolder);
    }

    // Upload file to Google Drive
    const driveResult = await uploadToGoogleDrive(
      accessToken,
      targetFolderId,
      fileName,
      fileContent,
      mimeType
    );

    return new Response(
      JSON.stringify({
        success: true,
        fileId: driveResult.id,
        fileName: driveResult.name,
        webViewLink: driveResult.webViewLink,
        webContentLink: driveResult.webContentLink,
      }),
      { headers: { ...corsHeaders, "Content-Type": "application/json" } }
    );
  } catch (err) {
    console.error("Upload error:", err);
    const errorMessage = err instanceof Error ? err.message : "Upload failed";
    return new Response(
      JSON.stringify({ error: errorMessage }),
      { status: 500, headers: { ...corsHeaders, "Content-Type": "application/json" } }
    );
  }
});

// Get Google OAuth2 access token using service account
async function getGoogleAccessToken(credentials: {
  client_email: string;
  private_key: string;
}): Promise<string> {
  const now = Math.floor(Date.now() / 1000);
  const payload = {
    iss: credentials.client_email,
    scope: "https://www.googleapis.com/auth/drive.file",
    aud: "https://oauth2.googleapis.com/token",
    iat: now,
    exp: now + 3600,
  };

  // Create JWT
  const header = { alg: "RS256", typ: "JWT" };
  const encodedHeader = base64UrlEncode(JSON.stringify(header));
  const encodedPayload = base64UrlEncode(JSON.stringify(payload));
  const signatureInput = `${encodedHeader}.${encodedPayload}`;

  // Sign with private key
  const privateKey = await crypto.subtle.importKey(
    "pkcs8",
    pemToArrayBuffer(credentials.private_key),
    { name: "RSASSA-PKCS1-v1_5", hash: "SHA-256" },
    false,
    ["sign"]
  );

  const signature = await crypto.subtle.sign(
    "RSASSA-PKCS1-v1_5",
    privateKey,
    new TextEncoder().encode(signatureInput)
  );

  const encodedSignature = base64UrlEncode(String.fromCharCode(...new Uint8Array(signature)));
  const jwt = `${signatureInput}.${encodedSignature}`;

  // Exchange JWT for access token
  const tokenResponse = await fetch("https://oauth2.googleapis.com/token", {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body: new URLSearchParams({
      grant_type: "urn:ietf:params:oauth:grant-type:jwt-bearer",
      assertion: jwt,
    }),
  });

  const tokenData = await tokenResponse.json();
  if (!tokenData.access_token) {
    throw new Error("Failed to get Google access token");
  }

  return tokenData.access_token;
}

// Upload file to Google Drive
async function uploadToGoogleDrive(
  accessToken: string,
  folderId: string,
  fileName: string,
  fileContent: string,
  mimeType: string
): Promise<{ id: string; name: string; webViewLink: string; webContentLink: string }> {
  // Decode base64 content
  const binaryContent = Uint8Array.from(atob(fileContent), (c) => c.charCodeAt(0));

  // Create multipart request
  const boundary = "---MultipartBoundary" + Date.now();
  const metadata = {
    name: fileName,
    parents: [folderId],
  };

  const metadataPart = JSON.stringify(metadata);
  const multipartBody = new Uint8Array([
    ...new TextEncoder().encode(
      `--${boundary}\r\nContent-Type: application/json; charset=UTF-8\r\n\r\n${metadataPart}\r\n--${boundary}\r\nContent-Type: ${mimeType}\r\nContent-Transfer-Encoding: base64\r\n\r\n`
    ),
    ...binaryContent,
    ...new TextEncoder().encode(`\r\n--${boundary}--`),
  ]);

  const response = await fetch(
    "https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,webViewLink,webContentLink",
    {
      method: "POST",
      headers: {
        Authorization: `Bearer ${accessToken}`,
        "Content-Type": `multipart/related; boundary=${boundary}`,
      },
      body: multipartBody,
    }
  );

  if (!response.ok) {
    const error = await response.text();
    throw new Error(`Google Drive upload failed: ${error}`);
  }

  return response.json();
}

// Get or create subfolder
async function getOrCreateSubfolder(
  accessToken: string,
  parentId: string,
  folderName: string
): Promise<string> {
  // Search for existing folder
  const searchResponse = await fetch(
    `https://www.googleapis.com/drive/v3/files?q=name='${encodeURIComponent(folderName)}' and '${parentId}' in parents and mimeType='application/vnd.google-apps.folder' and trashed=false`,
    {
      headers: { Authorization: `Bearer ${accessToken}` },
    }
  );

  const searchResult = await searchResponse.json();
  if (searchResult.files && searchResult.files.length > 0) {
    return searchResult.files[0].id;
  }

  // Create new folder
  const createResponse = await fetch("https://www.googleapis.com/drive/v3/files", {
    method: "POST",
    headers: {
      Authorization: `Bearer ${accessToken}`,
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      name: folderName,
      mimeType: "application/vnd.google-apps.folder",
      parents: [parentId],
    }),
  });

  const folder = await createResponse.json();
  return folder.id;
}

// Helper functions
function base64UrlEncode(str: string): string {
  return btoa(str).replace(/\+/g, "-").replace(/\//g, "_").replace(/=+$/, "");
}

function pemToArrayBuffer(pem: string): ArrayBuffer {
  const b64 = pem
    .replace(/-----BEGIN PRIVATE KEY-----/, "")
    .replace(/-----END PRIVATE KEY-----/, "")
    .replace(/\s/g, "");
  const binary = atob(b64);
  const buffer = new ArrayBuffer(binary.length);
  const view = new Uint8Array(buffer);
  for (let i = 0; i < binary.length; i++) {
    view[i] = binary.charCodeAt(i);
  }
  return buffer;
}



============================================================
File Path: supabase/migrations/20260116105919_df827dbb-3655-44ac-9367-68b77054d7a5.sql
============================================================
-- =============================================
-- Botida OS ë©€í‹° í…Œë„ŒíŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
-- =============================================

-- 1. ì—­í•  Enum ìƒì„±
CREATE TYPE public.tenant_role AS ENUM ('company_admin', 'manager', 'employee');
CREATE TYPE public.system_role AS ENUM ('sys_super_admin', 'regular_user');

-- 2. í”„ë¡œí•„ í…Œì´ë¸” (ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´)
CREATE TABLE public.profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  email TEXT NOT NULL,
  full_name TEXT,
  avatar_url TEXT,
  phone TEXT,
  system_role system_role NOT NULL DEFAULT 'regular_user',
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- 3. í…Œë„ŒíŠ¸(íšŒì‚¬) í…Œì´ë¸”
CREATE TABLE public.tenants (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  domain TEXT UNIQUE,
  logo_url TEXT,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- 4. í…Œë„ŒíŠ¸ ë©¤ë²„ì‹­ í…Œì´ë¸” (ì‚¬ìš©ì-íšŒì‚¬ ì—°ê²° + ì—­í• )
CREATE TABLE public.tenant_memberships (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES public.profiles(id) ON DELETE CASCADE,
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  role tenant_role NOT NULL DEFAULT 'employee',
  department TEXT,
  job_title TEXT,
  invited_by UUID REFERENCES public.profiles(id),
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(user_id, tenant_id)
);

-- 5. ì™¸ë¶€ ê±°ë˜ì²˜ ì²­êµ¬ í…Œì´ë¸”
CREATE TABLE public.vendor_invoices (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  vendor_name TEXT NOT NULL,
  business_number TEXT,
  description TEXT,
  amount DECIMAL(15,2) NOT NULL,
  bank_name TEXT,
  account_number TEXT,
  account_holder TEXT,
  assigned_to UUID REFERENCES public.profiles(id),
  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected', 'paid')),
  submitted_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  processed_at TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- 6. ì²­êµ¬ì„œ ì²¨ë¶€íŒŒì¼ í…Œì´ë¸”
CREATE TABLE public.invoice_attachments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  invoice_id UUID NOT NULL REFERENCES public.vendor_invoices(id) ON DELETE CASCADE,
  file_name TEXT NOT NULL,
  file_url TEXT NOT NULL,
  file_type TEXT,
  file_size INTEGER,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- =============================================
-- í—¬í¼ í•¨ìˆ˜ë“¤
-- =============================================

-- ì‹œìŠ¤í…œ ìŠˆí¼ì–´ë“œë¯¼ í™•ì¸ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION public.is_sys_super_admin()
RETURNS BOOLEAN
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM public.profiles
    WHERE id = auth.uid()
    AND system_role = 'sys_super_admin'
  )
$$;

-- í…Œë„ŒíŠ¸ ë©¤ë²„ í™•ì¸ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION public.is_tenant_member(_tenant_id UUID)
RETURNS BOOLEAN
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM public.tenant_memberships
    WHERE user_id = auth.uid()
    AND tenant_id = _tenant_id
  )
$$;

-- í…Œë„ŒíŠ¸ ê´€ë¦¬ì í™•ì¸ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION public.is_tenant_admin(_tenant_id UUID)
RETURNS BOOLEAN
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM public.tenant_memberships
    WHERE user_id = auth.uid()
    AND tenant_id = _tenant_id
    AND role = 'company_admin'
  )
$$;

-- í…Œë„ŒíŠ¸ ë§¤ë‹ˆì € ì´ìƒ í™•ì¸ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION public.is_tenant_manager_or_admin(_tenant_id UUID)
RETURNS BOOLEAN
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM public.tenant_memberships
    WHERE user_id = auth.uid()
    AND tenant_id = _tenant_id
    AND role IN ('company_admin', 'manager')
  )
$$;

-- ì‚¬ìš©ìì˜ ëª¨ë“  í…Œë„ŒíŠ¸ ID ë°˜í™˜ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION public.get_user_tenant_ids()
RETURNS SETOF UUID
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT tenant_id FROM public.tenant_memberships
  WHERE user_id = auth.uid()
$$;

-- =============================================
-- RLS í™œì„±í™”
-- =============================================

ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.tenants ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.tenant_memberships ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.vendor_invoices ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.invoice_attachments ENABLE ROW LEVEL SECURITY;

-- =============================================
-- RLS ì •ì±…
-- =============================================

-- Profiles ì •ì±…
CREATE POLICY "Users can view their own profile"
  ON public.profiles FOR SELECT
  USING (id = auth.uid() OR public.is_sys_super_admin());

CREATE POLICY "Users can update their own profile"
  ON public.profiles FOR UPDATE
  USING (id = auth.uid());

CREATE POLICY "System creates profile on signup"
  ON public.profiles FOR INSERT
  WITH CHECK (id = auth.uid());

-- Tenants ì •ì±…
CREATE POLICY "Members can view their tenants"
  ON public.tenants FOR SELECT
  USING (public.is_tenant_member(id) OR public.is_sys_super_admin());

CREATE POLICY "Super admins can create tenants"
  ON public.tenants FOR INSERT
  WITH CHECK (public.is_sys_super_admin());

CREATE POLICY "Super admins can update tenants"
  ON public.tenants FOR UPDATE
  USING (public.is_sys_super_admin());

CREATE POLICY "Super admins can delete tenants"
  ON public.tenants FOR DELETE
  USING (public.is_sys_super_admin());

-- Tenant Memberships ì •ì±…
CREATE POLICY "Members can view tenant memberships"
  ON public.tenant_memberships FOR SELECT
  USING (public.is_tenant_member(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Admins can create memberships"
  ON public.tenant_memberships FOR INSERT
  WITH CHECK (
    public.is_sys_super_admin() OR 
    (public.is_tenant_admin(tenant_id) AND invited_by = auth.uid())
  );

CREATE POLICY "Admins can update memberships"
  ON public.tenant_memberships FOR UPDATE
  USING (
    public.is_sys_super_admin() OR 
    public.is_tenant_admin(tenant_id)
  );

CREATE POLICY "Admins can delete memberships"
  ON public.tenant_memberships FOR DELETE
  USING (
    public.is_sys_super_admin() OR 
    (public.is_tenant_admin(tenant_id) AND user_id != auth.uid())
  );

-- Vendor Invoices ì •ì±…
CREATE POLICY "Members can view tenant invoices"
  ON public.vendor_invoices FOR SELECT
  USING (public.is_tenant_member(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Anyone can submit invoice (guest form)"
  ON public.vendor_invoices FOR INSERT
  WITH CHECK (true);

CREATE POLICY "Members can update invoices"
  ON public.vendor_invoices FOR UPDATE
  USING (public.is_tenant_member(tenant_id) OR public.is_sys_super_admin());

-- Invoice Attachments ì •ì±…
CREATE POLICY "Members can view attachments"
  ON public.invoice_attachments FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM public.vendor_invoices vi
      WHERE vi.id = invoice_id
      AND (public.is_tenant_member(vi.tenant_id) OR public.is_sys_super_admin())
    )
  );

CREATE POLICY "Anyone can add attachments (guest form)"
  ON public.invoice_attachments FOR INSERT
  WITH CHECK (true);

-- =============================================
-- ìë™ í”„ë¡œí•„ ìƒì„± íŠ¸ë¦¬ê±°
-- =============================================

CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
BEGIN
  INSERT INTO public.profiles (id, email, full_name)
  VALUES (
    NEW.id,
    NEW.email,
    COALESCE(NEW.raw_user_meta_data->>'full_name', NEW.email)
  );
  RETURN NEW;
END;
$$;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();

-- =============================================
-- Updated_at ìë™ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
-- =============================================

CREATE OR REPLACE FUNCTION public.update_updated_at_column()
RETURNS TRIGGER
LANGUAGE plpgsql
AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$;

CREATE TRIGGER update_profiles_updated_at
  BEFORE UPDATE ON public.profiles
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_tenants_updated_at
  BEFORE UPDATE ON public.tenants
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_tenant_memberships_updated_at
  BEFORE UPDATE ON public.tenant_memberships
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_vendor_invoices_updated_at
  BEFORE UPDATE ON public.vendor_invoices
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();


============================================================
File Path: supabase/migrations/20260116105945_1ea1ea21-74f1-4f96-84da-ab5430af9eda.sql
============================================================
-- search_path ì„¤ì •ì´ ëˆ„ë½ëœ í•¨ìˆ˜ ìˆ˜ì •
CREATE OR REPLACE FUNCTION public.update_updated_at_column()
RETURNS TRIGGER
LANGUAGE plpgsql
SECURITY INVOKER
SET search_path = public
AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$;


============================================================
File Path: supabase/migrations/20260116110714_b387a50c-2974-4070-8bfa-0dee4cfce0cc.sql
============================================================
-- íšŒì›ê°€ì… ì‹œ ì²« ì‚¬ìš©ìë¥¼ Boteda ë³¸ì‚¬ company_adminìœ¼ë¡œ ìë™ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜
CREATE OR REPLACE FUNCTION public.auto_assign_first_user_to_boteda()
RETURNS TRIGGER
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
DECLARE
  boteda_tenant_id uuid;
  membership_count integer;
BEGIN
  -- Boteda ë³¸ì‚¬ í…Œë„ŒíŠ¸ ID ì¡°íšŒ
  SELECT id INTO boteda_tenant_id FROM tenants WHERE name = 'Boteda ë³¸ì‚¬' LIMIT 1;
  
  -- í…Œë„ŒíŠ¸ê°€ ì—†ìœ¼ë©´ ì¢…ë£Œ
  IF boteda_tenant_id IS NULL THEN
    RETURN NEW;
  END IF;
  
  -- í˜„ì¬ ë©¤ë²„ì‹­ ìˆ˜ í™•ì¸
  SELECT COUNT(*) INTO membership_count FROM tenant_memberships;
  
  -- ì²« ë²ˆì§¸ ì‚¬ìš©ìì¸ ê²½ìš° (ë©¤ë²„ì‹­ì´ ì—†ëŠ” ê²½ìš°)
  IF membership_count = 0 THEN
    -- Boteda ë³¸ì‚¬ì— company_adminìœ¼ë¡œ ì¶”ê°€
    INSERT INTO tenant_memberships (user_id, tenant_id, role, department, job_title)
    VALUES (NEW.id, boteda_tenant_id, 'company_admin', 'ê²½ì˜ì§€ì›', 'ì‹œìŠ¤í…œ ê´€ë¦¬ì');
    
    -- ì‹œìŠ¤í…œ ìŠˆí¼ ì–´ë“œë¯¼ ê¶Œí•œë„ ë¶€ì—¬
    UPDATE profiles SET system_role = 'sys_super_admin' WHERE id = NEW.id;
  END IF;
  
  RETURN NEW;
END;
$$;

-- í”„ë¡œí•„ ìƒì„± í›„ íŠ¸ë¦¬ê±° ì‹¤í–‰
DROP TRIGGER IF EXISTS on_profile_created_assign_first_user ON profiles;
CREATE TRIGGER on_profile_created_assign_first_user
  AFTER INSERT ON profiles
  FOR EACH ROW
  EXECUTE FUNCTION auto_assign_first_user_to_boteda();


============================================================
File Path: supabase/migrations/20260116110928_2e6fb979-78eb-43b4-a463-22a1b32a4f6c.sql
============================================================
-- íšŒì›ê°€ì… ìš”ì²­ í…Œì´ë¸” (ìŠ¹ì¸ ëŒ€ê¸°)
CREATE TABLE public.signup_requests (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id uuid REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
  company_name text NOT NULL,
  status text NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected')),
  reviewed_by uuid REFERENCES profiles(id),
  reviewed_at timestamp with time zone,
  assigned_tenant_id uuid REFERENCES tenants(id),
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now()
);

-- RLS í™œì„±í™”
ALTER TABLE public.signup_requests ENABLE ROW LEVEL SECURITY;

-- ì‚¬ìš©ìëŠ” ìì‹ ì˜ ìš”ì²­ë§Œ ë³¼ ìˆ˜ ìˆìŒ
CREATE POLICY "Users can view their own requests"
ON public.signup_requests
FOR SELECT
USING (user_id = auth.uid() OR is_sys_super_admin());

-- ì‚¬ìš©ìëŠ” ìì‹ ì˜ ìš”ì²­ ìƒì„± ê°€ëŠ¥
CREATE POLICY "Users can create their own requests"
ON public.signup_requests
FOR INSERT
WITH CHECK (user_id = auth.uid());

-- ìŠˆí¼ ì–´ë“œë¯¼ë§Œ ìš”ì²­ ìˆ˜ì • ê°€ëŠ¥ (ìŠ¹ì¸/ê±°ì ˆ)
CREATE POLICY "Super admins can update requests"
ON public.signup_requests
FOR UPDATE
USING (is_sys_super_admin());

-- ìŠˆí¼ ì–´ë“œë¯¼ë§Œ ìš”ì²­ ì‚­ì œ ê°€ëŠ¥
CREATE POLICY "Super admins can delete requests"
ON public.signup_requests
FOR DELETE
USING (is_sys_super_admin());

-- updated_at ìë™ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
CREATE TRIGGER update_signup_requests_updated_at
BEFORE UPDATE ON public.signup_requests
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();

-- ì²« ì‚¬ìš©ì ìë™ ë°°ì • íŠ¸ë¦¬ê±° ì‚­ì œ (ë” ì´ìƒ í•„ìš” ì—†ìŒ)
DROP TRIGGER IF EXISTS on_profile_created_assign_first_user ON profiles;
DROP FUNCTION IF EXISTS auto_assign_first_user_to_boteda();


============================================================
File Path: supabase/migrations/20260116150350_850e071e-50f5-49c1-a281-a4fd7708261c.sql
============================================================
-- Add business registration fields to tenants table
ALTER TABLE public.tenants
ADD COLUMN biz_number text,
ADD COLUMN corp_number text,
ADD COLUMN rep_name text,
ADD COLUMN opening_date text,
ADD COLUMN tax_email text,
ADD COLUMN biz_type text,
ADD COLUMN biz_item text,
ADD COLUMN address text;


============================================================
File Path: supabase/migrations/20260116154752_e376eadb-3c5d-436c-a3d2-782ac9e92ac5.sql
============================================================
-- Add Google Drive integration fields to tenants table
-- google_credentials stores the encrypted service account JSON key
-- drive_folder_id stores the target folder ID for file uploads

ALTER TABLE public.tenants
ADD COLUMN google_credentials text,
ADD COLUMN drive_folder_id text,
ADD COLUMN drive_connected_at timestamptz,
ADD COLUMN drive_connected_by uuid REFERENCES public.profiles(id);

-- Add comment for documentation
COMMENT ON COLUMN public.tenants.google_credentials IS 'Encrypted Google service account JSON key';
COMMENT ON COLUMN public.tenants.drive_folder_id IS 'Google Drive folder ID for file storage';
COMMENT ON COLUMN public.tenants.drive_connected_at IS 'When Google Drive was connected';
COMMENT ON COLUMN public.tenants.drive_connected_by IS 'Who connected Google Drive';


============================================================
File Path: supabase/migrations/20260116154824_d7aa9e86-8b00-42c3-a821-09c422390111.sql
============================================================
-- Allow company admins to update their own tenant's Google Drive settings
DROP POLICY IF EXISTS "Super admins can update tenants" ON public.tenants;

CREATE POLICY "Admins can update tenants"
ON public.tenants
FOR UPDATE
USING (is_sys_super_admin() OR is_tenant_admin(id));


============================================================
File Path: supabase/migrations/20260120105658_fa39420f-87cb-4019-9e02-ec555835f426.sql
============================================================
-- í‚¤ì›Œë“œ ê´€ë¦¬ í…Œì´ë¸”
CREATE TABLE public.keywords (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  keyword TEXT NOT NULL,
  category TEXT,
  priority INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  created_by UUID REFERENCES auth.users(id)
);

-- ë°°ìš°/ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ í…Œì´ë¸”
CREATE TABLE public.artists (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  stage_name TEXT,
  birth_date DATE,
  gender TEXT CHECK (gender IN ('male', 'female', 'other')),
  profile_image_url TEXT,
  bio TEXT,
  agency TEXT,
  debut_date DATE,
  social_links JSONB DEFAULT '{}',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  created_by UUID REFERENCES auth.users(id)
);

-- íšŒì‚¬ë³„ API ì„¤ì • í…Œì´ë¸”
CREATE TABLE public.tenant_api_configs (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  config_key TEXT NOT NULL,
  config_value TEXT NOT NULL,
  description TEXT,
  category TEXT DEFAULT 'general',
  is_encrypted BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(tenant_id, config_key)
);

-- ì‹œìŠ¤í…œ ì „ì—­ ì„¤ì • í…Œì´ë¸” (ìŠˆí¼ì–´ë“œë¯¼ìš©)
CREATE TABLE public.system_configs (
  key TEXT NOT NULL PRIMARY KEY,
  value TEXT NOT NULL,
  description TEXT,
  category TEXT DEFAULT 'general',
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- ì–¸ë¡ ì‚¬ ì—°ë½ì²˜ í…Œì´ë¸”
CREATE TABLE public.press_contacts (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  media_company TEXT NOT NULL,
  reporter_name TEXT NOT NULL,
  contact_email TEXT NOT NULL UNIQUE,
  contact_phone TEXT,
  purpose TEXT,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  created_by UUID REFERENCES auth.users(id)
);

-- RLS í™œì„±í™”
ALTER TABLE public.keywords ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.artists ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.tenant_api_configs ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.system_configs ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.press_contacts ENABLE ROW LEVEL SECURITY;

-- keywords RLS ì •ì±…
CREATE POLICY "Tenant members can view keywords"
  ON public.keywords FOR SELECT
  USING (public.is_tenant_member(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Tenant admins can manage keywords"
  ON public.keywords FOR ALL
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

-- artists RLS ì •ì±…
CREATE POLICY "Tenant members can view artists"
  ON public.artists FOR SELECT
  USING (public.is_tenant_member(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Tenant admins can manage artists"
  ON public.artists FOR ALL
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

-- tenant_api_configs RLS ì •ì±… (ê´€ë¦¬ìë§Œ)
CREATE POLICY "Tenant admins can view api configs"
  ON public.tenant_api_configs FOR SELECT
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Tenant admins can manage api configs"
  ON public.tenant_api_configs FOR ALL
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

-- system_configs RLS ì •ì±… (ìŠˆí¼ì–´ë“œë¯¼ë§Œ)
CREATE POLICY "Super admins can view system configs"
  ON public.system_configs FOR SELECT
  USING (public.is_sys_super_admin());

CREATE POLICY "Super admins can manage system configs"
  ON public.system_configs FOR ALL
  USING (public.is_sys_super_admin());

-- press_contacts RLS ì •ì±… (ìŠˆí¼ì–´ë“œë¯¼ë§Œ)
CREATE POLICY "Super admins can view press contacts"
  ON public.press_contacts FOR SELECT
  USING (public.is_sys_super_admin());

CREATE POLICY "Super admins can manage press contacts"
  ON public.press_contacts FOR ALL
  USING (public.is_sys_super_admin());

-- ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±° ì ìš©
CREATE TRIGGER update_keywords_updated_at
  BEFORE UPDATE ON public.keywords
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_artists_updated_at
  BEFORE UPDATE ON public.artists
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_tenant_api_configs_updated_at
  BEFORE UPDATE ON public.tenant_api_configs
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_system_configs_updated_at
  BEFORE UPDATE ON public.system_configs
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_press_contacts_updated_at
  BEFORE UPDATE ON public.press_contacts
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();

-- ì´ˆê¸° ì‹œìŠ¤í…œ ì„¤ì •ê°’ ì‚½ì…
INSERT INTO public.system_configs (key, value, description, category) VALUES
  ('huggingface_token', '', 'Hugging Face API í† í°', 'AI'),
  ('huggingface_model', 'meta-llama/Llama-3.1-8B-Instruct', 'ì‚¬ìš©í•  HuggingFace ëª¨ë¸', 'AI');


============================================================
File Path: supabase/migrations/20260120111044_ad31b45c-32f3-4aa9-aa76-d25222ec0ac8.sql
============================================================
-- ì§ì› ì´ˆëŒ€ í…Œì´ë¸”
CREATE TABLE public.employee_invitations (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  email TEXT NOT NULL,
  role TEXT NOT NULL DEFAULT 'employee' CHECK (role IN ('company_admin', 'manager', 'employee')),
  department TEXT,
  job_title TEXT,
  invited_by UUID REFERENCES auth.users(id),
  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'accepted', 'expired', 'cancelled')),
  expires_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT (now() + interval '7 days'),
  accepted_at TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(tenant_id, email, status)
);

-- RLS í™œì„±í™”
ALTER TABLE public.employee_invitations ENABLE ROW LEVEL SECURITY;

-- íšŒì‚¬ ê´€ë¦¬ìëŠ” ìê¸° íšŒì‚¬ì˜ ì´ˆëŒ€ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ
CREATE POLICY "Tenant admins can view invitations"
  ON public.employee_invitations FOR SELECT
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Tenant admins can create invitations"
  ON public.employee_invitations FOR INSERT
  WITH CHECK (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Tenant admins can update invitations"
  ON public.employee_invitations FOR UPDATE
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

CREATE POLICY "Tenant admins can delete invitations"
  ON public.employee_invitations FOR DELETE
  USING (public.is_tenant_admin(tenant_id) OR public.is_sys_super_admin());

-- ì´ˆëŒ€ë°›ì€ ì‚¬ëŒë„ ë³¸ì¸ì˜ ì´ˆëŒ€ë¥¼ ë³¼ ìˆ˜ ìˆìŒ (ì´ë©”ì¼ ê¸°ë°˜)
CREATE POLICY "Users can view their own invitations"
  ON public.employee_invitations FOR SELECT
  USING (
    email = (SELECT email FROM auth.users WHERE id = auth.uid())
    AND status = 'pending'
  );

-- ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
CREATE TRIGGER update_employee_invitations_updated_at
  BEFORE UPDATE ON public.employee_invitations
  FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();


============================================================
File Path: src/App.css
============================================================
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}



============================================================
File Path: src/App.tsx
============================================================
import { Toaster } from "@/components/ui/toaster";
import { Toaster as Sonner } from "@/components/ui/sonner";
import { TooltipProvider } from "@/components/ui/tooltip";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { BrowserRouter, Routes, Route } from "react-router-dom";
import { AuthProvider } from "@/hooks/useAuth";
import { ProtectedRoute } from "@/components/ProtectedRoute";
import CompanyManagement from "./pages/admin/CompanyManagement";
import MessageManagement from "./pages/SuperAdmin/MessageManagement";
import Index from "./pages/Index";
import Auth from "./pages/Auth";
import GuestForm from "./pages/GuestForm";
import Dashboard from "./pages/Dashboard";
import SuperAdmin from "./pages/SuperAdmin";
import TenantRegistration from "./pages/TenantRegistration";
import HRManagement from "./pages/admin/HRManagement";
import DriveSettings from "./pages/admin/DriveSettings";
import Onboarding from "./pages/Onboarding";
import PressContacts from "./pages/SuperAdmin/PressContacts"; 
import MediaPitching from "./pages/admin/MediaPitching"; 
import APIManagement from "./pages/SuperAdmin/APIManagement";
import KeywordManagement from "./pages/admin/KeywordManagement";
import ArtistManagement from "./pages/admin/ArtistManagement";
import TenantAPISettings from "./pages/admin/TenantAPISettings";
import ProfileManagement from "./pages/ProfileManagement"; 
import AdminSystem from "./pages/AdminSystem"; // [ì¶”ê°€] ê´€ë¦¬ ì‹œìŠ¤í…œ í†µí•© í—ˆë¸Œ í˜ì´ì§€
import NotFound from "./pages/NotFound";
import CorporateCardManagement from "./pages/admin/CorporateCardManagement";
import VehicleManagement from "./pages/admin/VehicleManagement";

const queryClient = new QueryClient();

const App = () => (
  <QueryClientProvider client={queryClient}>
    <AuthProvider>
      <TooltipProvider>
        <Toaster />
        <Sonner position="top-center" />
        <BrowserRouter>
          <Routes>
            {/* ==========================================
                1. ê³µê°œ ê²½ë¡œ (ëˆ„êµ¬ë‚˜ ì ‘ê·¼ ê°€ëŠ¥)
               ========================================== */}
            <Route path="/" element={<Index />} />
            <Route path="/auth" element={<Auth />} />
            <Route path="/guest-form" element={<GuestForm />} />
            
            {/* ==========================================
                2. ì¼ë°˜ ë³´í˜¸ ê²½ë¡œ (ë¡œê·¸ì¸ í•„ìš”)
               ========================================== */}
            <Route path="/dashboard" element={<ProtectedRoute><Dashboard /></ProtectedRoute>} />
            <Route path="/profiles" element={<ProtectedRoute><ProfileManagement /></ProtectedRoute>} />
            <Route path="/onboarding" element={<ProtectedRoute><Onboarding /></ProtectedRoute>} />

            {/* ==========================================
                3. ë³¸ì‚¬ ê´€ë¦¬ì ê²½ë¡œ (Admin ì „ìš© í—ˆë¸Œ ë° ì„¸ë¶€ ê´€ë¦¬)
               ========================================== */}
            {/* ê´€ë¦¬ ì‹œìŠ¤í…œ ë©”ì¸ í˜ì´ì§€ (404 í•´ê²° í•µì‹¬) */}
            <Route path="/admin" element={<ProtectedRoute><AdminSystem /></ProtectedRoute>} />
            
            <Route path="/admin/hr" element={<ProtectedRoute><HRManagement /></ProtectedRoute>} />
            <Route path="/admin/keywords" element={<ProtectedRoute><KeywordManagement /></ProtectedRoute>} />
            <Route path="/admin/artists" element={<ProtectedRoute><ArtistManagement /></ProtectedRoute>} />
            <Route path="/admin/drive-settings" element={<ProtectedRoute><DriveSettings /></ProtectedRoute>} />
            <Route path="/admin/api-settings" element={<ProtectedRoute><TenantAPISettings /></ProtectedRoute>} />
            <Route path="/admin/media-pitching" element={<ProtectedRoute><MediaPitching /></ProtectedRoute>} />
            <Route path="/admin/company" element={<ProtectedRoute><CompanyManagement /></ProtectedRoute>} />
            <Route path="/admin/cards" element={<ProtectedRoute><CorporateCardManagement /></ProtectedRoute>} />
            <Route path="/admin/vehicles" element={<ProtectedRoute><VehicleManagement /></ProtectedRoute>} />
            
            {/* ==========================================
                4. ìŠˆí¼ ì–´ë“œë¯¼ ì „ìš© ê²½ë¡œ (ì‹œìŠ¤í…œ ì´ê´„)
               ========================================== */}
            <Route path="/super-admin" element={<ProtectedRoute requireSuperAdmin><SuperAdmin /></ProtectedRoute>} />
            <Route path="/super-admin/tenants/new" element={<ProtectedRoute requireSuperAdmin><TenantRegistration /></ProtectedRoute>} />
            <Route path="/super-admin/tenants/edit/:id" element={<ProtectedRoute requireSuperAdmin><TenantRegistration /></ProtectedRoute>} />
            <Route path="/super-admin/api-management" element={<ProtectedRoute requireSuperAdmin><APIManagement /></ProtectedRoute>} />
            <Route
              path="/super-admin/messages"
              element={
                <ProtectedRoute>
                  <MessageManagement />
                </ProtectedRoute>
              }
            />
            <Route path="/super-admin/press-contacts" element={<ProtectedRoute requireSuperAdmin><PressContacts /></ProtectedRoute>} />

            {/* ==========================================
                5. ê¸°íƒ€ ì²˜ë¦¬
               ========================================== */}
            <Route path="*" element={<NotFound />} />
          </Routes>
        </BrowserRouter>
      </TooltipProvider>
    </AuthProvider>
  </QueryClientProvider>
);

export default App;


============================================================
File Path: src/index.css
============================================================
/* ê°€ì¥ ì„¸ë ¨ëœ í•œê¸€/ì˜ë¬¸ ê°€ë³€ í°íŠ¸ Pretendard ì„í¬íŠ¸ */
@import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css");

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 210 40% 98%;
    --foreground: 222 47% 11%;

    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;

    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;

    --primary: 217 91% 55%;
    --primary-foreground: 0 0% 100%;

    --secondary: 214 32% 94%;
    --secondary-foreground: 222 47% 11%;

    --muted: 214 32% 91%;
    --muted-foreground: 215 16% 47%;

    --accent: 262 83% 58%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;

    --success: 142 76% 36%;
    --success-foreground: 0 0% 100%;

    --warning: 38 92% 50%;
    --warning-foreground: 222 47% 11%;

    --border: 214 32% 88%;
    --input: 214 32% 91%;
    --ring: 217 91% 55%;

    --radius: 0.75rem;

    /* Custom Boteda tokens - Light theme */
    --gradient-primary: linear-gradient(135deg, hsl(217 91% 55%) 0%, hsl(262 83% 58%) 100%);
    --gradient-surface: linear-gradient(180deg, hsl(210 40% 98%) 0%, hsl(214 32% 96%) 100%);
    --gradient-glow: radial-gradient(ellipse at center, hsl(217 91% 55% / 0.08) 0%, transparent 70%);
    
    --glass-bg: hsl(0 0% 100% / 0.9);
    --glass-border: hsl(214 32% 88% / 0.8);
    
    --shadow-glow: 0 0 60px -12px hsl(217 91% 55% / 0.2);
    --shadow-card: 0 4px 24px -4px hsl(222 47% 11% / 0.08);
    --shadow-elevated: 0 20px 60px -15px hsl(222 47% 11% / 0.12);

    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 222 47% 11%;
    --sidebar-primary: 217 91% 55%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 214 32% 94%;
    --sidebar-accent-foreground: 222 47% 11%;
    --sidebar-border: 214 32% 88%;
    --sidebar-ring: 217 91% 55%;
  }

  .dark {
    --background: 222 47% 6%;
    --foreground: 210 40% 98%;

    --card: 222 47% 8%;
    --card-foreground: 210 40% 98%;

    --popover: 222 47% 8%;
    --popover-foreground: 210 40% 98%;

    --primary: 217 91% 55%;
    --primary-foreground: 0 0% 100%;

    --secondary: 222 30% 15%;
    --secondary-foreground: 210 40% 98%;

    --muted: 222 30% 12%;
    --muted-foreground: 215 20% 55%;

    --accent: 262 83% 65%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 72% 51%;
    --destructive-foreground: 210 40% 98%;

    --success: 142 76% 45%;
    --success-foreground: 210 40% 98%;

    --warning: 38 92% 50%;
    --warning-foreground: 222 47% 6%;

    --border: 222 30% 18%;
    --input: 222 30% 15%;
    --ring: 217 91% 55%;

    --glass-bg: hsl(222 47% 8% / 0.8);
    --glass-border: hsl(222 30% 20% / 0.5);
    
    --shadow-glow: 0 0 60px -12px hsl(217 91% 55% / 0.4);
    --shadow-card: 0 4px 24px -4px hsl(222 47% 4% / 0.5);
    --shadow-elevated: 0 20px 60px -15px hsl(222 47% 4% / 0.7);

    --sidebar-background: 222 47% 7%;
    --sidebar-foreground: 210 40% 85%;
    --sidebar-primary: 217 91% 55%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 222 30% 12%;
    --sidebar-accent-foreground: 210 40% 98%;
    --sidebar-border: 222 30% 15%;
    --sidebar-ring: 217 91% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-background text-foreground antialiased;
    /* í°íŠ¸ ì„¤ì •: í”„ë¦¬í…ë‹¤ë“œë¥¼ ìµœìš°ì„ ìœ¼ë¡œ, ì—†ìœ¼ë©´ ì‹œìŠ¤í…œ í°íŠ¸ ì‚¬ìš© */
    font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
    /* í•œê¸€ ê°€ë…ì„±ì„ ìœ„í•´ ìê°„ì„ ì‚´ì§ ì¡°ì ˆ */
    letter-spacing: -0.02em;
  }
  
  /* í—¤ë”© ì„œì²´ ê°•ì¡° */
  h1, h2, h3, h4, h5, h6 {
    @apply font-bold tracking-tight;
  }
}

@layer components {
  .glass-card {
    @apply bg-card backdrop-blur-xl border border-border rounded-xl;
    box-shadow: var(--shadow-card);
  }

  .glass-card-hover {
    @apply glass-card transition-all duration-300;
  }

  .glass-card-hover:hover {
    @apply border-primary/30;
    box-shadow: var(--shadow-glow);
  }

  .gradient-text {
    @apply bg-clip-text text-transparent;
    background-image: var(--gradient-primary);
  }

  .gradient-border {
    position: relative;
  }

  .gradient-border::before {
    content: '';
    position: absolute;
    inset: 0;
    padding: 1px;
    border-radius: inherit;
    background: var(--gradient-primary);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
  }

  .glow-effect {
    position: relative;
  }

  .glow-effect::after {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    background: var(--gradient-primary);
    opacity: 0;
    filter: blur(20px);
    transition: opacity 0.3s ease;
    z-index: -1;
  }

  .glow-effect:hover::after {
    opacity: 0.4;
  }

  .timeline-connector {
    @apply absolute left-6 top-12 bottom-0 w-px bg-gradient-to-b from-border to-transparent;
  }

  .status-badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
  }

  .status-pending {
    @apply bg-warning/15 text-warning border border-warning/30;
  }

  .status-approved {
    @apply bg-success/15 text-success border border-success/30;
  }

  .status-rejected {
    @apply bg-destructive/15 text-destructive border border-destructive/30;
  }

  .status-inprogress {
    @apply bg-primary/15 text-primary border border-primary/30;
  }
}

@layer utilities {
  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .animate-pulse-slow {
    animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .animate-gradient {
    background-size: 200% 200%;
    animation: gradient 8s ease infinite;
  }

  .animate-slide-up {
    animation: slideUp 0.5s ease-out forwards;
  }

  .animate-fade-in {
    animation: fadeIn 0.6s ease-out forwards;
  }
}

@keyframes float {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-20px);
  }
}

@keyframes gradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--muted));
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--border));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground));
}


============================================================
File Path: src/main.tsx
============================================================
import { createRoot } from "react-dom/client";
import App from "./App.tsx";
import "./index.css";

createRoot(document.getElementById("root")!).render(<App />);



============================================================
File Path: src/vite-env.d.ts
============================================================
/// <reference types="vite/client" />



============================================================
File Path: src/components/NavLink.tsx
============================================================
import { NavLink as RouterNavLink, NavLinkProps } from "react-router-dom";
import { forwardRef } from "react";
import { cn } from "@/lib/utils";

interface NavLinkCompatProps extends Omit<NavLinkProps, "className"> {
  className?: string;
  activeClassName?: string;
  pendingClassName?: string;
}

const NavLink = forwardRef<HTMLAnchorElement, NavLinkCompatProps>(
  ({ className, activeClassName, pendingClassName, to, ...props }, ref) => {
    return (
      <RouterNavLink
        ref={ref}
        to={to}
        className={({ isActive, isPending }) =>
          cn(className, isActive && activeClassName, isPending && pendingClassName)
        }
        {...props}
      />
    );
  },
);

NavLink.displayName = "NavLink";

export { NavLink };



============================================================
File Path: src/components/PendingApproval.tsx
============================================================
import { useAuth } from "@/hooks/useAuth";
import { Button } from "@/components/ui/button";
import { Clock, Building2, LogOut } from "lucide-react";

export const PendingApproval = () => {
  const { signOut, signupRequest, profile } = useAuth();

  return (
    <div className="min-h-screen bg-background flex items-center justify-center p-4">
      {/* Background Effects */}
      <div className="absolute inset-0 bg-gradient-to-br from-primary/5 via-background to-accent/5" />
      <div className="absolute top-1/4 left-1/4 w-96 h-96 bg-primary/10 rounded-full blur-3xl" />
      <div className="absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl" />

      <div className="relative z-10 w-full max-w-md text-center">
        {/* Logo */}
        <div className="inline-flex items-center gap-2 mb-8">
          <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-accent flex items-center justify-center">
            <span className="text-primary-foreground font-bold text-lg">B</span>
          </div>
          <span className="font-bold text-2xl">
            <span className="gradient-text">Boteda</span> OS
          </span>
        </div>

        {/* Status Card */}
        <div className="glass-card p-8">
          <div className="w-16 h-16 mx-auto mb-6 rounded-full bg-amber-100 flex items-center justify-center">
            <Clock className="w-8 h-8 text-amber-600" />
          </div>

          <h2 className="text-2xl font-bold mb-2">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘</h2>
          <p className="text-muted-foreground mb-6">
            ê´€ë¦¬ìê°€ íšŒì›ê°€ì… ìš”ì²­ì„ ê²€í† í•˜ê³  ìˆìŠµë‹ˆë‹¤.
          </p>

          {signupRequest && (
            <div className="bg-secondary/50 rounded-lg p-4 mb-6 text-left">
              <div className="flex items-center gap-2 text-sm text-muted-foreground mb-2">
                <Building2 className="w-4 h-4" />
                <span>ìš”ì²­í•œ íšŒì‚¬</span>
              </div>
              <p className="font-medium">{signupRequest.company_name}</p>
            </div>
          )}

          <div className="space-y-3 text-sm text-muted-foreground">
            <p>â€¢ ê´€ë¦¬ì ìŠ¹ì¸ í›„ ì‹œìŠ¤í…œì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
            <p>â€¢ ìŠ¹ì¸ ì™„ë£Œ ì‹œ ì´ë©”ì¼ë¡œ ì•Œë¦¼ì„ ë°›ê²Œ ë©ë‹ˆë‹¤</p>
            <p>â€¢ ë¬¸ì˜ì‚¬í•­ì€ ì‹œìŠ¤í…œ ê´€ë¦¬ìì—ê²Œ ì—°ë½í•´ì£¼ì„¸ìš”</p>
          </div>

          <Button
            variant="outline"
            className="mt-8 w-full"
            onClick={signOut}
          >
            <LogOut className="w-4 h-4 mr-2" />
            ë¡œê·¸ì•„ì›ƒ
          </Button>
        </div>

        <p className="text-xs text-muted-foreground mt-6">
          {profile?.email}ë¡œ ë¡œê·¸ì¸ë¨
        </p>
      </div>
    </div>
  );
};



============================================================
File Path: src/components/ProtectedRoute.tsx
============================================================
import { ReactNode } from "react";
import { Navigate, useLocation } from "react-router-dom";
import { useAuth } from "@/hooks/useAuth";
import { PendingApproval } from "./PendingApproval";
import { Loader2 } from "lucide-react";

interface ProtectedRouteProps {
  children: ReactNode;
  requireSuperAdmin?: boolean;
}

export const ProtectedRoute = ({ children, requireSuperAdmin = false }: ProtectedRouteProps) => {
  const { user, loading, isPendingApproval, isSuperAdmin, currentTenant } = useAuth();
  const location = useLocation();

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <Loader2 className="w-8 h-8 animate-spin text-primary" />
      </div>
    );
  }

  // 1. ë¡œê·¸ì¸ì´ ì•ˆ ëœ ê²½ìš°
  if (!user) {
    return <Navigate to="/auth" replace />;
  }

  // 2. ê°€ì… ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ê²½ìš°
  if (isPendingApproval && !isSuperAdmin) {
    return <PendingApproval />;
  }

  // 3. í•µì‹¬: ì˜¨ë³´ë”© ì²´í¬ (ì •ë³´ ë“±ë¡ ì—¬ë¶€)
  // ì†Œì† íšŒì‚¬(currentTenant)ëŠ” ìˆëŠ”ë° ì§ê¸‰(job_title) ì •ë³´ê°€ ì—†ë‹¤ë©´ ë¯¸ë“±ë¡ìë¡œ ê°„ì£¼
  // ë‹¨, ìŠˆí¼ì–´ë“œë¯¼ì€ ì´ ê³¼ì •ì„ ê±´ë„ˆë›°ê²Œ í•˜ê±°ë‚˜, ì˜¨ë³´ë”© í˜ì´ì§€ ìì²´ì—ì„œëŠ” ë¬´í•œ ë£¨í”„ ë°©ì§€
  const needsOnboarding = currentTenant && !currentTenant.job_title && !isSuperAdmin;

  if (needsOnboarding && location.pathname !== "/onboarding") {
    console.log("ì •ë³´ ë¯¸ë“±ë¡ ê°ì§€: ì˜¨ë³´ë”© í˜ì´ì§€ë¡œ ê°•ì œ ì´ë™í•©ë‹ˆë‹¤.");
    return <Navigate to="/onboarding" replace />;
  }

  // 4. ìŠˆí¼ ì–´ë“œë¯¼ ì „ìš© ê²½ë¡œ ì²´í¬
  if (requireSuperAdmin && !isSuperAdmin) {
    return <Navigate to="/dashboard" replace />;
  }

  return <>{children}</>;
};


============================================================
File Path: src/components/dashboard/AppGrid.tsx
============================================================
import React from 'react';
import { useNavigate } from 'react-router-dom';
import {
  // Project Hub Icons
  LayoutDashboard, History, Calendar, FolderOpen,
  // PR & Marketing Icons
  PenTool, MessageSquareText, BellRing, Target, Send, UserSearch, FilePieChart,
  // Finance & Management Icons
  Inbox, FileCheck2, Car, BarChart3, Users2, MapPin, Settings2,
  // UI Icons
  LayoutGrid, Settings, Search
} from "lucide-react";
import { toast } from "sonner";

interface AppItem {
  id: string;
  name: string;
  icon: React.ReactNode;
  color: string;
  bgColor: string;
  path?: string; 
}

interface AppCategory {
  title: string;
  count: number;
  apps: AppItem[];
}

export const AppGrid = () => {
  const navigate = useNavigate();

  const appCategories: AppCategory[] = [
    {
      title: "Project Hub",
      count: 4,
      apps: [
        { id: "project-feed", name: "í”„ë¡œì íŠ¸ í”¼ë“œ", icon: <LayoutDashboard className="w-6 h-6" />, color: "text-indigo-600", bgColor: "bg-indigo-50" },
        { id: "timeline", name: "í†µí•© íƒ€ì„ë¼ì¸", icon: <History className="w-6 h-6" />, color: "text-blue-500", bgColor: "bg-blue-50" },
        { id: "calendar", name: "ê³µìš© ìº˜ë¦°ë”", icon: <Calendar className="w-6 h-6" />, color: "text-emerald-500", bgColor: "bg-emerald-50" },
        { id: "archive", name: "ë¬¸ì„œ/íšŒì˜ë¡", icon: <FolderOpen className="w-6 h-6" />, color: "text-amber-500", bgColor: "bg-amber-50" },
      ],
    },
    {
      title: "PR & Marketing",
      count: 7,
      apps: [
        { id: "press-release", name: "ë³´ë„ìë£Œ ì‘ì„±", icon: <PenTool className="w-6 h-6" />, color: "text-blue-600", bgColor: "bg-blue-50" },
        { id: "interview-gen", name: "ì¸í„°ë·°ì§€ ìƒì„±", icon: <MessageSquareText className="w-6 h-6" />, color: "text-indigo-600", bgColor: "bg-indigo-50" },
        { id: "news-monitor", name: "í‚¤ì›Œë“œ ì•Œë¦¼", icon: <BellRing className="w-6 h-6" />, color: "text-amber-600", bgColor: "bg-amber-50" },
        { id: "marketing-plan", name: "ë§ˆì¼€íŒ… í”Œëœ", icon: <Target className="w-6 h-6" />, color: "text-rose-600", bgColor: "bg-rose-50" },
        
        { 
          id: "media-sending", 
          name: "ì–¸ë¡  ë³´ë„ ë°œì†¡", 
          icon: <Send className="w-6 h-6" />, 
          color: "text-emerald-600", 
          bgColor: "bg-emerald-50",
          path: "/admin/media-pitching"
        },
        
        // [ìˆ˜ì •] ì¸ë¬¼ì •ë³´ ê´€ë¦¬ ê²½ë¡œ ì—°ê²°
        { 
          id: "profile-mgmt", 
          name: "ì¸ë¬¼ì •ë³´ ê´€ë¦¬", 
          icon: <UserSearch className="w-6 h-6" />, 
          color: "text-purple-600", 
          bgColor: "bg-purple-50",
          path: "/profiles" 
        },
        
        { id: "performance", name: "ì„±ê³¼ ë³´ê³ ì„œ", icon: <FilePieChart className="w-6 h-6" />, color: "text-slate-600", bgColor: "bg-slate-100" },
      ],
    },
    {
      title: "Finance & Management",
      count: 6,
      apps: [
        { id: "billing-inbox", name: "ì™¸ë¶€ ì²­êµ¬í•¨", icon: <Inbox className="w-6 h-6" />, color: "text-rose-500", bgColor: "bg-rose-50" },
        { id: "approval", name: "ì „ìê²°ì¬(ì§€ì¶œ)", icon: <FileCheck2 className="w-6 h-6" />, color: "text-orange-500", bgColor: "bg-orange-50" },
        { id: "vehicle", name: "ì°¨ëŸ‰ ìš´í–‰ì •ì‚°", icon: <Car className="w-6 h-6" />, color: "text-slate-700", bgColor: "bg-slate-100" },
        { id: "settlement", name: "ì •ì‚° ë¦¬í¬íŠ¸", icon: <BarChart3 className="w-6 h-6" />, color: "text-cyan-600", bgColor: "bg-cyan-50" },
        
        { 
          id: "hr", 
          name: "ì¸ì‚¬ ê´€ë¦¬", 
          icon: <Users2 className="w-6 h-6" />, 
          color: "text-purple-500", 
          bgColor: "bg-purple-50",
          path: "/admin/hr" 
        },
        
        { id: "attendance", name: "ê·¼íƒœ ê´€ë¦¬", icon: <MapPin className="w-6 h-6" />, color: "text-pink-500", bgColor: "bg-pink-50" },
      ],
    },
  ];

  const handleAppClick = (app: AppItem) => {
    if (app.path) {
      navigate(app.path);
    } else {
      toast.info("ì¤€ë¹„ ì¤‘ì¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤.", {
        description: "ê³§ ì—…ë°ì´íŠ¸ë  ì˜ˆì •ì…ë‹ˆë‹¤."
      });
    }
  };

  return (
    <div className="relative rounded-3xl overflow-hidden shadow-2xl">
      <div className="absolute inset-0 bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-900" />
      
      <div className="absolute -right-20 top-1/2 -translate-y-1/2 w-[450px] h-[450px] bg-gradient-to-br from-purple-500/50 via-fuchsia-500/50 to-pink-500/50 rounded-full blur-3xl opacity-70 animate-pulse" />
      <div className="absolute -left-10 bottom-0 w-[350px] h-[350px] bg-gradient-to-tr from-cyan-400/40 to-blue-500/40 rounded-full blur-3xl opacity-50" />
      
      <div className="relative z-10 p-8">
        <div className="flex items-center justify-between mb-8">
          <div className="flex items-center gap-3">
            <div className="bg-white/20 p-2 rounded-xl backdrop-blur-md">
              <LayoutGrid className="w-6 h-6 text-white" />
            </div>
            <div>
              <span className="font-bold text-xl text-white tracking-tight">Botida OS</span>
              <p className="text-xs text-white/60">ì°¨ì„¸ëŒ€ ë§¤ë‹ˆì§€ë¨¼íŠ¸ ì‹œìŠ¤í…œ</p>
            </div>
          </div>
          <button className="p-2.5 hover:bg-white/10 rounded-xl transition-all border border-white/10 backdrop-blur-sm">
            <Settings className="w-5 h-5 text-white/80" />
          </button>
        </div>

        <div className="mb-8">
          <div className="relative group">
            <input
              type="text"
              placeholder="í•„ìš”í•œ í™ë³´ ìë£Œë‚˜ í”„ë¡œì íŠ¸ë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”."
              className="w-full px-6 py-4 pl-6 pr-14 rounded-2xl bg-white/95 backdrop-blur-md border-0 text-md text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-4 focus:ring-white/20 shadow-xl transition-all"
            />
            <button className="absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-indigo-600 hover:bg-indigo-700 rounded-xl shadow-lg transition-transform active:scale-95">
              <Search className="w-5 h-5 text-white" />
            </button>
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {appCategories.map((category) => (
            <div 
              key={category.title} 
              className="bg-white/95 backdrop-blur-md rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all border border-white/50"
            >
              <div className="flex items-center justify-between mb-5 border-b border-slate-100 pb-3">
                <div className="flex items-center gap-2">
                  <h3 className="font-bold text-slate-800">{category.title}</h3>
                  <span className="text-xs font-bold bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded-full">
                    {category.count}
                  </span>
                </div>
              </div>
              <div className="grid grid-cols-4 gap-4">
                {category.apps.map((app) => (
                  <button
                    key={app.id}
                    onClick={() => handleAppClick(app)}
                    className="flex flex-col items-center gap-2.5 p-2 rounded-2xl hover:bg-slate-50 transition-all group"
                  >
                    <div className={`w-14 h-14 ${app.bgColor} rounded-2xl flex items-center justify-center ${app.color} group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-md border border-white`}>
                      {app.icon}
                    </div>
                    <span className="text-[11px] font-semibold text-slate-600 text-center leading-tight break-keep px-1">
                      {app.name}
                    </span>
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};


============================================================
File Path: src/components/dashboard/CalendarWidget.tsx
============================================================
import { useState } from "react";
import { Calendar } from "@/components/ui/calendar";
import { Button } from "@/components/ui/button";
import { 
  ChevronLeft, 
  ChevronRight, 
  Plus,
  CalendarDays,
  Clock
} from "lucide-react";
import { format } from "date-fns";
import { ko } from "date-fns/locale";
import { cn } from "@/lib/utils";

interface ScheduleItem {
  id: string;
  title: string;
  time: string;
  type: "meeting" | "task" | "reminder";
  color: string;
}

const mockSchedules: Record<string, ScheduleItem[]> = {
  "2026-01-16": [
    { id: "1", title: "ì£¼ê°„ íŒ€ ë¯¸íŒ…", time: "10:00 - 11:00", type: "meeting", color: "bg-blue-500" },
    { id: "2", title: "ê±°ë˜ì²˜ ë¯¸íŒ…", time: "14:00 - 15:30", type: "meeting", color: "bg-green-500" },
    { id: "3", title: "ë³´ê³ ì„œ ì œì¶œ ë§ˆê°", time: "18:00", type: "task", color: "bg-orange-500" },
  ],
  "2026-01-17": [
    { id: "4", title: "í”„ë¡œì íŠ¸ ë¦¬ë·°", time: "09:00 - 10:00", type: "meeting", color: "bg-purple-500" },
  ],
  "2026-01-20": [
    { id: "5", title: "ì›”ê°„ ê²°ì‚°", time: "ì¢…ì¼", type: "task", color: "bg-red-500" },
    { id: "6", title: "ê²½ì˜ì§„ ë³´ê³ ", time: "15:00 - 16:00", type: "meeting", color: "bg-blue-500" },
  ],
};

export const CalendarWidget = () => {
  const [selectedDate, setSelectedDate] = useState<Date>(new Date());
  const [currentMonth, setCurrentMonth] = useState<Date>(new Date());

  const dateKey = format(selectedDate, "yyyy-MM-dd");
  const todaySchedules = mockSchedules[dateKey] || [];

  const handlePrevMonth = () => {
    setCurrentMonth(prev => new Date(prev.getFullYear(), prev.getMonth() - 1, 1));
  };

  const handleNextMonth = () => {
    setCurrentMonth(prev => new Date(prev.getFullYear(), prev.getMonth() + 1, 1));
  };

  // Get dates that have schedules
  const scheduledDates = Object.keys(mockSchedules).map(d => new Date(d));

  return (
    <div className="grid md:grid-cols-2 gap-4">
      {/* Calendar Section */}
      <div className="glass-card p-5">
        {/* Month Navigation */}
        <div className="flex items-center justify-between mb-4">
          <div className="flex items-center gap-2">
            <Button variant="ghost" size="icon" className="w-8 h-8" onClick={handlePrevMonth}>
              <ChevronLeft className="w-4 h-4" />
              <ChevronLeft className="w-4 h-4 -ml-3" />
            </Button>
            <Button variant="ghost" size="icon" className="w-8 h-8" onClick={handlePrevMonth}>
              <ChevronLeft className="w-4 h-4" />
            </Button>
          </div>
          <h3 className="font-semibold text-lg">
            {format(currentMonth, "yyyy.MM", { locale: ko })}
          </h3>
          <div className="flex items-center gap-2">
            <Button variant="ghost" size="icon" className="w-8 h-8" onClick={handleNextMonth}>
              <ChevronRight className="w-4 h-4" />
            </Button>
            <Button variant="ghost" size="icon" className="w-8 h-8" onClick={handleNextMonth}>
              <ChevronRight className="w-4 h-4" />
              <ChevronRight className="w-4 h-4 -ml-3" />
            </Button>
          </div>
        </div>

        {/* Calendar */}
        <Calendar
          mode="single"
          selected={selectedDate}
          onSelect={(date) => date && setSelectedDate(date)}
          month={currentMonth}
          onMonthChange={setCurrentMonth}
          locale={ko}
          className="p-0 pointer-events-auto"
          classNames={{
            months: "w-full",
            month: "w-full space-y-4",
            caption: "hidden",
            caption_label: "text-sm font-medium",
            nav: "hidden",
            table: "w-full border-collapse",
            head_row: "flex w-full",
            head_cell: "text-muted-foreground rounded-md w-full font-normal text-xs",
            row: "flex w-full mt-1",
            cell: cn(
              "relative w-full p-0 text-center text-sm focus-within:relative focus-within:z-20",
              "[&:has([aria-selected])]:bg-transparent"
            ),
            day: cn(
              "h-9 w-9 p-0 font-normal mx-auto rounded-full hover:bg-secondary transition-colors",
              "aria-selected:opacity-100"
            ),
            day_selected: "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground",
            day_today: "bg-primary/10 text-primary font-semibold",
            day_outside: "text-muted-foreground/50",
            day_disabled: "text-muted-foreground opacity-50",
          }}
          modifiers={{
            scheduled: scheduledDates,
          }}
          modifiersClassNames={{
            scheduled: "after:absolute after:bottom-1 after:left-1/2 after:-translate-x-1/2 after:w-1 after:h-1 after:bg-primary after:rounded-full",
          }}
        />
      </div>

      {/* Schedule List Section */}
      <div className="glass-card p-5">
        <div className="flex items-center justify-between mb-4">
          <div className="flex items-center gap-2">
            <h3 className="font-semibold text-lg">
              {format(selectedDate, "yyyy.MM.dd(eee)", { locale: ko })} ì¼ì •
            </h3>
          </div>
          <Button variant="ghost" size="icon" className="w-8 h-8">
            <Plus className="w-4 h-4" />
          </Button>
        </div>

        {todaySchedules.length > 0 ? (
          <div className="space-y-3">
            {todaySchedules.map((schedule) => (
              <div
                key={schedule.id}
                className="flex items-start gap-3 p-3 rounded-lg bg-secondary/30 hover:bg-secondary/50 transition-colors cursor-pointer"
              >
                <div className={`w-1 h-full min-h-[40px] ${schedule.color} rounded-full`} />
                <div className="flex-1">
                  <div className="font-medium text-sm">{schedule.title}</div>
                  <div className="flex items-center gap-1 text-xs text-muted-foreground mt-1">
                    <Clock className="w-3 h-3" />
                    {schedule.time}
                  </div>
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div className="flex flex-col items-center justify-center py-12 text-center">
            <div className="w-16 h-16 rounded-full bg-secondary flex items-center justify-center mb-4">
              <CalendarDays className="w-8 h-8 text-muted-foreground" />
            </div>
            <p className="text-muted-foreground text-sm">
              {format(selectedDate, "yyyy.MM.dd", { locale: ko })}ì— ë“±ë¡ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤
            </p>
            <p className="text-muted-foreground text-xs mt-1">
              ìƒˆë¡œìš´ ì¼ì •ì„ ë“±ë¡í•˜ì„¸ìš”.
            </p>
          </div>
        )}
      </div>
    </div>
  );
};


============================================================
File Path: src/components/landing/ArchitectureSection.tsx
============================================================
import { ArrowDown, ArrowRight } from "lucide-react";

export const ArchitectureSection = () => {
  return (
    <section className="py-24 relative overflow-hidden">
      {/* Background */}
      <div className="absolute inset-0 bg-gradient-to-b from-transparent via-secondary/30 to-transparent" />
      
      <div className="container px-4 relative z-10">
        {/* Section Header */}
        <div className="text-center mb-16">
          <h2 className="text-3xl md:text-5xl font-bold mb-4">
            ì‹œìŠ¤í…œ <span className="gradient-text">ì•„í‚¤í…ì²˜</span>
          </h2>
          <p className="text-muted-foreground text-lg max-w-2xl mx-auto">
            ë©€í‹° í…Œë„ŒíŠ¸ êµ¬ì¡°ë¡œ ì„¤ê³„ëœ í™•ì¥ ê°€ëŠ¥í•œ ì—”í„°í”„ë¼ì´ì¦ˆ ì‹œìŠ¤í…œ
          </p>
        </div>

        {/* Architecture Diagram */}
        <div className="max-w-5xl mx-auto">
          {/* Super Admin */}
          <div className="flex justify-center mb-8">
            <div className="glass-card p-6 text-center max-w-md w-full glow-effect">
              <div className="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-primary to-accent flex items-center justify-center">
                <span className="text-2xl">ğŸ‘‘</span>
              </div>
              <h3 className="text-xl font-bold mb-2">Super Admin</h3>
              <p className="text-sm text-muted-foreground">
                ì „ì²´ ê³ ê°ì‚¬ ê´€ë¦¬ Â· í†µí•© ëŒ€ì‹œë³´ë“œ Â· ì²­êµ¬ í˜„í™© ëª¨ë‹ˆí„°ë§
              </p>
            </div>
          </div>

          {/* Arrow */}
          <div className="flex justify-center mb-8">
            <ArrowDown className="w-6 h-6 text-primary animate-bounce" />
          </div>

          {/* Tenant Sites */}
          <div className="grid md:grid-cols-3 gap-6 mb-8">
            {[
              { name: "A Company", domain: "a.boteda.com" },
              { name: "B Company", domain: "b.boteda.com" },
              { name: "C Company", domain: "c.boteda.com" },
            ].map((tenant, index) => (
              <div key={tenant.name} className="glass-card p-5 text-center">
                <div className="w-12 h-12 mx-auto mb-3 rounded-xl bg-secondary flex items-center justify-center">
                  <span className="text-xl">ğŸ¢</span>
                </div>
                <h4 className="font-semibold mb-1">{tenant.name}</h4>
                <code className="text-xs text-primary bg-primary/10 px-2 py-1 rounded">
                  {tenant.domain}
                </code>
                <div className="mt-4 flex flex-wrap gap-2 justify-center">
                  <span className="text-xs px-2 py-1 rounded-full bg-secondary text-muted-foreground">ê·¸ë£¹ì›¨ì–´</span>
                  <span className="text-xs px-2 py-1 rounded-full bg-secondary text-muted-foreground">ê²°ì¬</span>
                  <span className="text-xs px-2 py-1 rounded-full bg-secondary text-muted-foreground">ìº˜ë¦°ë”</span>
                </div>
              </div>
            ))}
          </div>

          {/* Guest Form */}
          <div className="flex items-center justify-center gap-4 mb-8">
            <div className="h-px flex-1 bg-gradient-to-r from-transparent to-border" />
            <ArrowRight className="w-5 h-5 text-muted-foreground" />
            <div className="h-px flex-1 bg-gradient-to-l from-transparent to-border" />
          </div>

          <div className="flex justify-center">
            <div className="glass-card p-6 text-center max-w-lg w-full border-dashed border-2 border-primary/30">
              <div className="w-12 h-12 mx-auto mb-3 rounded-xl bg-gradient-to-br from-success to-emerald-400 flex items-center justify-center">
                <span className="text-xl">ğŸ“</span>
              </div>
              <h4 className="font-semibold mb-1">Guest Form</h4>
              <p className="text-sm text-muted-foreground mb-3">
                ì™¸ë¶€ ê±°ë˜ì²˜ ì „ìš© ë¹„ë¡œê·¸ì¸ ì²­êµ¬ í˜ì´ì§€
              </p>
              <div className="flex flex-wrap gap-2 justify-center">
                <span className="text-xs px-2 py-1 rounded-full bg-primary/10 text-primary">ê²¬ì ì„œ ì—…ë¡œë“œ</span>
                <span className="text-xs px-2 py-1 rounded-full bg-primary/10 text-primary">AI ì •ë³´ ì¶”ì¶œ</span>
                <span className="text-xs px-2 py-1 rounded-full bg-primary/10 text-primary">ë‹´ë‹¹ì ì•Œë¦¼</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
};



============================================================
File Path: src/components/landing/FeaturesSection.tsx
============================================================
import { 
  FileText, 
  Users, 
  Building2, 
  Shield, 
  Workflow, 
  Calendar,
  Car,
  MessageSquare
} from "lucide-react";

const features = [
  {
    icon: FileText,
    title: "ì™¸ë¶€ ê±°ë˜ì²˜ ì²­êµ¬",
    description: "ë¡œê·¸ì¸ ì—†ì´ ê²¬ì ì„œ, í†µì¥ì‚¬ë³¸ì„ ì—…ë¡œë“œí•˜ê³  AIê°€ ìë™ìœ¼ë¡œ ì •ë³´ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.",
    gradient: "from-primary to-cyan-400",
  },
  {
    icon: Workflow,
    title: "ì „ìê²°ì¬ ì‹œìŠ¤í…œ",
    description: "ì»¤ìŠ¤í…€ ê²°ì¬ ë¼ì¸ ì„¤ì •. ì œì¶œëœ ì²­êµ¬ì„œ ê¸°ë°˜ ì§€ì¶œê²°ì˜ì„œ ìë™ ìƒì„±.",
    gradient: "from-accent to-pink-400",
  },
  {
    icon: Users,
    title: "ì„ì§ì› ê·¸ë£¹ì›¨ì–´",
    description: "GPS ê¸°ë°˜ ì¶œí‡´ê·¼, ê·¼íƒœ ë¦¬í¬íŠ¸, í”„ë¡œì íŠ¸ë³„ í˜‘ì—… ê³µê°„ì„ ì œê³µí•©ë‹ˆë‹¤.",
    gradient: "from-success to-emerald-400",
  },
  {
    icon: Building2,
    title: "ë©€í‹° í…Œë„ŒíŠ¸",
    description: "íšŒì‚¬ë³„ ë…ë¦½ ë„ë©”ì¸ ìš´ì˜. ì² ì €í•œ ë°ì´í„° ê²©ë¦¬ë¡œ ë³´ì•ˆì„ ë³´ì¥í•©ë‹ˆë‹¤.",
    gradient: "from-warning to-orange-400",
  },
  {
    icon: Shield,
    title: "ì—”í„°í”„ë¼ì´ì¦ˆ ë³´ì•ˆ",
    description: "API ë ˆë²¨ì˜ tenant_id ê²€ì¦. íƒ€ íšŒì‚¬ ë°ì´í„° ì ‘ê·¼ ì›ì²œ ì°¨ë‹¨.",
    gradient: "from-red-500 to-rose-400",
  },
  {
    icon: Calendar,
    title: "ê³µìš© ìº˜ë¦°ë”",
    description: "í”„ë¡œì íŠ¸ ì¼ì • ë“±ë¡ ë° ì „ì‚¬ ì¼ì • ê³µìœ . Google Calendar ì—°ë™.",
    gradient: "from-blue-500 to-indigo-400",
  },
  {
    icon: Car,
    title: "ì°¨ëŸ‰ ìš´í–‰ì •ì‚°",
    description: "ê³„ê¸°íŒ ì‚¬ì§„ ì—…ë¡œë“œë¡œ ì£¼í–‰ ê±°ë¦¬ ë° ìœ ë¥˜ë¹„ ìë™ ê³„ì‚°.",
    gradient: "from-teal-500 to-cyan-400",
  },
  {
    icon: MessageSquare,
    title: "í”„ë¡œì íŠ¸ í—ˆë¸Œ",
    description: "Slack ìŠ¤íƒ€ì¼ ì‹¤ì‹œê°„ í”¼ë“œ. @ë©˜ì…˜, ì‹œìŠ¤í…œ ë¡œê·¸ê°€ íƒ€ì„ë¼ì¸ìœ¼ë¡œ í†µí•©.",
    gradient: "from-violet-500 to-purple-400",
  },
];

export const FeaturesSection = () => {
  return (
    <section className="py-24 relative">
      <div className="container px-4">
        {/* Section Header */}
        <div className="text-center mb-16">
          <h2 className="text-3xl md:text-5xl font-bold mb-4">
            <span className="gradient-text">ì˜¬ì¸ì›</span> ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë«í¼
          </h2>
          <p className="text-muted-foreground text-lg max-w-2xl mx-auto">
            ì²­êµ¬ ê´€ë¦¬ë¶€í„° ê·¸ë£¹ì›¨ì–´ê¹Œì§€, ë¹„ì¦ˆë‹ˆìŠ¤ì— í•„ìš”í•œ ëª¨ë“  ê¸°ëŠ¥ì„ í•˜ë‚˜ì˜ ì‹œìŠ¤í…œì—ì„œ
          </p>
        </div>

        {/* Features Grid */}
        <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
          {features.map((feature, index) => (
            <div
              key={feature.title}
              className="glass-card-hover p-6 group"
              style={{ animationDelay: `${index * 0.05}s` }}
            >
              {/* Icon */}
              <div className={`w-12 h-12 rounded-xl bg-gradient-to-br ${feature.gradient} p-2.5 mb-4 transition-transform group-hover:scale-110`}>
                <feature.icon className="w-full h-full text-white" />
              </div>

              {/* Content */}
              <h3 className="text-lg font-semibold mb-2 text-foreground">
                {feature.title}
              </h3>
              <p className="text-sm text-muted-foreground leading-relaxed">
                {feature.description}
              </p>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
};



============================================================
File Path: src/components/landing/Footer.tsx
============================================================
import { Link } from "react-router-dom";

export const Footer = () => {
  return (
    <footer className="border-t border-border/50 py-12">
      <div className="container px-4">
        <div className="grid md:grid-cols-4 gap-8">
          {/* Brand */}
          <div className="md:col-span-1">
            <Link to="/" className="flex items-center gap-2 mb-4">
              <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-accent flex items-center justify-center">
                <span className="text-primary-foreground font-bold text-sm">B</span>
              </div>
              <span className="font-bold text-lg">
                <span className="gradient-text">Boteda</span> OS
              </span>
            </Link>
            <p className="text-sm text-muted-foreground">
              Boteda Management Solution - ì°¨ì„¸ëŒ€ ë©€í‹° í…Œë„ŒíŠ¸ ì—”í„°í”„ë¼ì´ì¦ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ
            </p>
          </div>

          {/* Links */}
          <div>
            <h4 className="font-semibold mb-4 text-sm">ì œí’ˆ</h4>
            <ul className="space-y-2">
              <li><Link to="/guest-form" className="text-sm text-muted-foreground hover:text-foreground transition-colors">ê±°ë˜ì²˜ ì²­êµ¬</Link></li>
              <li><Link to="/dashboard" className="text-sm text-muted-foreground hover:text-foreground transition-colors">ëŒ€ì‹œë³´ë“œ</Link></li>
              <li><Link to="/super-admin" className="text-sm text-muted-foreground hover:text-foreground transition-colors">ìŠˆí¼ ì–´ë“œë¯¼</Link></li>
            </ul>
          </div>

          <div>
            <h4 className="font-semibold mb-4 text-sm">ê¸°ëŠ¥</h4>
            <ul className="space-y-2">
              <li><span className="text-sm text-muted-foreground">ì „ìê²°ì¬</span></li>
              <li><span className="text-sm text-muted-foreground">ê·¸ë£¹ì›¨ì–´</span></li>
              <li><span className="text-sm text-muted-foreground">í”„ë¡œì íŠ¸ í—ˆë¸Œ</span></li>
            </ul>
          </div>

          <div>
            <h4 className="font-semibold mb-4 text-sm">ì§€ì›</h4>
            <ul className="space-y-2">
              <li><span className="text-sm text-muted-foreground">ë¬¸ì„œ</span></li>
              <li><span className="text-sm text-muted-foreground">API ë ˆí¼ëŸ°ìŠ¤</span></li>
              <li><span className="text-sm text-muted-foreground">ê³ ê° ì§€ì›</span></li>
            </ul>
          </div>
        </div>

        <div className="mt-12 pt-8 border-t border-border/50 flex flex-col md:flex-row items-center justify-between gap-4">
          <p className="text-sm text-muted-foreground">
            Â© 2025 Boteda Management Solution. All rights reserved.
          </p>
          <div className="flex gap-6">
            <span className="text-sm text-muted-foreground hover:text-foreground cursor-pointer">ì´ìš©ì•½ê´€</span>
            <span className="text-sm text-muted-foreground hover:text-foreground cursor-pointer">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span>
          </div>
        </div>
      </div>
    </footer>
  );
};



============================================================
File Path: src/components/landing/Header.tsx
============================================================
import { useState } from "react";
import { Link, useNavigate } from "react-router-dom";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { 
  Menu, 
  X, 
  Search, 
  Bell, 
  User, 
  LogOut, 
  CreditCard, 
  Building2, 
  ChevronDown, 
  ShieldCheck, 
  Settings, 
} from "lucide-react";
import { useAuth } from "@/hooks/useAuth";
import { toast } from "sonner";
import { Badge } from "@/components/ui/badge";

export const Header = () => {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const { user, profile, currentTenant, memberships, setCurrentTenant, signOut, isSuperAdmin, isCompanyAdmin } = useAuth();
  const navigate = useNavigate();

  const navLinks = [
    { href: "/", label: "í™ˆ" },
    { href: "/guest-form", label: "ê±°ë˜ì²˜ ì²­êµ¬" },
    { href: "/dashboard", label: "ëŒ€ì‹œë³´ë“œ" },
  ];

  const handleSignOut = async () => {
    await signOut();
    toast.success("ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤");
    navigate("/");
  };

  const getInitials = (name: string | null) => {
    if (!name) return "U";
    return name.slice(0, 2);
  };

  return (
    <header className="fixed top-0 left-0 right-0 z-50 bg-card/95 backdrop-blur-xl border-b border-border shadow-sm">
      <div className="container mx-auto px-4">
        <div className="flex items-center justify-between h-16 gap-4">
          
          {/* 1. ë¡œê³  */}
          <Link to="/" className="flex items-center gap-2 shrink-0">
            <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-accent flex items-center justify-center">
              <span className="text-primary-foreground font-bold text-sm">B</span>
            </div>
            <span className="font-bold text-lg hidden sm:block text-slate-900">
              <span className="gradient-text">Boteda</span> OS
            </span>
          </Link>

          {/* 2. íšŒì‚¬ ì„ íƒê¸° (ìŠˆí¼ ì–´ë“œë¯¼ì€ ëª¨ë“  íšŒì‚¬ ëª©ë¡ ì ‘ê·¼ ê°€ëŠ¥) */}
          {user && memberships.length > 0 && (
            <div className="hidden lg:flex items-center gap-2">
              <DropdownMenu>
                <DropdownMenuTrigger asChild>
                  <Button variant="outline" size="sm" className="gap-2 text-sm font-normal min-w-[140px] justify-between">
                    <div className="flex items-center gap-2 truncate">
                      <Building2 className="w-4 h-4 shrink-0" />
                      <span className="truncate">{currentTenant?.tenant.name || "íšŒì‚¬ ì„ íƒ"}</span>
                    </div>
                    <ChevronDown className="w-3 h-3 text-muted-foreground shrink-0" />
                  </Button>
                </DropdownMenuTrigger>
                <DropdownMenuContent align="start" className="w-64 z-50 shadow-xl border-slate-200">
                  <DropdownMenuLabel>{isSuperAdmin ? "ì‹œìŠ¤í…œ ì „ì²´ íšŒì‚¬ ëª©ë¡" : "ì†Œì† íšŒì‚¬"}</DropdownMenuLabel>
                  <DropdownMenuSeparator />
                  <div className="max-h-[400px] overflow-y-auto">
                    {memberships.map((membership) => (
                      <DropdownMenuItem key={membership.id} className="cursor-pointer gap-2 py-3" onClick={() => setCurrentTenant(membership)}>
                        <Building2 className="w-4 h-4 text-primary" />
                        <div className="flex-1 min-w-0">
                          <div className="font-bold truncate text-slate-800">{membership.tenant.name}</div>
                          <div className="text-[10px] text-muted-foreground">{isSuperAdmin ? "ì‹œìŠ¤í…œ ì´ê´„" : membership.role}</div>
                        </div>
                      </DropdownMenuItem>
                    ))}
                  </div>
                </DropdownMenuContent>
              </DropdownMenu>
            </div>
          )}

          {/* 3. ê²€ìƒ‰ë°” */}
          <div className="hidden md:flex flex-1 max-w-md ml-4">
            <div className="relative w-full">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
              <Input type="text" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." className="pl-10 pr-4 bg-secondary/50 border-transparent h-9 text-sm focus:bg-white transition-all" />
            </div>
          </div>

          {/* 4. ë‚´ë¹„ê²Œì´ì…˜ & ê´€ë¦¬ì í†µí•© ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */}
          <nav className="hidden xl:flex items-center gap-2">
            {navLinks.map((link) => (
              <Link key={link.href} to={link.href} className="px-3 py-2 text-sm font-medium text-slate-600 hover:text-primary transition-colors rounded-lg hover:bg-slate-100">
                {link.label}
              </Link>
            ))}
            
            {/* [í•µì‹¬ ìˆ˜ì •] ìŠˆí¼ ì–´ë“œë¯¼ìš© ë“€ì–¼ ë²„íŠ¼ êµ¬ì¡° */}
            {(isSuperAdmin || isCompanyAdmin) && (
              <div className="flex items-center gap-2 ml-4 pl-4 border-l border-slate-200">
                
                {/* 1. ìŠˆí¼ ì–´ë“œë¯¼ ì„¼í„° ë²„íŠ¼ (ë¹¨ê°„ìƒ‰ ê°•ì¡°) */}
                {isSuperAdmin && (
                  <Button 
                    variant="default" 
                    size="sm" 
                    className="gap-2 bg-rose-600 hover:bg-rose-700 text-white font-bold shadow-md shadow-rose-200"
                    onClick={() => navigate("/super-admin")}
                  >
                    <ShieldCheck className="w-4 h-4" />
                    ìŠˆí¼ ì–´ë“œë¯¼ ì„¼í„°
                  </Button>
                )}

                {/* 2. ì¼ë°˜ ë³¸ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ ë²„íŠ¼ (íŒŒë€ìƒ‰) */}
                <Button 
                  variant="outline" 
                  size="sm" 
                  className="gap-2 border-primary/40 text-primary hover:bg-primary/5 font-bold"
                  onClick={() => navigate("/admin")}
                >
                  <Settings className="w-4 h-4" />
                  ê´€ë¦¬ ì‹œìŠ¤í…œ
                </Button>
              </div>
            )}
          </nav>

          {/* 5. ìš°ì¸¡ í”„ë¡œí•„ */}
          <div className="flex items-center gap-1">
            {user ? (
              <DropdownMenu>
                <DropdownMenuTrigger asChild>
                  <Button variant="ghost" className="gap-2 px-2 h-9 ml-2 hover:bg-slate-100 rounded-full">
                    <Avatar className="w-7 h-7 border border-slate-200 shadow-sm">
                      <AvatarFallback className="bg-primary/10 text-primary text-[10px] font-bold">
                        {getInitials(profile?.full_name)}
                      </AvatarFallback>
                    </Avatar>
                    <span className="hidden sm:block text-sm font-bold text-slate-700">{profile?.full_name}</span>
                    <ChevronDown className="w-3 h-3 text-muted-foreground hidden sm:block" />
                  </Button>
                </DropdownMenuTrigger>
                <DropdownMenuContent align="end" className="w-64 z-50 shadow-2xl border-slate-200">
                  <DropdownMenuLabel className="pb-3">
                    <div className="flex flex-col space-y-0.5">
                      <span className="font-bold text-slate-900">{profile?.full_name}</span>
                      <span className="text-xs text-muted-foreground font-normal">{profile?.email}</span>
                      {isSuperAdmin && <Badge className="mt-1 w-fit bg-rose-50 text-rose-600 border-rose-100 text-[9px] px-1.5 h-4">SYSTEM SUPER ADMIN</Badge>}
                    </div>
                  </DropdownMenuLabel>
                  
                  <DropdownMenuSeparator />
                  <DropdownMenuItem className="cursor-pointer gap-2 py-2.5 font-medium" onClick={() => navigate("/dashboard")}><User className="w-4 h-4" /> ë‚´ í”„ë¡œí•„ ì •ë³´</DropdownMenuItem>
                  
                  {/* ë“œë¡­ë‹¤ìš´ ë‚´ ìŠˆí¼ ì–´ë“œë¯¼ ì„¼í„° ë°”ë¡œê°€ê¸° */}
                  {isSuperAdmin && (
                    <DropdownMenuItem className="cursor-pointer gap-2 py-2.5 text-rose-600 focus:text-rose-600 font-bold" onClick={() => navigate("/super-admin")}>
                      <ShieldCheck className="w-4 h-4" /> ìŠˆí¼ ì–´ë“œë¯¼ ì„¼í„°
                    </DropdownMenuItem>
                  )}

                  {/* ë“œë¡­ë‹¤ìš´ ë‚´ ë³¸ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ ë°”ë¡œê°€ê¸° */}
                  {(isSuperAdmin || isCompanyAdmin) && (
                    <DropdownMenuItem className="cursor-pointer gap-2 py-2.5 text-primary focus:text-primary font-bold" onClick={() => navigate("/admin")}>
                      <Settings className="w-4 h-4" /> ë³¸ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ
                    </DropdownMenuItem>
                  )}

                  <DropdownMenuSeparator />
                  <DropdownMenuItem className="cursor-pointer gap-2 py-2.5 text-slate-500 hover:text-slate-900"><CreditCard className="w-4 h-4" /> ê²°ì œ ë° êµ¬ë… ê´€ë¦¬</DropdownMenuItem>
                  <DropdownMenuItem className="cursor-pointer gap-2 py-2.5 text-destructive focus:text-destructive font-bold" onClick={handleSignOut}><LogOut className="w-4 h-4" /> ë¡œê·¸ì•„ì›ƒ</DropdownMenuItem>
                </DropdownMenuContent>
              </DropdownMenu>
            ) : (
              <div className="flex items-center gap-2">
                <Link to="/auth"><Button variant="ghost" size="sm">ë¡œê·¸ì¸</Button></Link>
                <Link to="/auth"><Button size="sm">ì‹œì‘í•˜ê¸°</Button></Link>
              </div>
            )}
            
            {/* ëª¨ë°”ì¼ í–„ë²„ê±° ë©”ë‰´ ë²„íŠ¼ */}
            <button className="xl:hidden p-2 text-muted-foreground" onClick={() => setIsMenuOpen(!isMenuOpen)}>
              {isMenuOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
            </button>
          </div>
        </div>
      </div>

      {/* ëª¨ë°”ì¼ ë‚´ë¹„ê²Œì´ì…˜ íŒ¨ë„ */}
      {isMenuOpen && (
        <div className="xl:hidden border-t border-border bg-white p-4 flex flex-col gap-3 shadow-lg animate-in slide-in-from-top-2">
          {navLinks.map((link) => (
            <Link key={link.href} to={link.href} className="px-4 py-3 text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-xl" onClick={() => setIsMenuOpen(false)}>{link.label}</Link>
          ))}
          {isSuperAdmin && (
            <Link to="/super-admin" className="px-4 py-3 text-sm font-black text-rose-600 bg-rose-50 rounded-xl" onClick={() => setIsMenuOpen(false)}>ìŠˆí¼ ì–´ë“œë¯¼ ì„¼í„°</Link>
          )}
          {(isSuperAdmin || isCompanyAdmin) && (
            <Link to="/admin" className="px-4 py-3 text-sm font-black text-primary bg-primary/5 rounded-xl" onClick={() => setIsMenuOpen(false)}>ë³¸ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</Link>
          )}
        </div>
      )}
    </header>
  );
};  


============================================================
File Path: src/components/landing/HeroSection.tsx
============================================================
import { Button } from "@/components/ui/button";
import { ArrowRight, Sparkles } from "lucide-react";
import { Link } from "react-router-dom";

export const HeroSection = () => {
  return (
    <section className="relative min-h-screen flex items-center justify-center overflow-hidden">
      {/* Background Effects - Light theme with blue blobs like WEHAGO */}
      <div className="absolute inset-0 bg-gradient-to-b from-background via-background to-primary/5" />
      <div className="absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-gradient-to-r from-primary/15 via-primary/25 to-accent/15 rounded-full blur-[100px]" />
      <div className="absolute top-1/4 right-0 w-[300px] h-[300px] bg-accent/20 rounded-full blur-[80px]" />
      <div className="absolute bottom-1/4 left-0 w-[250px] h-[250px] bg-primary/15 rounded-full blur-[60px]" />
      
      {/* Grid Pattern - Subtle */}
      <div className="absolute inset-0 bg-[linear-gradient(to_right,hsl(var(--border)/0.5)_1px,transparent_1px),linear-gradient(to_bottom,hsl(var(--border)/0.5)_1px,transparent_1px)] bg-[size:6rem_6rem] opacity-30" />
      
      <div className="container relative z-10 px-4 py-20 text-center">
        {/* Badge */}
        <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-secondary/50 border border-border/50 backdrop-blur-sm mb-8 animate-fade-in">
          <Sparkles className="w-4 h-4 text-primary" />
          <span className="text-sm text-muted-foreground">
            ì°¨ì„¸ëŒ€ ì—”í„°í”„ë¼ì´ì¦ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ
          </span>
        </div>

        {/* Main Heading */}
        <h1 className="text-5xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight animate-slide-up">
          <span className="gradient-text">Boteda</span>
          <span className="text-foreground"> OS</span>
        </h1>

        {/* Subtitle */}
        <p className="text-xl md:text-2xl text-muted-foreground max-w-3xl mx-auto mb-12 leading-relaxed animate-slide-up" style={{ animationDelay: '0.1s' }}>
          ë©€í‹° í…Œë„ŒíŠ¸ ì•„í‚¤í…ì²˜ ê¸°ë°˜ì˜ ì˜¬ì¸ì› ë¹„ì¦ˆë‹ˆìŠ¤ ìš´ì˜ í”Œë«í¼.
          <br className="hidden md:block" />
          ì²­êµ¬ ê´€ë¦¬ë¶€í„° ì „ìê²°ì¬, ê·¸ë£¹ì›¨ì–´ê¹Œì§€ í•˜ë‚˜ë¡œ.
        </p>

        {/* CTA Buttons */}
        <div className="flex flex-col sm:flex-row gap-4 justify-center items-center animate-slide-up" style={{ animationDelay: '0.2s' }}>
          <Link to="/guest-form">
            <Button variant="hero" size="xl" className="group">
              ê±°ë˜ì²˜ ì²­êµ¬ í¼
              <ArrowRight className="w-5 h-5 transition-transform group-hover:translate-x-1" />
            </Button>
          </Link>
          <Link to="/dashboard">
            <Button variant="glass" size="xl">
              ëŒ€ì‹œë³´ë“œ ë¯¸ë¦¬ë³´ê¸°
            </Button>
          </Link>
        </div>

        {/* Stats */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-8 mt-20 animate-slide-up" style={{ animationDelay: '0.3s' }}>
          {[
            { value: "100+", label: "ê¸°ì—… ê³ ê°" },
            { value: "99.9%", label: "ê°€ë™ë¥ " },
            { value: "50K+", label: "ì›” ì²­êµ¬ ì²˜ë¦¬" },
            { value: "24/7", label: "ê¸°ìˆ  ì§€ì›" },
          ].map((stat) => (
            <div key={stat.label} className="text-center">
              <div className="text-3xl md:text-4xl font-bold gradient-text mb-2">
                {stat.value}
              </div>
              <div className="text-sm text-muted-foreground">{stat.label}</div>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
};



============================================================
File Path: src/components/ui/accordion.tsx
============================================================
import * as React from "react";
import * as AccordionPrimitive from "@radix-ui/react-accordion";
import { ChevronDown } from "lucide-react";

import { cn } from "@/lib/utils";

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item ref={ref} className={cn("border-b", className)} {...props} />
));
AccordionItem.displayName = "AccordionItem";

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className,
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };



============================================================
File Path: src/components/ui/alert-dialog.tsx
============================================================
import * as React from "react";
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

const AlertDialog = AlertDialogPrimitive.Root;

const AlertDialogTrigger = AlertDialogPrimitive.Trigger;

const AlertDialogPortal = AlertDialogPrimitive.Portal;

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
    ref={ref}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className,
      )}
      {...props}
    />
  </AlertDialogPortal>
));
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;

const AlertDialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
AlertDialogHeader.displayName = "AlertDialogHeader";

const AlertDialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
AlertDialogFooter.displayName = "AlertDialogFooter";

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title ref={ref} className={cn("text-lg font-semibold", className)} {...props} />
));
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
AlertDialogDescription.displayName = AlertDialogPrimitive.Description.displayName;

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />
));
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(buttonVariants({ variant: "outline" }), "mt-2 sm:mt-0", className)}
    {...props}
  />
));
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};



============================================================
File Path: src/components/ui/alert.tsx
============================================================
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive: "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div ref={ref} role="alert" className={cn(alertVariants({ variant }), className)} {...props} />
));
Alert.displayName = "Alert";

const AlertTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h5 ref={ref} className={cn("mb-1 font-medium leading-none tracking-tight", className)} {...props} />
  ),
);
AlertTitle.displayName = "AlertTitle";

const AlertDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("text-sm [&_p]:leading-relaxed", className)} {...props} />
  ),
);
AlertDescription.displayName = "AlertDescription";

export { Alert, AlertTitle, AlertDescription };



============================================================
File Path: src/components/ui/aspect-ratio.tsx
============================================================
import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio";

const AspectRatio = AspectRatioPrimitive.Root;

export { AspectRatio };



============================================================
File Path: src/components/ui/avatar.tsx
============================================================
import * as React from "react";
import * as AvatarPrimitive from "@radix-ui/react-avatar";

import { cn } from "@/lib/utils";

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full", className)}
    {...props}
  />
));
Avatar.displayName = AvatarPrimitive.Root.displayName;

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image ref={ref} className={cn("aspect-square h-full w-full", className)} {...props} />
));
AvatarImage.displayName = AvatarPrimitive.Image.displayName;

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn("flex h-full w-full items-center justify-center rounded-full bg-muted", className)}
    {...props}
  />
));
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;

export { Avatar, AvatarImage, AvatarFallback };



============================================================
File Path: src/components/ui/badge.tsx
============================================================
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default: "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary: "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive: "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

export interface BadgeProps extends React.HTMLAttributes<HTMLDivElement>, VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return <div className={cn(badgeVariants({ variant }), className)} {...props} />;
}

export { Badge, badgeVariants };



============================================================
File Path: src/components/ui/breadcrumb.tsx
============================================================
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { ChevronRight, MoreHorizontal } from "lucide-react";

import { cn } from "@/lib/utils";

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<"nav"> & {
    separator?: React.ReactNode;
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />);
Breadcrumb.displayName = "Breadcrumb";

const BreadcrumbList = React.forwardRef<HTMLOListElement, React.ComponentPropsWithoutRef<"ol">>(
  ({ className, ...props }, ref) => (
    <ol
      ref={ref}
      className={cn(
        "flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",
        className,
      )}
      {...props}
    />
  ),
);
BreadcrumbList.displayName = "BreadcrumbList";

const BreadcrumbItem = React.forwardRef<HTMLLIElement, React.ComponentPropsWithoutRef<"li">>(
  ({ className, ...props }, ref) => (
    <li ref={ref} className={cn("inline-flex items-center gap-1.5", className)} {...props} />
  ),
);
BreadcrumbItem.displayName = "BreadcrumbItem";

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<"a"> & {
    asChild?: boolean;
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return <Comp ref={ref} className={cn("transition-colors hover:text-foreground", className)} {...props} />;
});
BreadcrumbLink.displayName = "BreadcrumbLink";

const BreadcrumbPage = React.forwardRef<HTMLSpanElement, React.ComponentPropsWithoutRef<"span">>(
  ({ className, ...props }, ref) => (
    <span
      ref={ref}
      role="link"
      aria-disabled="true"
      aria-current="page"
      className={cn("font-normal text-foreground", className)}
      {...props}
    />
  ),
);
BreadcrumbPage.displayName = "BreadcrumbPage";

const BreadcrumbSeparator = ({ children, className, ...props }: React.ComponentProps<"li">) => (
  <li role="presentation" aria-hidden="true" className={cn("[&>svg]:size-3.5", className)} {...props}>
    {children ?? <ChevronRight />}
  </li>
);
BreadcrumbSeparator.displayName = "BreadcrumbSeparator";

const BreadcrumbEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span
    role="presentation"
    aria-hidden="true"
    className={cn("flex h-9 w-9 items-center justify-center", className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
);
BreadcrumbEllipsis.displayName = "BreadcrumbElipssis";

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
};



============================================================
File Path: src/components/ui/button.tsx
============================================================
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",
        destructive: "bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-md",
        outline: "border border-border bg-transparent hover:bg-secondary hover:text-secondary-foreground",
        secondary: "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-secondary hover:text-secondary-foreground",
        link: "text-primary underline-offset-4 hover:underline",
        hero: "bg-gradient-to-r from-primary to-accent text-primary-foreground shadow-lg hover:shadow-xl hover:scale-[1.02] active:scale-[0.98]",
        glass: "bg-card/50 backdrop-blur-sm border border-border/50 text-foreground hover:bg-card/70 hover:border-primary/30",
        success: "bg-success text-success-foreground hover:bg-success/90 shadow-md",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-12 rounded-lg px-8 text-base",
        xl: "h-14 rounded-xl px-10 text-lg",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";
    return <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />;
  },
);
Button.displayName = "Button";

export { Button, buttonVariants };



============================================================
File Path: src/components/ui/calendar.tsx
============================================================
import * as React from "react";
import { ChevronLeft, ChevronRight } from "lucide-react";
import { DayPicker } from "react-day-picker";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({ className, classNames, showOutsideDays = true, ...props }: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium",
        nav: "space-x-1 flex items-center",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell: "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(buttonVariants({ variant: "ghost" }), "h-9 w-9 p-0 font-normal aria-selected:opacity-100"),
        day_range_end: "day-range-end",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle: "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        IconLeft: ({ ..._props }) => <ChevronLeft className="h-4 w-4" />,
        IconRight: ({ ..._props }) => <ChevronRight className="h-4 w-4" />,
      }}
      {...props}
    />
  );
}
Calendar.displayName = "Calendar";

export { Calendar };



============================================================
File Path: src/components/ui/card.tsx
============================================================
import * as React from "react";

import { cn } from "@/lib/utils";

const Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("rounded-lg border bg-card text-card-foreground shadow-sm", className)} {...props} />
));
Card.displayName = "Card";

const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex flex-col space-y-1.5 p-6", className)} {...props} />
  ),
);
CardHeader.displayName = "CardHeader";

const CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
  ),
);
CardTitle.displayName = "CardTitle";

const CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <p ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
  ),
);
CardDescription.displayName = "CardDescription";

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />,
);
CardContent.displayName = "CardContent";

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex items-center p-6 pt-0", className)} {...props} />
  ),
);
CardFooter.displayName = "CardFooter";

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };



============================================================
File Path: src/components/ui/carousel.tsx
============================================================
import * as React from "react";
import useEmblaCarousel, { type UseEmblaCarouselType } from "embla-carousel-react";
import { ArrowLeft, ArrowRight } from "lucide-react";

import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: "horizontal" | "vertical";
  setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />");
  }

  return context;
}

const Carousel = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement> & CarouselProps>(
  ({ orientation = "horizontal", opts, setApi, plugins, className, children, ...props }, ref) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === "horizontal" ? "x" : "y",
      },
      plugins,
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return;
      }

      setCanScrollPrev(api.canScrollPrev());
      setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
      api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === "ArrowLeft") {
          event.preventDefault();
          scrollPrev();
        } else if (event.key === "ArrowRight") {
          event.preventDefault();
          scrollNext();
        }
      },
      [scrollPrev, scrollNext],
    );

    React.useEffect(() => {
      if (!api || !setApi) {
        return;
      }

      setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
      if (!api) {
        return;
      }

      onSelect(api);
      api.on("reInit", onSelect);
      api.on("select", onSelect);

      return () => {
        api?.off("select", onSelect);
      };
    }, [api, onSelect]);

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation: orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn("relative", className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    );
  },
);
Carousel.displayName = "Carousel";

const CarouselContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const { carouselRef, orientation } = useCarousel();

    return (
      <div ref={carouselRef} className="overflow-hidden">
        <div
          ref={ref}
          className={cn("flex", orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col", className)}
          {...props}
        />
      </div>
    );
  },
);
CarouselContent.displayName = "CarouselContent";

const CarouselItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const { orientation } = useCarousel();

    return (
      <div
        ref={ref}
        role="group"
        aria-roledescription="slide"
        className={cn("min-w-0 shrink-0 grow-0 basis-full", orientation === "horizontal" ? "pl-4" : "pt-4", className)}
        {...props}
      />
    );
  },
);
CarouselItem.displayName = "CarouselItem";

const CarouselPrevious = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollPrev, canScrollPrev } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute h-8 w-8 rounded-full",
          orientation === "horizontal"
            ? "-left-12 top-1/2 -translate-y-1/2"
            : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
          className,
        )}
        disabled={!canScrollPrev}
        onClick={scrollPrev}
        {...props}
      >
        <ArrowLeft className="h-4 w-4" />
        <span className="sr-only">Previous slide</span>
      </Button>
    );
  },
);
CarouselPrevious.displayName = "CarouselPrevious";

const CarouselNext = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollNext, canScrollNext } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute h-8 w-8 rounded-full",
          orientation === "horizontal"
            ? "-right-12 top-1/2 -translate-y-1/2"
            : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
          className,
        )}
        disabled={!canScrollNext}
        onClick={scrollNext}
        {...props}
      >
        <ArrowRight className="h-4 w-4" />
        <span className="sr-only">Next slide</span>
      </Button>
    );
  },
);
CarouselNext.displayName = "CarouselNext";

export { type CarouselApi, Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };



============================================================
File Path: src/components/ui/chart.tsx
============================================================
import * as React from "react";
import * as RechartsPrimitive from "recharts";

import { cn } from "@/lib/utils";

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const;

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode;
    icon?: React.ComponentType;
  } & ({ color?: string; theme?: never } | { color?: never; theme: Record<keyof typeof THEMES, string> });
};

type ChartContextProps = {
  config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

function useChart() {
  const context = React.useContext(ChartContext);

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />");
  }

  return context;
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    config: ChartConfig;
    children: React.ComponentProps<typeof RechartsPrimitive.ResponsiveContainer>["children"];
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId();
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`;

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className,
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>{children}</RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  );
});
ChartContainer.displayName = "Chart";

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(([_, config]) => config.theme || config.color);

  if (!colorConfig.length) {
    return null;
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color = itemConfig.theme?.[theme as keyof typeof itemConfig.theme] || itemConfig.color;
    return color ? `  --color-${key}: ${color};` : null;
  })
  .join("\n")}
}
`,
          )
          .join("\n"),
      }}
    />
  );
};

const ChartTooltip = RechartsPrimitive.Tooltip;

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<"div"> & {
      hideLabel?: boolean;
      hideIndicator?: boolean;
      indicator?: "line" | "dot" | "dashed";
      nameKey?: string;
      labelKey?: string;
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = "dot",
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref,
  ) => {
    const { config } = useChart();

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null;
      }

      const [item] = payload;
      const key = `${labelKey || item.dataKey || item.name || "value"}`;
      const itemConfig = getPayloadConfigFromPayload(config, item, key);
      const value =
        !labelKey && typeof label === "string"
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label;

      if (labelFormatter) {
        return <div className={cn("font-medium", labelClassName)}>{labelFormatter(value, payload)}</div>;
      }

      if (!value) {
        return null;
      }

      return <div className={cn("font-medium", labelClassName)}>{value}</div>;
    }, [label, labelFormatter, payload, hideLabel, labelClassName, config, labelKey]);

    if (!active || !payload?.length) {
      return null;
    }

    const nestLabel = payload.length === 1 && indicator !== "dot";

    return (
      <div
        ref={ref}
        className={cn(
          "grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",
          className,
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || "value"}`;
            const itemConfig = getPayloadConfigFromPayload(config, item, key);
            const indicatorColor = color || item.payload.fill || item.color;

            return (
              <div
                key={item.dataKey}
                className={cn(
                  "flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",
                  indicator === "dot" && "items-center",
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]", {
                            "h-2.5 w-2.5": indicator === "dot",
                            "w-1": indicator === "line",
                            "w-0 border-[1.5px] border-dashed bg-transparent": indicator === "dashed",
                            "my-0.5": nestLabel && indicator === "dashed",
                          })}
                          style={
                            {
                              "--color-bg": indicatorColor,
                              "--color-border": indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        "flex flex-1 justify-between leading-none",
                        nestLabel ? "items-end" : "items-center",
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">{itemConfig?.label || item.name}</span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            );
          })}
        </div>
      </div>
    );
  },
);
ChartTooltipContent.displayName = "ChartTooltip";

const ChartLegend = RechartsPrimitive.Legend;

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> &
    Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
      hideIcon?: boolean;
      nameKey?: string;
    }
>(({ className, hideIcon = false, payload, verticalAlign = "bottom", nameKey }, ref) => {
  const { config } = useChart();

  if (!payload?.length) {
    return null;
  }

  return (
    <div
      ref={ref}
      className={cn("flex items-center justify-center gap-4", verticalAlign === "top" ? "pb-3" : "pt-3", className)}
    >
      {payload.map((item) => {
        const key = `${nameKey || item.dataKey || "value"}`;
        const itemConfig = getPayloadConfigFromPayload(config, item, key);

        return (
          <div
            key={item.value}
            className={cn("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground")}
          >
            {itemConfig?.icon && !hideIcon ? (
              <itemConfig.icon />
            ) : (
              <div
                className="h-2 w-2 shrink-0 rounded-[2px]"
                style={{
                  backgroundColor: item.color,
                }}
              />
            )}
            {itemConfig?.label}
          </div>
        );
      })}
    </div>
  );
});
ChartLegendContent.displayName = "ChartLegend";

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(config: ChartConfig, payload: unknown, key: string) {
  if (typeof payload !== "object" || payload === null) {
    return undefined;
  }

  const payloadPayload =
    "payload" in payload && typeof payload.payload === "object" && payload.payload !== null
      ? payload.payload
      : undefined;

  let configLabelKey: string = key;

  if (key in payload && typeof payload[key as keyof typeof payload] === "string") {
    configLabelKey = payload[key as keyof typeof payload] as string;
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[key as keyof typeof payloadPayload] as string;
  }

  return configLabelKey in config ? config[configLabelKey] : config[key as keyof typeof config];
}

export { ChartContainer, ChartTooltip, ChartTooltipContent, ChartLegend, ChartLegendContent, ChartStyle };



============================================================
File Path: src/components/ui/checkbox.tsx
============================================================
import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { Check } from "lucide-react";

import { cn } from "@/lib/utils";

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
      className,
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator className={cn("flex items-center justify-center text-current")}>
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };



============================================================
File Path: src/components/ui/collapsible.tsx
============================================================
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible";

const Collapsible = CollapsiblePrimitive.Root;

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger;

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent;

export { Collapsible, CollapsibleTrigger, CollapsibleContent };



============================================================
File Path: src/components/ui/command.tsx
============================================================
import * as React from "react";
import { type DialogProps } from "@radix-ui/react-dialog";
import { Command as CommandPrimitive } from "cmdk";
import { Search } from "lucide-react";

import { cn } from "@/lib/utils";
import { Dialog, DialogContent } from "@/components/ui/dialog";

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      "flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",
      className,
    )}
    {...props}
  />
));
Command.displayName = CommandPrimitive.displayName;

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    />
  </div>
));

CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn("max-h-[300px] overflow-y-auto overflow-x-hidden", className)}
    {...props}
  />
));

CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />);

CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
      className,
    )}
    {...props}
  />
));

CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator ref={ref} className={cn("-mx-1 h-px bg-border", className)} {...props} />
));
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className,
    )}
    {...props}
  />
));

CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
CommandShortcut.displayName = "CommandShortcut";

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
};



============================================================
File Path: src/components/ui/context-menu.tsx
============================================================
import * as React from "react";
import * as ContextMenuPrimitive from "@radix-ui/react-context-menu";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const ContextMenu = ContextMenuPrimitive.Root;

const ContextMenuTrigger = ContextMenuPrimitive.Trigger;

const ContextMenuGroup = ContextMenuPrimitive.Group;

const ContextMenuPortal = ContextMenuPrimitive.Portal;

const ContextMenuSub = ContextMenuPrimitive.Sub;

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
));
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
));
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
));
ContextMenuCheckboxItem.displayName = ContextMenuPrimitive.CheckboxItem.displayName;

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
));
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold text-foreground", inset && "pl-8", className)}
    {...props}
  />
));
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-border", className)} {...props} />
));
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;

const ContextMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
ContextMenuShortcut.displayName = "ContextMenuShortcut";

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
};



============================================================
File Path: src/components/ui/dialog.tsx
============================================================
import * as React from "react";
import * as DialogPrimitive from "@radix-ui/react-dialog";
import { X } from "lucide-react";

import { cn } from "@/lib/utils";

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className,
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-1.5 text-center sm:text-left", className)} {...props} />
);
DialogHeader.displayName = "DialogHeader";

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
DialogFooter.displayName = "DialogFooter";

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold leading-none tracking-tight", className)}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};



============================================================
File Path: src/components/ui/drawer.tsx
============================================================
import * as React from "react";
import { Drawer as DrawerPrimitive } from "vaul";

import { cn } from "@/lib/utils";

const Drawer = ({ shouldScaleBackground = true, ...props }: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root shouldScaleBackground={shouldScaleBackground} {...props} />
);
Drawer.displayName = "Drawer";

const DrawerTrigger = DrawerPrimitive.Trigger;

const DrawerPortal = DrawerPrimitive.Portal;

const DrawerClose = DrawerPrimitive.Close;

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay ref={ref} className={cn("fixed inset-0 z-50 bg-black/80", className)} {...props} />
));
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName;

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
        className,
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
));
DrawerContent.displayName = "DrawerContent";

const DrawerHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)} {...props} />
);
DrawerHeader.displayName = "DrawerHeader";

const DrawerFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("mt-auto flex flex-col gap-2 p-4", className)} {...props} />
);
DrawerFooter.displayName = "DrawerFooter";

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold leading-none tracking-tight", className)}
    {...props}
  />
));
DrawerTitle.displayName = DrawerPrimitive.Title.displayName;

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DrawerDescription.displayName = DrawerPrimitive.Description.displayName;

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
};



============================================================
File Path: src/components/ui/dropdown-menu.tsx
============================================================
import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest opacity-60", className)} {...props} />;
};
DropdownMenuShortcut.displayName = "DropdownMenuShortcut";

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};



============================================================
File Path: src/components/ui/form.tsx
============================================================
import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label";
import { Slot } from "@radix-ui/react-slot";
import { Controller, ControllerProps, FieldPath, FieldValues, FormProvider, useFormContext } from "react-hook-form";

import { cn } from "@/lib/utils";
import { Label } from "@/components/ui/label";

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>({} as FormFieldContextValue);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState, formState } = useFormContext();

  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>");
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>({} as FormItemContextValue);

const FormItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const id = React.useId();

    return (
      <FormItemContext.Provider value={{ id }}>
        <div ref={ref} className={cn("space-y-2", className)} {...props} />
      </FormItemContext.Provider>
    );
  },
);
FormItem.displayName = "FormItem";

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return <Label ref={ref} className={cn(error && "text-destructive", className)} htmlFor={formItemId} {...props} />;
});
FormLabel.displayName = "FormLabel";

const FormControl = React.forwardRef<React.ElementRef<typeof Slot>, React.ComponentPropsWithoutRef<typeof Slot>>(
  ({ ...props }, ref) => {
    const { error, formItemId, formDescriptionId, formMessageId } = useFormField();

    return (
      <Slot
        ref={ref}
        id={formItemId}
        aria-describedby={!error ? `${formDescriptionId}` : `${formDescriptionId} ${formMessageId}`}
        aria-invalid={!!error}
        {...props}
      />
    );
  },
);
FormControl.displayName = "FormControl";

const FormDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => {
    const { formDescriptionId } = useFormField();

    return <p ref={ref} id={formDescriptionId} className={cn("text-sm text-muted-foreground", className)} {...props} />;
  },
);
FormDescription.displayName = "FormDescription";

const FormMessage = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, children, ...props }, ref) => {
    const { error, formMessageId } = useFormField();
    const body = error ? String(error?.message) : children;

    if (!body) {
      return null;
    }

    return (
      <p ref={ref} id={formMessageId} className={cn("text-sm font-medium text-destructive", className)} {...props}>
        {body}
      </p>
    );
  },
);
FormMessage.displayName = "FormMessage";

export { useFormField, Form, FormItem, FormLabel, FormControl, FormDescription, FormMessage, FormField };



============================================================
File Path: src/components/ui/hover-card.tsx
============================================================
import * as React from "react";
import * as HoverCardPrimitive from "@radix-ui/react-hover-card";

import { cn } from "@/lib/utils";

const HoverCard = HoverCardPrimitive.Root;

const HoverCardTrigger = HoverCardPrimitive.Trigger;

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName;

export { HoverCard, HoverCardTrigger, HoverCardContent };



============================================================
File Path: src/components/ui/input-otp.tsx
============================================================
import * as React from "react";
import { OTPInput, OTPInputContext } from "input-otp";
import { Dot } from "lucide-react";

import { cn } from "@/lib/utils";

const InputOTP = React.forwardRef<React.ElementRef<typeof OTPInput>, React.ComponentPropsWithoutRef<typeof OTPInput>>(
  ({ className, containerClassName, ...props }, ref) => (
    <OTPInput
      ref={ref}
      containerClassName={cn("flex items-center gap-2 has-[:disabled]:opacity-50", containerClassName)}
      className={cn("disabled:cursor-not-allowed", className)}
      {...props}
    />
  ),
);
InputOTP.displayName = "InputOTP";

const InputOTPGroup = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(
  ({ className, ...props }, ref) => <div ref={ref} className={cn("flex items-center", className)} {...props} />,
);
InputOTPGroup.displayName = "InputOTPGroup";

const InputOTPSlot = React.forwardRef<
  React.ElementRef<"div">,
  React.ComponentPropsWithoutRef<"div"> & { index: number }
>(({ index, className, ...props }, ref) => {
  const inputOTPContext = React.useContext(OTPInputContext);
  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index];

  return (
    <div
      ref={ref}
      className={cn(
        "relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
        isActive && "z-10 ring-2 ring-ring ring-offset-background",
        className,
      )}
      {...props}
    >
      {char}
      {hasFakeCaret && (
        <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
          <div className="animate-caret-blink h-4 w-px bg-foreground duration-1000" />
        </div>
      )}
    </div>
  );
});
InputOTPSlot.displayName = "InputOTPSlot";

const InputOTPSeparator = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(
  ({ ...props }, ref) => (
    <div ref={ref} role="separator" {...props}>
      <Dot />
    </div>
  ),
);
InputOTPSeparator.displayName = "InputOTPSeparator";

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };



============================================================
File Path: src/components/ui/input.tsx
============================================================
import * as React from "react";

import { cn } from "@/lib/utils";

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Input.displayName = "Input";

export { Input };



============================================================
File Path: src/components/ui/label.tsx
============================================================
import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const labelVariants = cva("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70");

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> & VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root ref={ref} className={cn(labelVariants(), className)} {...props} />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };



============================================================
File Path: src/components/ui/menubar.tsx
============================================================
import * as React from "react";
import * as MenubarPrimitive from "@radix-ui/react-menubar";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const MenubarMenu = MenubarPrimitive.Menu;

const MenubarGroup = MenubarPrimitive.Group;

const MenubarPortal = MenubarPrimitive.Portal;

const MenubarSub = MenubarPrimitive.Sub;

const MenubarRadioGroup = MenubarPrimitive.RadioGroup;

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn("flex h-10 items-center space-x-1 rounded-md border bg-background p-1", className)}
    {...props}
  />
));
Menubar.displayName = MenubarPrimitive.Root.displayName;

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  />
));
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
));
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(({ className, align = "start", alignOffset = -4, sideOffset = 8, ...props }, ref) => (
  <MenubarPrimitive.Portal>
    <MenubarPrimitive.Content
      ref={ref}
      align={align}
      alignOffset={alignOffset}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </MenubarPrimitive.Portal>
));
MenubarContent.displayName = MenubarPrimitive.Content.displayName;

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
MenubarItem.displayName = MenubarPrimitive.Item.displayName;

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
));
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
));
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)}
    {...props}
  />
));
MenubarLabel.displayName = MenubarPrimitive.Label.displayName;

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;

const MenubarShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
MenubarShortcut.displayname = "MenubarShortcut";

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
};



============================================================
File Path: src/components/ui/navigation-menu.tsx
============================================================
import * as React from "react";
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu";
import { cva } from "class-variance-authority";
import { ChevronDown } from "lucide-react";

import { cn } from "@/lib/utils";

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn("relative z-10 flex max-w-max flex-1 items-center justify-center", className)}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
));
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn("group flex flex-1 list-none items-center justify-center space-x-1", className)}
    {...props}
  />
));
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;

const NavigationMenuItem = NavigationMenuPrimitive.Item;

const navigationMenuTriggerStyle = cva(
  "group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50",
);

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger
    ref={ref}
    className={cn(navigationMenuTriggerStyle(), "group", className)}
    {...props}
  >
    {children}{" "}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
));
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto",
      className,
    )}
    {...props}
  />
));
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;

const NavigationMenuLink = NavigationMenuPrimitive.Link;

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn("absolute left-0 top-full flex justify-center")}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
        className,
      )}
      ref={ref}
      {...props}
    />
  </div>
));
NavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",
      className,
    )}
    {...props}
  >
    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
));
NavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
};



============================================================
File Path: src/components/ui/pagination.tsx
============================================================
import * as React from "react";
import { ChevronLeft, ChevronRight, MoreHorizontal } from "lucide-react";

import { cn } from "@/lib/utils";
import { ButtonProps, buttonVariants } from "@/components/ui/button";

const Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (
  <nav
    role="navigation"
    aria-label="pagination"
    className={cn("mx-auto flex w-full justify-center", className)}
    {...props}
  />
);
Pagination.displayName = "Pagination";

const PaginationContent = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(
  ({ className, ...props }, ref) => (
    <ul ref={ref} className={cn("flex flex-row items-center gap-1", className)} {...props} />
  ),
);
PaginationContent.displayName = "PaginationContent";

const PaginationItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("", className)} {...props} />
));
PaginationItem.displayName = "PaginationItem";

type PaginationLinkProps = {
  isActive?: boolean;
} & Pick<ButtonProps, "size"> &
  React.ComponentProps<"a">;

const PaginationLink = ({ className, isActive, size = "icon", ...props }: PaginationLinkProps) => (
  <a
    aria-current={isActive ? "page" : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? "outline" : "ghost",
        size,
      }),
      className,
    )}
    {...props}
  />
);
PaginationLink.displayName = "PaginationLink";

const PaginationPrevious = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to previous page" size="default" className={cn("gap-1 pl-2.5", className)} {...props}>
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
);
PaginationPrevious.displayName = "PaginationPrevious";

const PaginationNext = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to next page" size="default" className={cn("gap-1 pr-2.5", className)} {...props}>
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
);
PaginationNext.displayName = "PaginationNext";

const PaginationEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span aria-hidden className={cn("flex h-9 w-9 items-center justify-center", className)} {...props}>
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
);
PaginationEllipsis.displayName = "PaginationEllipsis";

export {
  Pagination,
  PaginationContent,
  PaginationEllipsis,
  PaginationItem,
  PaginationLink,
  PaginationNext,
  PaginationPrevious,
};



============================================================
File Path: src/components/ui/popover.tsx
============================================================
import * as React from "react";
import * as PopoverPrimitive from "@radix-ui/react-popover";

import { cn } from "@/lib/utils";

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };



============================================================
File Path: src/components/ui/progress.tsx
============================================================
import * as React from "react";
import * as ProgressPrimitive from "@radix-ui/react-progress";

import { cn } from "@/lib/utils";

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn("relative h-4 w-full overflow-hidden rounded-full bg-secondary", className)}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
));
Progress.displayName = ProgressPrimitive.Root.displayName;

export { Progress };



============================================================
File Path: src/components/ui/radio-group.tsx
============================================================
import * as React from "react";
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group";
import { Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return <RadioGroupPrimitive.Root className={cn("grid gap-2", className)} {...props} ref={ref} />;
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };



============================================================
File Path: src/components/ui/resizable.tsx
============================================================
import { GripVertical } from "lucide-react";
import * as ResizablePrimitive from "react-resizable-panels";

import { cn } from "@/lib/utils";

const ResizablePanelGroup = ({ className, ...props }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn("flex h-full w-full data-[panel-group-direction=vertical]:flex-col", className)}
    {...props}
  />
);

const ResizablePanel = ResizablePrimitive.Panel;

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean;
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 [&[data-panel-group-direction=vertical]>div]:rotate-90",
      className,
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
);

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };



============================================================
File Path: src/components/ui/scroll-area.tsx
============================================================
import * as React from "react";
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area";

import { cn } from "@/lib/utils";

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root ref={ref} className={cn("relative overflow-hidden", className)} {...props}>
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">{children}</ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
));
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" && "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" && "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className,
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
));
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;

export { ScrollArea, ScrollBar };



============================================================
File Path: src/components/ui/select.tsx
============================================================
import * as React from "react";
import * as SelectPrimitive from "@radix-ui/react-select";
import { Check, ChevronDown, ChevronUp } from "lucide-react";

import { cn } from "@/lib/utils";

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className,
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn("flex cursor-default items-center justify-center py-1", className)}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn("flex cursor-default items-center justify-center py-1", className)}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className,
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]",
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label ref={ref} className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)} {...props} />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};



============================================================
File Path: src/components/ui/separator.tsx
============================================================
import * as React from "react";
import * as SeparatorPrimitive from "@radix-ui/react-separator";

import { cn } from "@/lib/utils";

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(({ className, orientation = "horizontal", decorative = true, ...props }, ref) => (
  <SeparatorPrimitive.Root
    ref={ref}
    decorative={decorative}
    orientation={orientation}
    className={cn("shrink-0 bg-border", orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]", className)}
    {...props}
  />
));
Separator.displayName = SeparatorPrimitive.Root.displayName;

export { Separator };



============================================================
File Path: src/components/ui/sheet.tsx
============================================================
import * as SheetPrimitive from "@radix-ui/react-dialog";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "lucide-react";
import * as React from "react";

import { cn } from "@/lib/utils";

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom:
          "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  },
);

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<React.ElementRef<typeof SheetPrimitive.Content>, SheetContentProps>(
  ({ side = "right", className, children, ...props }, ref) => (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>
        {children}
        <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none">
          <X className="h-4 w-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  ),
);
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
SheetHeader.displayName = "SheetHeader";

const SheetFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
SheetFooter.displayName = "SheetFooter";

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title ref={ref} className={cn("text-lg font-semibold text-foreground", className)} {...props} />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export {
  Sheet,
  SheetClose,
  SheetContent,
  SheetDescription,
  SheetFooter,
  SheetHeader,
  SheetOverlay,
  SheetPortal,
  SheetTitle,
  SheetTrigger,
};



============================================================
File Path: src/components/ui/sidebar.tsx
============================================================
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { VariantProps, cva } from "class-variance-authority";
import { PanelLeft } from "lucide-react";

import { useIsMobile } from "@/hooks/use-mobile";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Separator } from "@/components/ui/separator";
import { Sheet, SheetContent } from "@/components/ui/sheet";
import { Skeleton } from "@/components/ui/skeleton";
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from "@/components/ui/tooltip";

const SIDEBAR_COOKIE_NAME = "sidebar:state";
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = "16rem";
const SIDEBAR_WIDTH_MOBILE = "18rem";
const SIDEBAR_WIDTH_ICON = "3rem";
const SIDEBAR_KEYBOARD_SHORTCUT = "b";

type SidebarContext = {
  state: "expanded" | "collapsed";
  open: boolean;
  setOpen: (open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContext | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.");
  }

  return context;
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
  }
>(({ defaultOpen = true, open: openProp, onOpenChange: setOpenProp, className, style, children, ...props }, ref) => {
  const isMobile = useIsMobile();
  const [openMobile, setOpenMobile] = React.useState(false);

  // This is the internal state of the sidebar.
  // We use openProp and setOpenProp for control from outside the component.
  const [_open, _setOpen] = React.useState(defaultOpen);
  const open = openProp ?? _open;
  const setOpen = React.useCallback(
    (value: boolean | ((value: boolean) => boolean)) => {
      const openState = typeof value === "function" ? value(open) : value;
      if (setOpenProp) {
        setOpenProp(openState);
      } else {
        _setOpen(openState);
      }

      // This sets the cookie to keep the sidebar state.
      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
    },
    [setOpenProp, open],
  );

  // Helper to toggle the sidebar.
  const toggleSidebar = React.useCallback(() => {
    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
  }, [isMobile, setOpen, setOpenMobile]);

  // Adds a keyboard shortcut to toggle the sidebar.
  React.useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
        event.preventDefault();
        toggleSidebar();
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [toggleSidebar]);

  // We add a state so that we can do data-state="expanded" or "collapsed".
  // This makes it easier to style the sidebar with Tailwind classes.
  const state = open ? "expanded" : "collapsed";

  const contextValue = React.useMemo<SidebarContext>(
    () => ({
      state,
      open,
      setOpen,
      isMobile,
      openMobile,
      setOpenMobile,
      toggleSidebar,
    }),
    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],
  );

  return (
    <SidebarContext.Provider value={contextValue}>
      <TooltipProvider delayDuration={0}>
        <div
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH,
              "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
              ...style,
            } as React.CSSProperties
          }
          className={cn("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar", className)}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      </TooltipProvider>
    </SidebarContext.Provider>
  );
});
SidebarProvider.displayName = "SidebarProvider";

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    side?: "left" | "right";
    variant?: "sidebar" | "floating" | "inset";
    collapsible?: "offcanvas" | "icon" | "none";
  }
>(({ side = "left", variant = "sidebar", collapsible = "offcanvas", className, children, ...props }, ref) => {
  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

  if (collapsible === "none") {
    return (
      <div
        className={cn("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground", className)}
        ref={ref}
        {...props}
      >
        {children}
      </div>
    );
  }

  if (isMobile) {
    return (
      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
        <SheetContent
          data-sidebar="sidebar"
          data-mobile="true"
          className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
            } as React.CSSProperties
          }
          side={side}
        >
          <div className="flex h-full w-full flex-col">{children}</div>
        </SheetContent>
      </Sheet>
    );
  }

  return (
    <div
      ref={ref}
      className="group peer hidden text-sidebar-foreground md:block"
      data-state={state}
      data-collapsible={state === "collapsed" ? collapsible : ""}
      data-variant={variant}
      data-side={side}
    >
      {/* This is what handles the sidebar gap on desktop */}
      <div
        className={cn(
          "relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear",
          "group-data-[collapsible=offcanvas]:w-0",
          "group-data-[side=right]:rotate-180",
          variant === "floating" || variant === "inset"
            ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]",
        )}
      />
      <div
        className={cn(
          "fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",
          side === "left"
            ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
            : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
          // Adjust the padding for floating and inset variants.
          variant === "floating" || variant === "inset"
            ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
          className,
        )}
        {...props}
      >
        <div
          data-sidebar="sidebar"
          className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
        >
          {children}
        </div>
      </div>
    </div>
  );
});
Sidebar.displayName = "Sidebar";

const SidebarTrigger = React.forwardRef<React.ElementRef<typeof Button>, React.ComponentProps<typeof Button>>(
  ({ className, onClick, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <Button
        ref={ref}
        data-sidebar="trigger"
        variant="ghost"
        size="icon"
        className={cn("h-7 w-7", className)}
        onClick={(event) => {
          onClick?.(event);
          toggleSidebar();
        }}
        {...props}
      >
        <PanelLeft />
        <span className="sr-only">Toggle Sidebar</span>
      </Button>
    );
  },
);
SidebarTrigger.displayName = "SidebarTrigger";

const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button">>(
  ({ className, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <button
        ref={ref}
        data-sidebar="rail"
        aria-label="Toggle Sidebar"
        tabIndex={-1}
        onClick={toggleSidebar}
        title="Toggle Sidebar"
        className={cn(
          "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 hover:after:bg-sidebar-border sm:flex",
          "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
          "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
          "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
          "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
          "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarRail.displayName = "SidebarRail";

const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<"main">>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        "relative flex min-h-svh flex-1 flex-col bg-background",
        "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
        className,
      )}
      {...props}
    />
  );
});
SidebarInset.displayName = "SidebarInset";

const SidebarInput = React.forwardRef<React.ElementRef<typeof Input>, React.ComponentProps<typeof Input>>(
  ({ className, ...props }, ref) => {
    return (
      <Input
        ref={ref}
        data-sidebar="input"
        className={cn(
          "h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarInput.displayName = "SidebarInput";

const SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="header" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarHeader.displayName = "SidebarHeader";

const SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="footer" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarFooter.displayName = "SidebarFooter";

const SidebarSeparator = React.forwardRef<React.ElementRef<typeof Separator>, React.ComponentProps<typeof Separator>>(
  ({ className, ...props }, ref) => {
    return (
      <Separator
        ref={ref}
        data-sidebar="separator"
        className={cn("mx-2 w-auto bg-sidebar-border", className)}
        {...props}
      />
    );
  },
);
SidebarSeparator.displayName = "SidebarSeparator";

const SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn(
        "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
        className,
      )}
      {...props}
    />
  );
});
SidebarContent.displayName = "SidebarContent";

const SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="group"
      className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
      {...props}
    />
  );
});
SidebarGroup.displayName = "SidebarGroup";

const SidebarGroupLabel = React.forwardRef<HTMLDivElement, React.ComponentProps<"div"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "div";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-label"
        className={cn(
          "flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarGroupLabel.displayName = "SidebarGroupLabel";

const SidebarGroupAction = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-action"
        className={cn(
          "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          // Increases the hit area of the button on mobile.
          "after:absolute after:-inset-2 after:md:hidden",
          "group-data-[collapsible=icon]:hidden",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarGroupAction.displayName = "SidebarGroupAction";

const SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(
  ({ className, ...props }, ref) => (
    <div ref={ref} data-sidebar="group-content" className={cn("w-full text-sm", className)} {...props} />
  ),
);
SidebarGroupContent.displayName = "SidebarGroupContent";

const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul ref={ref} data-sidebar="menu" className={cn("flex w-full min-w-0 flex-col gap-1", className)} {...props} />
));
SidebarMenu.displayName = "SidebarMenu";

const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} data-sidebar="menu-item" className={cn("group/menu-item relative", className)} {...props} />
));
SidebarMenuItem.displayName = "SidebarMenuItem";

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(({ asChild = false, isActive = false, variant = "default", size = "default", tooltip, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";
  const { isMobile, state } = useSidebar();

  const button = (
    <Comp
      ref={ref}
      data-sidebar="menu-button"
      data-size={size}
      data-active={isActive}
      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
      {...props}
    />
  );

  if (!tooltip) {
    return button;
  }

  if (typeof tooltip === "string") {
    tooltip = {
      children: tooltip,
    };
  }

  return (
    <Tooltip>
      <TooltipTrigger asChild>{button}</TooltipTrigger>
      <TooltipContent side="right" align="center" hidden={state !== "collapsed" || isMobile} {...tooltip} />
    </Tooltip>
  );
});
SidebarMenuButton.displayName = "SidebarMenuButton";

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    showOnHover?: boolean;
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform peer-hover/menu-button:text-sidebar-accent-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
        className,
      )}
      {...props}
    />
  );
});
SidebarMenuAction.displayName = "SidebarMenuAction";

const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      data-sidebar="menu-badge"
      className={cn(
        "pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground",
        "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  ),
);
SidebarMenuBadge.displayName = "SidebarMenuBadge";

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    showIcon?: boolean;
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);

  return (
    <div
      ref={ref}
      data-sidebar="menu-skeleton"
      className={cn("flex h-8 items-center gap-2 rounded-md px-2", className)}
      {...props}
    >
      {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
      <Skeleton
        className="h-4 max-w-[--skeleton-width] flex-1"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  );
});
SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton";

const SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(
  ({ className, ...props }, ref) => (
    <ul
      ref={ref}
      data-sidebar="menu-sub"
      className={cn(
        "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  ),
);
SidebarMenuSub.displayName = "SidebarMenuSub";

const SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ ...props }, ref) => (
  <li ref={ref} {...props} />
));
SidebarMenuSubItem.displayName = "SidebarMenuSubItem";

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<"a"> & {
    asChild?: boolean;
    size?: "sm" | "md";
    isActive?: boolean;
  }
>(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring aria-disabled:pointer-events-none aria-disabled:opacity-50 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  );
});
SidebarMenuSubButton.displayName = "SidebarMenuSubButton";

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};



============================================================
File Path: src/components/ui/skeleton.tsx
============================================================
import { cn } from "@/lib/utils";

function Skeleton({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {
  return <div className={cn("animate-pulse rounded-md bg-muted", className)} {...props} />;
}

export { Skeleton };



============================================================
File Path: src/components/ui/slider.tsx
============================================================
import * as React from "react";
import * as SliderPrimitive from "@radix-ui/react-slider";

import { cn } from "@/lib/utils";

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn("relative flex w-full touch-none select-none items-center", className)}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
));
Slider.displayName = SliderPrimitive.Root.displayName;

export { Slider };



============================================================
File Path: src/components/ui/sonner.tsx
============================================================
import { useTheme } from "next-themes";
import { Toaster as Sonner, toast } from "sonner";

type ToasterProps = React.ComponentProps<typeof Sonner>;

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme();

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
          description: "group-[.toast]:text-muted-foreground",
          actionButton: "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
          cancelButton: "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
        },
      }}
      {...props}
    />
  );
};

export { Toaster, toast };



============================================================
File Path: src/components/ui/switch.tsx
============================================================
import * as React from "react";
import * as SwitchPrimitives from "@radix-ui/react-switch";

import { cn } from "@/lib/utils";

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",
      className,
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0",
      )}
    />
  </SwitchPrimitives.Root>
));
Switch.displayName = SwitchPrimitives.Root.displayName;

export { Switch };



============================================================
File Path: src/components/ui/table.tsx
============================================================
import * as React from "react";

import { cn } from "@/lib/utils";

const Table = React.forwardRef<HTMLTableElement, React.HTMLAttributes<HTMLTableElement>>(
  ({ className, ...props }, ref) => (
    <div className="relative w-full overflow-auto">
      <table ref={ref} className={cn("w-full caption-bottom text-sm", className)} {...props} />
    </div>
  ),
);
Table.displayName = "Table";

const TableHeader = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />,
);
TableHeader.displayName = "TableHeader";

const TableBody = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => (
    <tbody ref={ref} className={cn("[&_tr:last-child]:border-0", className)} {...props} />
  ),
);
TableBody.displayName = "TableBody";

const TableFooter = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => (
    <tfoot ref={ref} className={cn("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0", className)} {...props} />
  ),
);
TableFooter.displayName = "TableFooter";

const TableRow = React.forwardRef<HTMLTableRowElement, React.HTMLAttributes<HTMLTableRowElement>>(
  ({ className, ...props }, ref) => (
    <tr
      ref={ref}
      className={cn("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50", className)}
      {...props}
    />
  ),
);
TableRow.displayName = "TableRow";

const TableHead = React.forwardRef<HTMLTableCellElement, React.ThHTMLAttributes<HTMLTableCellElement>>(
  ({ className, ...props }, ref) => (
    <th
      ref={ref}
      className={cn(
        "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
        className,
      )}
      {...props}
    />
  ),
);
TableHead.displayName = "TableHead";

const TableCell = React.forwardRef<HTMLTableCellElement, React.TdHTMLAttributes<HTMLTableCellElement>>(
  ({ className, ...props }, ref) => (
    <td ref={ref} className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)} {...props} />
  ),
);
TableCell.displayName = "TableCell";

const TableCaption = React.forwardRef<HTMLTableCaptionElement, React.HTMLAttributes<HTMLTableCaptionElement>>(
  ({ className, ...props }, ref) => (
    <caption ref={ref} className={cn("mt-4 text-sm text-muted-foreground", className)} {...props} />
  ),
);
TableCaption.displayName = "TableCaption";

export { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };



============================================================
File Path: src/components/ui/tabs.tsx
============================================================
import * as React from "react";
import * as TabsPrimitive from "@radix-ui/react-tabs";

import { cn } from "@/lib/utils";

const Tabs = TabsPrimitive.Root;

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className,
    )}
    {...props}
  />
));
TabsList.displayName = TabsPrimitive.List.displayName;

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",
      className,
    )}
    {...props}
  />
));
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className,
    )}
    {...props}
  />
));
TabsContent.displayName = TabsPrimitive.Content.displayName;

export { Tabs, TabsList, TabsTrigger, TabsContent };



============================================================
File Path: src/components/ui/textarea.tsx
============================================================
import * as React from "react";

import { cn } from "@/lib/utils";

export interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(({ className, ...props }, ref) => {
  return (
    <textarea
      className={cn(
        "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      ref={ref}
      {...props}
    />
  );
});
Textarea.displayName = "Textarea";

export { Textarea };



============================================================
File Path: src/components/ui/toast.tsx
============================================================
import * as React from "react";
import * as ToastPrimitives from "@radix-ui/react-toast";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "lucide-react";

import { cn } from "@/lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
      className,
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
  {
    variants: {
      variant: {
        default: "border bg-background text-foreground",
        destructive: "destructive group border-destructive bg-destructive text-destructive-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> & VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return <ToastPrimitives.Root ref={ref} className={cn(toastVariants({ variant }), className)} {...props} />;
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",
      className,
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
      className,
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title ref={ref} className={cn("text-sm font-semibold", className)} {...props} />
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description ref={ref} className={cn("text-sm opacity-90", className)} {...props} />
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};



============================================================
File Path: src/components/ui/toaster.tsx
============================================================
import { useToast } from "@/hooks/use-toast";
import { Toast, ToastClose, ToastDescription, ToastProvider, ToastTitle, ToastViewport } from "@/components/ui/toast";

export function Toaster() {
  const { toasts } = useToast();

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && <ToastDescription>{description}</ToastDescription>}
            </div>
            {action}
            <ToastClose />
          </Toast>
        );
      })}
      <ToastViewport />
    </ToastProvider>
  );
}



============================================================
File Path: src/components/ui/toggle-group.tsx
============================================================
import * as React from "react";
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group";
import { type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";
import { toggleVariants } from "@/components/ui/toggle";

const ToggleGroupContext = React.createContext<VariantProps<typeof toggleVariants>>({
  size: "default",
  variant: "default",
});

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> & VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root ref={ref} className={cn("flex items-center justify-center gap-1", className)} {...props}>
    <ToggleGroupContext.Provider value={{ variant, size }}>{children}</ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
));

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> & VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext);

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className,
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  );
});

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;

export { ToggleGroup, ToggleGroupItem };



============================================================
File Path: src/components/ui/toggle.tsx
============================================================
import * as React from "react";
import * as TogglePrimitive from "@radix-ui/react-toggle";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const toggleVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline: "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-10 px-3",
        sm: "h-9 px-2.5",
        lg: "h-11 px-5",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> & VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root ref={ref} className={cn(toggleVariants({ variant, size, className }))} {...props} />
));

Toggle.displayName = TogglePrimitive.Root.displayName;

export { Toggle, toggleVariants };



============================================================
File Path: src/components/ui/tooltip.tsx
============================================================
import * as React from "react";
import * as TooltipPrimitive from "@radix-ui/react-tooltip";

import { cn } from "@/lib/utils";

const TooltipProvider = TooltipPrimitive.Provider;

const Tooltip = TooltipPrimitive.Root;

const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };



============================================================
File Path: src/components/ui/use-toast.ts
============================================================
import { useToast, toast } from "@/hooks/use-toast";

export { useToast, toast };



============================================================
File Path: src/hooks/use-mobile.tsx
============================================================
import * as React from "react";

const MOBILE_BREAKPOINT = 768;

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined);

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    };
    mql.addEventListener("change", onChange);
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    return () => mql.removeEventListener("change", onChange);
  }, []);

  return !!isMobile;
}



============================================================
File Path: src/hooks/use-toast.ts
============================================================
import * as React from "react";

import type { ToastActionElement, ToastProps } from "@/components/ui/toast";

const TOAST_LIMIT = 1;
const TOAST_REMOVE_DELAY = 1000000;

type ToasterToast = ToastProps & {
  id: string;
  title?: React.ReactNode;
  description?: React.ReactNode;
  action?: ToastActionElement;
};

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const;

let count = 0;

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER;
  return count.toString();
}

type ActionType = typeof actionTypes;

type Action =
  | {
      type: ActionType["ADD_TOAST"];
      toast: ToasterToast;
    }
  | {
      type: ActionType["UPDATE_TOAST"];
      toast: Partial<ToasterToast>;
    }
  | {
      type: ActionType["DISMISS_TOAST"];
      toastId?: ToasterToast["id"];
    }
  | {
      type: ActionType["REMOVE_TOAST"];
      toastId?: ToasterToast["id"];
    };

interface State {
  toasts: ToasterToast[];
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return;
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId);
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    });
  }, TOAST_REMOVE_DELAY);

  toastTimeouts.set(toastId, timeout);
};

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      };

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) => (t.id === action.toast.id ? { ...t, ...action.toast } : t)),
      };

    case "DISMISS_TOAST": {
      const { toastId } = action;

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId);
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id);
        });
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t,
        ),
      };
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        };
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      };
  }
};

const listeners: Array<(state: State) => void> = [];

let memoryState: State = { toasts: [] };

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action);
  listeners.forEach((listener) => {
    listener(memoryState);
  });
}

type Toast = Omit<ToasterToast, "id">;

function toast({ ...props }: Toast) {
  const id = genId();

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    });
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id });

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss();
      },
    },
  });

  return {
    id: id,
    dismiss,
    update,
  };
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState);

  React.useEffect(() => {
    listeners.push(setState);
    return () => {
      const index = listeners.indexOf(setState);
      if (index > -1) {
        listeners.splice(index, 1);
      }
    };
  }, [state]);

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  };
}

export { useToast, toast };



============================================================
File Path: src/hooks/useAuth.tsx
============================================================
import { useState, useEffect, createContext, useContext, ReactNode } from "react";
import { supabase } from "@/integrations/supabase/client";
import { User, Session } from "@supabase/supabase-js";

interface Profile {
  id: string;
  email: string;
  full_name: string | null;
  avatar_url: string | null;
  phone: string | null;
  system_role: "sys_super_admin" | "regular_user";
}

interface TenantMembership {
  id: string;
  tenant_id: string;
  role: "company_admin" | "manager" | "employee";
  department: string | null;
  job_title: string | null;
  tenant: {
    id: string;
    name: string;
    domain: string | null;
    logo_url: string | null;
  };
}

interface SignupRequest {
  id: string;
  user_id: string;
  company_name: string;
  status: "pending" | "approved" | "rejected";
  assigned_tenant_id: string | null;
  created_at: string;
}

interface AuthContextType {
  user: User | null;
  session: Session | null;
  profile: Profile | null;
  memberships: TenantMembership[];
  currentTenant: TenantMembership | null;
  setCurrentTenant: (membership: TenantMembership | null) => void;
  loading: boolean;
  signUp: (email: string, password: string, fullName: string, companyName: string) => Promise<{ error: Error | null }>;
  signIn: (email: string, password: string) => Promise<{ error: Error | null }>;
  signOut: () => Promise<void>;
  isSuperAdmin: boolean;
  isCompanyAdmin: boolean; // ì¶”ê°€: íšŒì‚¬ë³„ ê´€ë¦¬ì ì—¬ë¶€
  signupRequest: SignupRequest | null;
  isPendingApproval: boolean;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const AuthProvider = ({ children }: { children: ReactNode }) => {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [profile, setProfile] = useState<Profile | null>(null);
  const [memberships, setMemberships] = useState<TenantMembership[]>([]);
  const [currentTenant, setCurrentTenant] = useState<TenantMembership | null>(null);
  const [loading, setLoading] = useState(true);
  const [signupRequest, setSignupRequest] = useState<SignupRequest | null>(null);

  const isSuperAdmin = profile?.system_role === "sys_super_admin";
  // ìˆ˜ì •: ì´ê´„ ê´€ë¦¬ìì´ê±°ë‚˜, í˜„ì¬ í…Œë„ŒíŠ¸ì˜ ì—­í• ì´ company_adminì¸ ê²½ìš° true
  const isCompanyAdmin = isSuperAdmin || currentTenant?.role === "company_admin";
  const isPendingApproval = signupRequest?.status === "pending" && memberships.length === 0;

  const fetchProfile = async (userId: string) => {
    const { data, error } = await supabase
      .from("profiles")
      .select("*")
      .eq("id", userId)
      .single();
    if (error) return null;
    return data as Profile;
  };

  const fetchMemberships = async (userId: string) => {
    const { data, error } = await supabase
      .from("tenant_memberships")
      .select(`
        id, tenant_id, role, department, job_title,
        tenant:tenants ( id, name, domain, logo_url )
      `)
      .eq("user_id", userId);
    if (error) return [];
    return data as unknown as TenantMembership[];
  };

  const fetchAllTenantsAsMemberships = async () => {
    const { data, error } = await supabase
      .from("tenants")
      .select("id, name, domain, logo_url")
      .order("name");
    if (error) return [];
    return data.map((t) => ({
      id: `admin-${t.id}`,
      tenant_id: t.id,
      role: "company_admin" as const,
      tenant: t,
      department: "ì‹œìŠ¤í…œ ì´ê´„",
      job_title: "Super Admin",
    })) as TenantMembership[];
  };

  const fetchSignupRequest = async (userId: string) => {
    const { data, error } = await supabase
      .from("signup_requests")
      .select("*")
      .eq("user_id", userId)
      .order("created_at", { ascending: false })
      .limit(1)
      .maybeSingle();
    if (error) return null;
    return data as SignupRequest | null;
  };

  const loadUserData = async (userId: string) => {
    const profileData = await fetchProfile(userId);
    setProfile(profileData);

    let mData: TenantMembership[] = [];
    if (profileData?.system_role === "sys_super_admin") {
      mData = await fetchAllTenantsAsMemberships();
    } else {
      mData = await fetchMemberships(userId);
    }
    
    setMemberships(mData);
    if (mData.length > 0) {
      setCurrentTenant(mData[0]);
    }

    const sData = await fetchSignupRequest(userId);
    setSignupRequest(sData);
  };

  useEffect(() => {
    let mounted = true;

    // 1. ì„¸ì…˜ ì²´í¬ ë° ë°ì´í„° ë¡œë“œ ë¡œì§ì„ í•˜ë‚˜ë¡œ í†µí•©
    const initializeAuth = async () => {
      const { data: { session } } = await supabase.auth.getSession();
      
      if (!mounted) return;

      setSession(session);
      setUser(session?.user ?? null);

      if (session?.user) {
        await loadUserData(session.user.id);
      }
      setLoading(false);
    };

    initializeAuth();

    // 2. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” 'ë³€ê²½' ì‹œì—ë§Œ ëŒ€ì‘í•˜ë˜, ì´ˆê¸° ë¡œë“œì™€ ê²¹ì¹˜ì§€ ì•Šê²Œ ê´€ë¦¬
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (event, session) => {
        if (!mounted) return;

        // SIGNED_OUT ì‹œì—ëŠ” ì¦‰ì‹œ ì´ˆê¸°í™”
        if (event === 'SIGNED_OUT') {
          setSession(null);
          setUser(null);
          setProfile(null);
          setMemberships([]);
          setCurrentTenant(null);
          setSignupRequest(null);
          setLoading(false);
          return;
        }

        // ì„¸ì…˜ì´ ìƒˆë¡œ ìƒê²¼ì„ ë•Œë§Œ ë°ì´í„° ë¡œë“œ (ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€)
        if (event === 'SIGNED_IN' || event === 'TOKEN_REFRESHED') {
          setSession(session);
          setUser(session?.user ?? null);
          if (session?.user) {
            await loadUserData(session.user.id);
          }
          setLoading(false);
        }
      }
    );

    return () => {
      mounted = false;
      subscription.unsubscribe();
    };
  }, []);

  const signUp = async (email: string, password: string, fullName: string, companyName: string) => {
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        emailRedirectTo: window.location.origin,
        data: { full_name: fullName },
      },
    });

    if (!error && data.user) {
      // 1. í•´ë‹¹ ì´ë©”ì¼ë¡œ ëŒ€ê¸° ì¤‘ì¸ ì´ˆëŒ€ê°€ ìˆëŠ”ì§€ í™•ì¸
      const { data: invitations } = await supabase
        .from("employee_invitations")
        .select("*")
        .eq("email", email.toLowerCase())
        .eq("status", "pending")
        .gt("expires_at", new Date().toISOString());

      if (invitations && invitations.length > 0) {
        // ì´ˆëŒ€ê°€ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ í•´ë‹¹ íšŒì‚¬ì— ë°°ì •
        const invite = invitations[0];
        
        // tenant_membership ìƒì„±
        await supabase.from("tenant_memberships").insert([{
          user_id: data.user.id,
          tenant_id: invite.tenant_id,
          role: invite.role as "company_admin" | "manager" | "employee",
          department: invite.department,
          job_title: invite.job_title,
        }]);

        // ì´ˆëŒ€ ìƒíƒœë¥¼ acceptedë¡œ ë³€ê²½
        await supabase
          .from("employee_invitations")
          .update({ status: "accepted", accepted_at: new Date().toISOString() })
          .eq("id", invite.id);
      } else {
        // ì´ˆëŒ€ê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ì²˜ëŸ¼ signup_requestsì— ë“±ë¡
        await supabase.from("signup_requests").insert({
          user_id: data.user.id,
          company_name: companyName,
        });
      }
    }
    return { error };
  };

  const signIn = async (email: string, password: string) => {
    const { error } = await supabase.auth.signInWithPassword({ email, password });
    return { error };
  };

  const signOut = async () => {
      try {
        await supabase.auth.signOut();
      } catch (error) {
        console.error("Sign out error:", error);
      } finally {
        // ì„œë²„ í†µì‹  ì„±ê³µ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë¸Œë¼ìš°ì €ì˜ ëª¨ë“  ë¡œê·¸ì¸ ì •ë³´ë¥¼ ê°•ì œë¡œ ì‚­ì œ
        localStorage.clear(); 
        window.location.href = "/auth"; // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ê°•ì œ ì´ë™
      }
  };

  return (
    <AuthContext.Provider
      value={{
        user,
        session,
        profile,
        memberships,
        currentTenant,
        setCurrentTenant,
        loading,
        signUp,
        signIn,
        signOut,
        isSuperAdmin,
        isCompanyAdmin, // ë…¸ì¶œ
        signupRequest,
        isPendingApproval,
      }}
    >
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error("useAuth must be used within an AuthProvider");
  }
  return context;
};


============================================================
File Path: src/integrations/supabase/client.ts
============================================================
// File Path: src/integrations/supabase/client.ts
import { createClient } from '@supabase/supabase-js';
import type { Database } from './types';

const SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;
const SUPABASE_PUBLISHABLE_KEY = import.meta.env.VITE_SUPABASE_PUBLISHABLE_KEY;

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY, {
  auth: {
    // [ìˆ˜ì •]: localStorage ëŒ€ì‹  sessionStorage ì‚¬ìš©
    storage: sessionStorage, 
    persistSession: true,
    autoRefreshToken: true,
  }
});


============================================================
File Path: src/integrations/supabase/types.ts
============================================================
export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  // Allows to automatically instantiate createClient with right options
  // instead of createClient<Database, { PostgrestVersion: 'XX' }>(URL, KEY)
  __InternalSupabase: {
    PostgrestVersion: "14.1"
  }
  public: {
    Tables: {
      artists: {
        Row: {
          agency: string | null
          bio: string | null
          birth_date: string | null
          created_at: string
          created_by: string | null
          debut_date: string | null
          gender: string | null
          id: string
          is_active: boolean | null
          name: string
          profile_image_url: string | null
          social_links: Json | null
          stage_name: string | null
          tenant_id: string
          updated_at: string
        }
        Insert: {
          agency?: string | null
          bio?: string | null
          birth_date?: string | null
          created_at?: string
          created_by?: string | null
          debut_date?: string | null
          gender?: string | null
          id?: string
          is_active?: boolean | null
          name: string
          profile_image_url?: string | null
          social_links?: Json | null
          stage_name?: string | null
          tenant_id: string
          updated_at?: string
        }
        Update: {
          agency?: string | null
          bio?: string | null
          birth_date?: string | null
          created_at?: string
          created_by?: string | null
          debut_date?: string | null
          gender?: string | null
          id?: string
          is_active?: boolean | null
          name?: string
          profile_image_url?: string | null
          social_links?: Json | null
          stage_name?: string | null
          tenant_id?: string
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "artists_tenant_id_fkey"
            columns: ["tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
        ]
      }
      employee_invitations: {
        Row: {
          accepted_at: string | null
          created_at: string
          department: string | null
          email: string
          expires_at: string
          id: string
          invited_by: string | null
          job_title: string | null
          role: string
          status: string
          tenant_id: string
          updated_at: string
        }
        Insert: {
          accepted_at?: string | null
          created_at?: string
          department?: string | null
          email: string
          expires_at?: string
          id?: string
          invited_by?: string | null
          job_title?: string | null
          role?: string
          status?: string
          tenant_id: string
          updated_at?: string
        }
        Update: {
          accepted_at?: string | null
          created_at?: string
          department?: string | null
          email?: string
          expires_at?: string
          id?: string
          invited_by?: string | null
          job_title?: string | null
          role?: string
          status?: string
          tenant_id?: string
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "employee_invitations_tenant_id_fkey"
            columns: ["tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
        ]
      }
      invoice_attachments: {
        Row: {
          created_at: string
          file_name: string
          file_size: number | null
          file_type: string | null
          file_url: string
          id: string
          invoice_id: string
        }
        Insert: {
          created_at?: string
          file_name: string
          file_size?: number | null
          file_type?: string | null
          file_url: string
          id?: string
          invoice_id: string
        }
        Update: {
          created_at?: string
          file_name?: string
          file_size?: number | null
          file_type?: string | null
          file_url?: string
          id?: string
          invoice_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "invoice_attachments_invoice_id_fkey"
            columns: ["invoice_id"]
            isOneToOne: false
            referencedRelation: "vendor_invoices"
            referencedColumns: ["id"]
          },
        ]
      }
      keywords: {
        Row: {
          category: string | null
          created_at: string
          created_by: string | null
          id: string
          is_active: boolean | null
          keyword: string
          priority: number | null
          tenant_id: string
          updated_at: string
        }
        Insert: {
          category?: string | null
          created_at?: string
          created_by?: string | null
          id?: string
          is_active?: boolean | null
          keyword: string
          priority?: number | null
          tenant_id: string
          updated_at?: string
        }
        Update: {
          category?: string | null
          created_at?: string
          created_by?: string | null
          id?: string
          is_active?: boolean | null
          keyword?: string
          priority?: number | null
          tenant_id?: string
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "keywords_tenant_id_fkey"
            columns: ["tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
        ]
      }
      press_contacts: {
        Row: {
          contact_email: string
          contact_phone: string | null
          created_at: string
          created_by: string | null
          id: string
          media_company: string
          purpose: string | null
          reporter_name: string
          updated_at: string
        }
        Insert: {
          contact_email: string
          contact_phone?: string | null
          created_at?: string
          created_by?: string | null
          id?: string
          media_company: string
          purpose?: string | null
          reporter_name: string
          updated_at?: string
        }
        Update: {
          contact_email?: string
          contact_phone?: string | null
          created_at?: string
          created_by?: string | null
          id?: string
          media_company?: string
          purpose?: string | null
          reporter_name?: string
          updated_at?: string
        }
        Relationships: []
      }
      profiles: {
        Row: {
          avatar_url: string | null
          created_at: string
          email: string
          full_name: string | null
          id: string
          phone: string | null
          system_role: Database["public"]["Enums"]["system_role"]
          updated_at: string
        }
        Insert: {
          avatar_url?: string | null
          created_at?: string
          email: string
          full_name?: string | null
          id: string
          phone?: string | null
          system_role?: Database["public"]["Enums"]["system_role"]
          updated_at?: string
        }
        Update: {
          avatar_url?: string | null
          created_at?: string
          email?: string
          full_name?: string | null
          id?: string
          phone?: string | null
          system_role?: Database["public"]["Enums"]["system_role"]
          updated_at?: string
        }
        Relationships: []
      }
      signup_requests: {
        Row: {
          assigned_tenant_id: string | null
          company_name: string
          created_at: string
          id: string
          reviewed_at: string | null
          reviewed_by: string | null
          status: string
          updated_at: string
          user_id: string
        }
        Insert: {
          assigned_tenant_id?: string | null
          company_name: string
          created_at?: string
          id?: string
          reviewed_at?: string | null
          reviewed_by?: string | null
          status?: string
          updated_at?: string
          user_id: string
        }
        Update: {
          assigned_tenant_id?: string | null
          company_name?: string
          created_at?: string
          id?: string
          reviewed_at?: string | null
          reviewed_by?: string | null
          status?: string
          updated_at?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "signup_requests_assigned_tenant_id_fkey"
            columns: ["assigned_tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
          {
            foreignKeyName: "signup_requests_reviewed_by_fkey"
            columns: ["reviewed_by"]
            isOneToOne: false
            referencedRelation: "profiles"
            referencedColumns: ["id"]
          },
        ]
      }
      system_configs: {
        Row: {
          category: string | null
          created_at: string
          description: string | null
          key: string
          updated_at: string
          value: string
        }
        Insert: {
          category?: string | null
          created_at?: string
          description?: string | null
          key: string
          updated_at?: string
          value: string
        }
        Update: {
          category?: string | null
          created_at?: string
          description?: string | null
          key?: string
          updated_at?: string
          value?: string
        }
        Relationships: []
      }
      tenant_api_configs: {
        Row: {
          category: string | null
          config_key: string
          config_value: string
          created_at: string
          description: string | null
          id: string
          is_encrypted: boolean | null
          tenant_id: string
          updated_at: string
        }
        Insert: {
          category?: string | null
          config_key: string
          config_value: string
          created_at?: string
          description?: string | null
          id?: string
          is_encrypted?: boolean | null
          tenant_id: string
          updated_at?: string
        }
        Update: {
          category?: string | null
          config_key?: string
          config_value?: string
          created_at?: string
          description?: string | null
          id?: string
          is_encrypted?: boolean | null
          tenant_id?: string
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "tenant_api_configs_tenant_id_fkey"
            columns: ["tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
        ]
      }
      tenant_memberships: {
        Row: {
          created_at: string
          department: string | null
          id: string
          invited_by: string | null
          job_title: string | null
          role: Database["public"]["Enums"]["tenant_role"]
          tenant_id: string
          updated_at: string
          user_id: string
        }
        Insert: {
          created_at?: string
          department?: string | null
          id?: string
          invited_by?: string | null
          job_title?: string | null
          role?: Database["public"]["Enums"]["tenant_role"]
          tenant_id: string
          updated_at?: string
          user_id: string
        }
        Update: {
          created_at?: string
          department?: string | null
          id?: string
          invited_by?: string | null
          job_title?: string | null
          role?: Database["public"]["Enums"]["tenant_role"]
          tenant_id?: string
          updated_at?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "tenant_memberships_invited_by_fkey"
            columns: ["invited_by"]
            isOneToOne: false
            referencedRelation: "profiles"
            referencedColumns: ["id"]
          },
          {
            foreignKeyName: "tenant_memberships_tenant_id_fkey"
            columns: ["tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
          {
            foreignKeyName: "tenant_memberships_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: false
            referencedRelation: "profiles"
            referencedColumns: ["id"]
          },
        ]
      }
      tenants: {
        Row: {
          address: string | null
          biz_item: string | null
          biz_number: string | null
          biz_type: string | null
          corp_number: string | null
          created_at: string
          domain: string | null
          drive_connected_at: string | null
          drive_connected_by: string | null
          drive_folder_id: string | null
          google_credentials: string | null
          id: string
          logo_url: string | null
          name: string
          opening_date: string | null
          rep_name: string | null
          tax_email: string | null
          updated_at: string
        }
        Insert: {
          address?: string | null
          biz_item?: string | null
          biz_number?: string | null
          biz_type?: string | null
          corp_number?: string | null
          created_at?: string
          domain?: string | null
          drive_connected_at?: string | null
          drive_connected_by?: string | null
          drive_folder_id?: string | null
          google_credentials?: string | null
          id?: string
          logo_url?: string | null
          name: string
          opening_date?: string | null
          rep_name?: string | null
          tax_email?: string | null
          updated_at?: string
        }
        Update: {
          address?: string | null
          biz_item?: string | null
          biz_number?: string | null
          biz_type?: string | null
          corp_number?: string | null
          created_at?: string
          domain?: string | null
          drive_connected_at?: string | null
          drive_connected_by?: string | null
          drive_folder_id?: string | null
          google_credentials?: string | null
          id?: string
          logo_url?: string | null
          name?: string
          opening_date?: string | null
          rep_name?: string | null
          tax_email?: string | null
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "tenants_drive_connected_by_fkey"
            columns: ["drive_connected_by"]
            isOneToOne: false
            referencedRelation: "profiles"
            referencedColumns: ["id"]
          },
        ]
      }
      vendor_invoices: {
        Row: {
          account_holder: string | null
          account_number: string | null
          amount: number
          assigned_to: string | null
          bank_name: string | null
          business_number: string | null
          created_at: string
          description: string | null
          id: string
          processed_at: string | null
          status: string
          submitted_at: string
          tenant_id: string
          updated_at: string
          vendor_name: string
        }
        Insert: {
          account_holder?: string | null
          account_number?: string | null
          amount: number
          assigned_to?: string | null
          bank_name?: string | null
          business_number?: string | null
          created_at?: string
          description?: string | null
          id?: string
          processed_at?: string | null
          status?: string
          submitted_at?: string
          tenant_id: string
          updated_at?: string
          vendor_name: string
        }
        Update: {
          account_holder?: string | null
          account_number?: string | null
          amount?: number
          assigned_to?: string | null
          bank_name?: string | null
          business_number?: string | null
          created_at?: string
          description?: string | null
          id?: string
          processed_at?: string | null
          status?: string
          submitted_at?: string
          tenant_id?: string
          updated_at?: string
          vendor_name?: string
        }
        Relationships: [
          {
            foreignKeyName: "vendor_invoices_assigned_to_fkey"
            columns: ["assigned_to"]
            isOneToOne: false
            referencedRelation: "profiles"
            referencedColumns: ["id"]
          },
          {
            foreignKeyName: "vendor_invoices_tenant_id_fkey"
            columns: ["tenant_id"]
            isOneToOne: false
            referencedRelation: "tenants"
            referencedColumns: ["id"]
          },
        ]
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      get_user_tenant_ids: { Args: never; Returns: string[] }
      is_sys_super_admin: { Args: never; Returns: boolean }
      is_tenant_admin: { Args: { _tenant_id: string }; Returns: boolean }
      is_tenant_manager_or_admin: {
        Args: { _tenant_id: string }
        Returns: boolean
      }
      is_tenant_member: { Args: { _tenant_id: string }; Returns: boolean }
    }
    Enums: {
      system_role: "sys_super_admin" | "regular_user"
      tenant_role: "company_admin" | "manager" | "employee"
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type DatabaseWithoutInternals = Omit<Database, "__InternalSupabase">

type DefaultSchema = DatabaseWithoutInternals[Extract<keyof Database, "public">]

export type Tables<
  DefaultSchemaTableNameOrOptions extends
    | keyof (DefaultSchema["Tables"] & DefaultSchema["Views"])
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
        DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? (DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
      DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Views"])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema["Tables"] &
        DefaultSchema["Views"])
    ? (DefaultSchema["Tables"] &
        DefaultSchema["Views"])[DefaultSchemaTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof DatabaseWithoutInternals },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  DefaultSchemaEnumNameOrOptions extends
    | keyof DefaultSchema["Enums"]
    | { schema: keyof DatabaseWithoutInternals },
  EnumName extends DefaultSchemaEnumNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"]
    : never = never,
> = DefaultSchemaEnumNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"][EnumName]
  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema["Enums"]
    ? DefaultSchema["Enums"][DefaultSchemaEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof DefaultSchema["CompositeTypes"]
    | { schema: keyof DatabaseWithoutInternals },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof DatabaseWithoutInternals
  }
    ? keyof DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"]
    : never = never,
> = PublicCompositeTypeNameOrOptions extends {
  schema: keyof DatabaseWithoutInternals
}
  ? DatabaseWithoutInternals[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema["CompositeTypes"]
    ? DefaultSchema["CompositeTypes"][PublicCompositeTypeNameOrOptions]
    : never

export const Constants = {
  public: {
    Enums: {
      system_role: ["sys_super_admin", "regular_user"],
      tenant_role: ["company_admin", "manager", "employee"],
    },
  },
} as const



============================================================
File Path: src/lib/driveApi.ts
============================================================
import { supabase } from "@/integrations/supabase/client";

const SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;

interface UploadResult {
  success: boolean;
  fileId?: string;
  fileName?: string;
  webViewLink?: string;
  webContentLink?: string;
  error?: string;
}

interface BackupResult {
  success: boolean;
  fileId?: string;
  fileName?: string;
  webViewLink?: string;
  backupTimestamp?: string;
  recordCounts?: {
    tenant: number;
    memberships: number;
    invoices: number;
    attachments: number;
  };
  error?: string;
}

/**
 * Upload a file to the tenant's Google Drive
 */
export async function uploadFileToDrive(
  tenantId: string,
  file: File,
  subfolder?: string
): Promise<UploadResult> {
  try {
    // Get current session
    const { data: { session } } = await supabase.auth.getSession();
    if (!session) {
      return { success: false, error: "Not authenticated" };
    }

    // Convert file to base64
    const fileContent = await fileToBase64(file);

    // Call edge function
    const response = await fetch(`${SUPABASE_URL}/functions/v1/upload-to-drive`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${session.access_token}`,
      },
      body: JSON.stringify({
        tenantId,
        fileName: file.name,
        fileContent,
        mimeType: file.type || "application/octet-stream",
        subfolder,
      }),
    });

    const result = await response.json();

    if (!response.ok) {
      return { success: false, error: result.error || "Upload failed" };
    }

    return result;
  } catch (error) {
    console.error("Upload error:", error);
    return { success: false, error: error instanceof Error ? error.message : "Upload failed" };
  }
}

/**
 * Create a backup of all tenant data to Google Drive
 */
export async function createDriveBackup(tenantId: string): Promise<BackupResult> {
  try {
    // Get current session
    const { data: { session } } = await supabase.auth.getSession();
    if (!session) {
      return { success: false, error: "Not authenticated" };
    }

    // Call edge function
    const response = await fetch(`${SUPABASE_URL}/functions/v1/backup-to-drive`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${session.access_token}`,
      },
      body: JSON.stringify({ tenantId }),
    });

    const result = await response.json();

    if (!response.ok) {
      return { success: false, error: result.error || "Backup failed" };
    }

    return result;
  } catch (error) {
    console.error("Backup error:", error);
    return { success: false, error: error instanceof Error ? error.message : "Backup failed" };
  }
}

/**
 * Convert File to base64 string
 */
function fileToBase64(file: File): Promise<string> {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => {
      const result = reader.result as string;
      // Remove data URL prefix
      const base64 = result.split(",")[1];
      resolve(base64);
    };
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}



============================================================
File Path: src/lib/utils.ts
============================================================
import { clsx, type ClassValue } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}



============================================================
File Path: src/pages/AdminDashboard.tsx
============================================================
import { Header } from "@/components/landing/Header";
import { Card, CardContent } from "@/components/ui/card";
import { 
  Users, 
  Key, 
  UserCog, 
  Settings, 
  Database, 
  ArrowLeft, 
  ShieldCheck, 
  CreditCard, 
  CarFront,
  Building,
  Megaphone
} from "lucide-react";
import { Link, useNavigate } from "react-router-dom";
import { Button } from "@/components/ui/button";

const AdminSystem = () => {
  const navigate = useNavigate();

  // App.tsxì˜ Route pathì™€ ì •í™•íˆ ì¼ì¹˜ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.
  const adminMenus = [
    { 
      title: "íšŒì‚¬ ì •ë³´ ê´€ë¦¬", 
      icon: <Building className="w-6 h-6 text-slate-600" />, 
      path: "/admin/company", 
      desc: "ì‚¬ì—…ì ì •ë³´ ë° ê³µì‹ ë¬¸ì„œ ê´€ë¦¬" 
    },
    { 
      title: "ì¸ì‚¬ ê´€ë¦¬", 
      icon: <Users className="w-6 h-6 text-blue-600" />, 
      path: "/admin/hr", 
      desc: "ì„ì§ì› ì •ë³´, ê¶Œí•œ ë° ì„œë¥˜ ê´€ë¦¬" 
    },
    { 
      title: "ë°°ìš° ê´€ë¦¬", 
      icon: <UserCog className="w-6 h-6 text-indigo-600" />, 
      path: "/admin/artists", 
      desc: "ì•„í‹°ìŠ¤íŠ¸ DB ë° í”„ë¡œí•„ ë§ˆìŠ¤í„° ë°ì´í„°" 
    },
    { 
      title: "ë²•ì¸ì¹´ë“œ ê´€ë¦¬", 
      icon: <CreditCard className="w-6 h-6 text-orange-500" />, 
      path: "/admin/cards", 
      desc: "ë²•ì¸ì¹´ë“œ ì‚¬ìš©ì ë° ê²°ì œ ì¦ë¹™ ê´€ë¦¬" 
    },
    { 
      title: "ì°¨ëŸ‰ ê´€ë¦¬", 
      icon: <CarFront className="w-6 h-6 text-emerald-600" />, 
      path: "/admin/vehicles", 
      desc: "ë²•ì¸ ì°¨ëŸ‰ ë¦¬ìŠ¤ë£Œ ë° ë³´í—˜, ì‚¬ê³  ê´€ë¦¬" 
    },
    { 
      title: "í‚¤ì›Œë“œ ê´€ë¦¬", 
      icon: <Key className="w-6 h-6 text-amber-500" />, 
      path: "/admin/keywords", 
      desc: "ì‹œìŠ¤í…œ ê²€ìƒ‰ì–´ ë° íƒœê·¸ ë°ì´í„° ê´€ë¦¬" 
    },
    { 
      title: "ë¯¸ë””ì–´ í”¼ì¹­", 
      icon: <Megaphone className="w-6 h-6 text-rose-500" />, 
      path: "/admin/media-pitching", 
      desc: "ì–¸ë¡ ì‚¬ ë°°í¬ ë° í™ë³´ ê´€ë¦¬" 
    },
    { 
      title: "API ì„¤ì •", 
      icon: <Settings className="w-6 h-6 text-slate-500" />, 
      path: "/admin/api-settings", 
      desc: "ì™¸ë¶€ ì—°ë™ í‚¤ ë° ì„œë¹„ìŠ¤ ì„¤ì •" 
    },
    { 
      title: "Drive ì„¤ì •", 
      icon: <Database className="w-6 h-6 text-blue-500" />, 
      path: "/admin/drive-settings", 
      desc: "ì „ì‚¬ ì €ì¥ì†Œ(Google Drive) ì—°ë™" 
    },
  ];

  return (
    <div className="min-h-screen bg-slate-50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-7xl mx-auto">
        <div className="flex items-center justify-between mb-10">
          <div>
            <div className="flex items-center gap-2 text-primary mb-2">
              <ShieldCheck className="w-5 h-5" />
              <span className="font-semibold text-sm">Corporate Admin Hub</span>
            </div>
            <h1 className="text-3xl font-bold tracking-tight text-slate-900">ë³¸ì‚¬ í†µí•© ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            <p className="text-muted-foreground mt-1">íšŒì‚¬ ìš´ì˜ ì „ë°˜ì— í•„ìš”í•œ ì„¤ì •ì„ í†µí•© ì œì–´í•©ë‹ˆë‹¤.</p>
          </div>
          <Button variant="ghost" className="gap-2" onClick={() => navigate("/")}>
            <ArrowLeft className="w-4 h-4" /> ëŒ€ì‹œë³´ë“œ
          </Button>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {adminMenus.map((menu) => (
            <Link key={menu.title} to={menu.path} className="block h-full">
              <Card className="hover:shadow-xl transition-all border-none bg-white group cursor-pointer h-full border-b-4 border-transparent hover:border-primary">
                <CardContent className="p-8 flex flex-col items-start gap-4">
                  <div className="p-4 rounded-2xl bg-slate-50 group-hover:bg-primary group-hover:text-white transition-all duration-300">
                    {menu.icon}
                  </div>
                  <div>
                    <h3 className="text-xl font-bold mb-1 group-hover:text-primary transition-colors">
                      {menu.title}
                    </h3>
                    <p className="text-muted-foreground text-sm leading-relaxed">
                      {menu.desc}
                    </p>
                  </div>
                </CardContent>
              </Card>
            </Link>
          ))}
        </div>
      </main>
    </div>
  );
};

export default AdminSystem;


============================================================
File Path: src/pages/AdminSystem.tsx
============================================================
import { Header } from "@/components/landing/Header";
import { Card, CardContent } from "@/components/ui/card";
import { Users, Key, UserCog, Laptop, Database, ShieldCheck, ArrowLeft, Building } from "lucide-react";
import { useNavigate } from "react-router-dom";
import { Button } from "@/components/ui/button";

const AdminSystem = () => {
  const navigate = useNavigate();
const adminMenus = [
  { 
    title: "íšŒì‚¬ ì •ë³´ ê´€ë¦¬", 
    icon: <Building className="w-6 h-6" />, 
    path: "/admin/company", 
    color: "bg-orange-500", 
    desc: "ë³´ë„ìë£Œìš© ë¬¸êµ¬ ë° í¬í„¸ ê´€ë¦¬ ê³„ì • ì„¤ì •" 
  },
    { title: "ì¸ì‚¬ ê´€ë¦¬", icon: <Users className="w-6 h-6" />, path: "/admin/hr", color: "bg-blue-500", desc: "ì§ì› ëª…ë¶€ ë° ë¶€ì„œ ê´€ë¦¬" },
    { title: "í‚¤ì›Œë“œ ê´€ë¦¬", icon: <Key className="w-6 h-6" />, path: "/admin/keywords", color: "bg-amber-500", desc: "ê²€ìƒ‰ì–´ í•„í„°ë§ ë° íƒœê·¸ ê´€ë¦¬" },
    { title: "ë°°ìš° ê´€ë¦¬", icon: <UserCog className="w-6 h-6" />, path: "/admin/artists", color: "bg-indigo-500", desc: "ì•„í‹°ìŠ¤íŠ¸ ë§ˆìŠ¤í„° ë°ì´í„°" },
    { title: "API ì„¤ì •", icon: <Laptop className="w-6 h-6" />, path: "/admin/api-settings", color: "bg-emerald-500", desc: "ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ì„¤ì •" },
    
    { title: "Drive ì„¤ì •", icon: <Database className="w-6 h-6" />, path: "/admin/drive-settings", color: "bg-rose-500", desc: "ì „ì‚¬ ìŠ¤í† ë¦¬ì§€ êµ¬ì„±" },
  ];

  return (
    <div className="min-h-screen bg-slate-50/50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-7xl mx-auto">
        <div className="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12">
          <div>
            <div className="flex items-center gap-2 text-primary font-bold mb-2">
              <ShieldCheck className="w-5 h-5" /> Admin System Only
            </div>
            <h1 className="text-4xl font-extrabold tracking-tight text-slate-900">ë³¸ì‚¬ í†µí•© ê´€ë¦¬ ì„¼í„°</h1>
            <p className="text-slate-500 mt-2 text-lg">íšŒì‚¬ ì¸í”„ë¼ì™€ ê¶Œí•œ ì„¤ì •ì„ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œ í—ˆë¸Œì…ë‹ˆë‹¤.</p>
          </div>
          <Button variant="ghost" className="gap-2" onClick={() => navigate("/dashboard")}>
            <ArrowLeft className="w-4 h-4" /> ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°
          </Button>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {adminMenus.map((menu) => (
            <div key={menu.title} onClick={() => navigate(menu.path)} className="cursor-pointer">
              <Card className="hover:shadow-xl transition-all border-none shadow-sm group overflow-hidden bg-white">
                <CardContent className="p-8 flex items-start gap-6">
                  <div className={`p-4 rounded-2xl ${menu.color} text-white shadow-lg shadow-current/20 group-hover:scale-110 transition-transform`}>
                    {menu.icon}
                  </div>
                  <div>
                    <h3 className="text-xl font-bold mb-2 text-slate-800">{menu.title}</h3>
                    <p className="text-slate-500 text-sm leading-relaxed">{menu.desc}</p>
                  </div>
                </CardContent>
              </Card>
            </div>
          ))}
        </div>
      </main>
    </div>
  );
};

export default AdminSystem;


============================================================
File Path: src/pages/Auth.tsx
============================================================
import { useState, useEffect } from "react";
import { useNavigate, useSearchParams } from "react-router-dom";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { toast } from "sonner";
import { Loader2, Mail, Lock, User, Building2, CheckCircle, Briefcase } from "lucide-react";
import { Badge } from "@/components/ui/badge";

interface InvitationInfo {
  id: string;
  email: string;
  role: string;
  department: string | null;
  job_title: string | null;
  tenant_name: string;
  tenant_id: string;
}

const Auth = () => {
  const [isLogin, setIsLogin] = useState(true);
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [fullName, setFullName] = useState("");
  const [companyName, setCompanyName] = useState("");
  const [loading, setLoading] = useState(false);
  const [invitationInfo, setInvitationInfo] = useState<InvitationInfo | null>(null);
  const [checkingInvite, setCheckingInvite] = useState(false);
  const { signIn, signUp } = useAuth();
  const navigate = useNavigate();
  const [searchParams] = useSearchParams();

  // URLì—ì„œ ì´ˆëŒ€ ì´ë©”ì¼ íŒŒë¼ë¯¸í„° í™•ì¸
  useEffect(() => {
    const inviteEmail = searchParams.get("invite");
    if (inviteEmail) {
      setEmail(inviteEmail);
      setIsLogin(false);
      checkInvitation(inviteEmail);
    }
  }, [searchParams]);

  // ì´ë©”ì¼ ë³€ê²½ ì‹œ ì´ˆëŒ€ í™•ì¸
  const checkInvitation = async (emailToCheck: string) => {
    if (!emailToCheck || emailToCheck.length < 5) {
      setInvitationInfo(null);
      return;
    }

    setCheckingInvite(true);
    try {
      const { data, error } = await supabase
        .from("employee_invitations")
        .select(`
          id, email, role, department, job_title, tenant_id,
          tenants:tenant_id ( name )
        `)
        .eq("email", emailToCheck.toLowerCase())
        .eq("status", "pending")
        .gt("expires_at", new Date().toISOString())
        .limit(1)
        .maybeSingle();

      if (data && !error) {
        const tenantData = data.tenants as any;
        setInvitationInfo({
          id: data.id,
          email: data.email,
          role: data.role,
          department: data.department,
          job_title: data.job_title,
          tenant_name: tenantData?.name || "ì•Œ ìˆ˜ ì—†ìŒ",
          tenant_id: data.tenant_id,
        });
      } else {
        setInvitationInfo(null);
      }
    } catch (err) {
      console.error("Invitation check error:", err);
      setInvitationInfo(null);
    } finally {
      setCheckingInvite(false);
    }
  };

  // ì´ë©”ì¼ ì…ë ¥ ë³€ê²½ í•¸ë“¤ëŸ¬ (ë””ë°”ìš´ìŠ¤)
  useEffect(() => {
    if (!isLogin && email) {
      const timer = setTimeout(() => {
        checkInvitation(email);
      }, 500);
      return () => clearTimeout(timer);
    } else {
      setInvitationInfo(null);
    }
  }, [email, isLogin]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);

    try {
      if (isLogin) {
        const { error } = await signIn(email, password);
        if (error) {
          toast.error("ë¡œê·¸ì¸ ì‹¤íŒ¨", {
            description: error.message,
          });
        } else {
          toast.success("ë¡œê·¸ì¸ ì„±ê³µ!");
          navigate("/dashboard");
        }
      } else {
        if (!fullName.trim()) {
          toast.error("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
          setLoading(false);
          return;
        }
        // ì´ˆëŒ€ê°€ ì—†ëŠ” ê²½ìš°ì—ë§Œ íšŒì‚¬ëª… í•„ìˆ˜
        if (!invitationInfo && !companyName.trim()) {
          toast.error("íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
          setLoading(false);
          return;
        }
        const { error } = await signUp(
          email,
          password,
          fullName,
          invitationInfo ? invitationInfo.tenant_name : companyName
        );
        if (error) {
          toast.error("íšŒì›ê°€ì… ì‹¤íŒ¨", {
            description: error.message,
          });
        } else {
          if (invitationInfo) {
            toast.success("íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!", {
              description: `${invitationInfo.tenant_name}ì— ìë™ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.`,
            });
          } else {
            toast.success("íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!", {
              description: "ê´€ë¦¬ì ìŠ¹ì¸ í›„ ì‹œìŠ¤í…œì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
            });
          }
          setIsLogin(true);
        }
      }
    } catch (err) {
      toast.error("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤");
    } finally {
      setLoading(false);
    }
  };

  const getRoleLabel = (role: string) => {
    switch (role) {
      case "company_admin":
        return "ê´€ë¦¬ì";
      case "manager":
        return "ë§¤ë‹ˆì €";
      default:
        return "ì‚¬ì›";
    }
  };

  return (
    <div className="min-h-screen bg-background flex items-center justify-center p-4">
      {/* Background Effects */}
      <div className="absolute inset-0 bg-gradient-to-br from-primary/5 via-background to-accent/5" />
      <div className="absolute top-1/4 left-1/4 w-96 h-96 bg-primary/10 rounded-full blur-3xl" />
      <div className="absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl" />

      <div className="relative z-10 w-full max-w-md">
        {/* Logo */}
        <div className="text-center mb-8">
          <div className="inline-flex items-center gap-2 mb-4">
            <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-accent flex items-center justify-center">
              <span className="text-primary-foreground font-bold text-lg">B</span>
            </div>
            <span className="font-bold text-2xl">
              <span className="gradient-text">Boteda</span> OS
            </span>
          </div>
          <p className="text-muted-foreground">
            {isLogin ? "ê³„ì •ì— ë¡œê·¸ì¸í•˜ì„¸ìš”" : "ìƒˆ ê³„ì •ì„ ë§Œë“œì„¸ìš”"}
          </p>
        </div>

        {/* Auth Card */}
        <div className="glass-card p-8">
          {/* ì´ˆëŒ€ ì •ë³´ ë°°ë„ˆ */}
          {!isLogin && invitationInfo && (
            <div className="mb-6 p-4 rounded-xl bg-gradient-to-r from-primary/10 to-accent/10 border border-primary/20">
              <div className="flex items-start gap-3">
                <div className="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center shrink-0">
                  <CheckCircle className="w-5 h-5 text-primary" />
                </div>
                <div className="flex-1">
                  <p className="font-semibold text-sm text-foreground">
                    {invitationInfo.tenant_name}ì—ì„œ ì´ˆëŒ€í–ˆìŠµë‹ˆë‹¤
                  </p>
                  <div className="flex flex-wrap gap-2 mt-2">
                    <Badge variant="secondary" className="text-xs">
                      {getRoleLabel(invitationInfo.role)}
                    </Badge>
                    {invitationInfo.department && (
                      <Badge variant="outline" className="text-xs">
                        {invitationInfo.department}
                      </Badge>
                    )}
                    {invitationInfo.job_title && (
                      <Badge variant="outline" className="text-xs">
                        {invitationInfo.job_title}
                      </Badge>
                    )}
                  </div>
                  <p className="text-xs text-muted-foreground mt-2">
                    ê°€ì… ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ ì†Œì†ë©ë‹ˆë‹¤
                  </p>
                </div>
              </div>
            </div>
          )}

          <form onSubmit={handleSubmit} className="space-y-5">
            {!isLogin && (
              <>
                <div className="space-y-2">
                  <Label htmlFor="fullName">ì´ë¦„</Label>
                  <div className="relative">
                    <User className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
                    <Input
                      id="fullName"
                      type="text"
                      placeholder="í™ê¸¸ë™"
                      value={fullName}
                      onChange={(e) => setFullName(e.target.value)}
                      className="pl-10"
                      required={!isLogin}
                    />
                  </div>
                </div>
                {/* ì´ˆëŒ€ê°€ ì—†ëŠ” ê²½ìš°ì—ë§Œ íšŒì‚¬ëª… ì…ë ¥ í‘œì‹œ */}
                {!invitationInfo && (
                  <div className="space-y-2">
                    <Label htmlFor="companyName">íšŒì‚¬ëª…</Label>
                    <div className="relative">
                      <Building2 className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
                      <Input
                        id="companyName"
                        type="text"
                        placeholder="íšŒì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                        value={companyName}
                        onChange={(e) => setCompanyName(e.target.value)}
                        className="pl-10"
                        required={!isLogin && !invitationInfo}
                      />
                    </div>
                    <p className="text-xs text-muted-foreground">
                      ê´€ë¦¬ì ìŠ¹ì¸ í›„ í•´ë‹¹ íšŒì‚¬ì— ì†Œì†ë©ë‹ˆë‹¤
                    </p>
                  </div>
                )}
              </>
            )}

            <div className="space-y-2">
              <Label htmlFor="email">ì´ë©”ì¼</Label>
              <div className="relative">
                <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
                <Input
                  id="email"
                  type="email"
                  placeholder="email@example.com"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  className="pl-10"
                  required
                  disabled={!!searchParams.get("invite")}
                />
                {checkingInvite && !isLogin && (
                  <Loader2 className="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 animate-spin text-muted-foreground" />
                )}
              </div>
            </div>

            <div className="space-y-2">
              <Label htmlFor="password">ë¹„ë°€ë²ˆí˜¸</Label>
              <div className="relative">
                <Lock className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
                <Input
                  id="password"
                  type="password"
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="pl-10"
                  required
                  minLength={6}
                />
              </div>
            </div>

            <Button type="submit" className="w-full" size="lg" disabled={loading}>
              {loading ? (
                <>
                  <Loader2 className="w-4 h-4 animate-spin mr-2" />
                  ì²˜ë¦¬ ì¤‘...
                </>
              ) : isLogin ? (
                "ë¡œê·¸ì¸"
              ) : (
                "íšŒì›ê°€ì…"
              )}
            </Button>
          </form>

          <div className="mt-6 text-center">
            <button
              type="button"
              onClick={() => {
                setIsLogin(!isLogin);
                setInvitationInfo(null);
              }}
              className="text-sm text-muted-foreground hover:text-foreground transition-colors"
            >
              {isLogin ? (
                <>
                  ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?{" "}
                  <span className="text-primary font-medium">íšŒì›ê°€ì…</span>
                </>
              ) : (
                <>
                  ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”?{" "}
                  <span className="text-primary font-medium">ë¡œê·¸ì¸</span>
                </>
              )}
            </button>
          </div>
        </div>

        {/* Info */}
        <p className="text-center text-xs text-muted-foreground mt-6">
          ë¡œê·¸ì¸í•˜ë©´ Boteda OS ì´ìš©ì•½ê´€ ë° ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì— ë™ì˜í•˜ê²Œ ë©ë‹ˆë‹¤.
        </p>
      </div>
    </div>
  );
};

export default Auth;


============================================================
File Path: src/pages/Dashboard.tsx
============================================================
import { useState } from "react";
import { useNavigate } from "react-router-dom";
import { useAuth } from "@/hooks/useAuth";
import { Header } from "@/components/landing/Header";
import { AppGrid } from "@/components/dashboard/AppGrid";
import { CalendarWidget } from "@/components/dashboard/CalendarWidget";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import { Badge } from "@/components/ui/badge";
import {
  Calendar,
  FileText,
  MessageSquare,
  MoreHorizontal,
  Paperclip,
  Send,
  Users,
  Clock,
  CheckCircle2,
  AlertCircle,
  FolderOpen,
  ChevronRight,
  Plus,
  Search,
  Filter,
  AtSign,
  Image,
} from "lucide-react";

// Mock project data
const mockProject = {
  id: "proj-001",
  name: "2025 ë§ˆì¼€íŒ… ìº í˜ì¸",
  status: "inprogress",
  members: [
    { id: "1", name: "ê¹€ìˆ˜ì—°", role: "PM", avatar: "S" },
    { id: "2", name: "ì´ì¤€í˜", role: "ë””ìì´ë„ˆ", avatar: "J" },
    { id: "3", name: "ë°•ë¯¼ì„œ", role: "ê°œë°œì", avatar: "M" },
  ],
  dueDate: "2025-02-15",
  progress: 65,
};

const mockTimeline = [
  {
    id: "1",
    type: "message",
    user: { name: "ê¹€ìˆ˜ì—°", avatar: "S" },
    content: "ê²¬ì ì„œ ìŠ¹ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤. @ì´ì¤€í˜ ê²€í†  í•„ìš”í•©ë‹ˆë‹¤.",
    time: "10ë¶„ ì „",
    mentions: ["ì´ì¤€í˜"],
  },
  {
    id: "2",
    type: "system",
    content: "ê±°ë˜ì²˜ (ì£¼)ABCë””ìì¸ì´ ì²­êµ¬ì„œë¥¼ ì—…ë¡œë“œí–ˆìŠµë‹ˆë‹¤.",
    time: "32ë¶„ ì „",
    attachment: { name: "ê²¬ì ì„œ_2025.pdf", size: "2.4MB" },
  },
  {
    id: "3",
    type: "message",
    user: { name: "ì´ì¤€í˜", avatar: "J" },
    content: "í˜„ì¥ ì‚¬ì§„ ì—…ë¡œë“œí–ˆìŠµë‹ˆë‹¤. í™•ì¸ ë¶€íƒë“œë ¤ìš”!",
    time: "1ì‹œê°„ ì „",
    images: 3,
  },
  {
    id: "4",
    type: "system",
    content: "íŒ€ì¥ ë°•ë¯¼ì„œë‹˜ì´ ì§€ì¶œê²°ì˜ì„œë¥¼ ìŠ¹ì¸í–ˆìŠµë‹ˆë‹¤.",
    time: "2ì‹œê°„ ì „",
    status: "approved",
  },
  {
    id: "5",
    type: "message",
    user: { name: "ë°•ë¯¼ì„œ", avatar: "M" },
    content: "ê¸ˆì¼ ë¯¸íŒ… íšŒì˜ë¡ ì²¨ë¶€í•©ë‹ˆë‹¤. ì£¼ìš” ê²°ì •ì‚¬í•­ í™•ì¸í•´ì£¼ì„¸ìš”.",
    time: "3ì‹œê°„ ì „",
  },
];

const mockFiles = [
  { name: "ê²¬ì ì„œ_2025.pdf", type: "pdf", date: "ì˜¤ëŠ˜", size: "2.4MB" },
  { name: "í†µì¥ì‚¬ë³¸.jpg", type: "image", date: "ì–´ì œ", size: "1.1MB" },
  { name: "ì‚¬ì—…ìë“±ë¡ì¦.pdf", type: "pdf", date: "2ì¼ ì „", size: "856KB" },
  { name: "í˜„ì¥ì‚¬ì§„_01.jpg", type: "image", date: "3ì¼ ì „", size: "3.2MB" },
];

const mockMeetings = [
  { date: "2025-01-15", title: "í‚¥ì˜¤í”„ ë¯¸íŒ…", notes: "í”„ë¡œì íŠ¸ ë²”ìœ„ ë° ì¼ì • í™•ì •" },
  { date: "2025-01-20", title: "ë””ìì¸ ë¦¬ë·°", notes: "ì‹œì•ˆ 3ì¢… ê²€í† , 2ì•ˆ ì±„íƒ" },
  { date: "2025-01-25", title: "ì¤‘ê°„ ì ê²€", notes: "ì§„í–‰ë¥  60%, ì¼ì • ì¤€ìˆ˜ ì¤‘" },
];

const Dashboard = () => {
  const [message, setMessage] = useState("");

  return (
    <div className="min-h-screen bg-background">
      <Header />

      <main className="pt-20">
        {/* [ìˆ˜ì •] ê´€ë¦¬ì ì „ìš© ë©”ë‰´ ì„¹ì…˜ì„ ì‚­ì œí•˜ì—¬ í™”ë©´ ê³µê°„ í™•ë³´ */}

        {/* 1. í•µì‹¬ ì•± ê·¸ë¦¬ë“œ ì„¹ì…˜ */}
        <div className="container px-4 py-6">
          <AppGrid />
        </div>

        {/* 2. ìº˜ë¦°ë” ë° ì¼ì • ìœ„ì ¯ */}
        <div className="container px-4 pb-6">
          <CalendarWidget />
        </div>

        {/* 3. í”„ë¡œì íŠ¸ ìƒì„¸ í—¤ë” */}
        <div className="border-b border-border bg-card/50">
          <div className="container px-4 py-6">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
              <div>
                <div className="flex items-center gap-2 text-sm text-muted-foreground mb-2">
                  <span>í”„ë¡œì íŠ¸</span>
                  <ChevronRight className="w-4 h-4" />
                  <span className="text-foreground font-medium">{mockProject.name}</span>
                </div>
                <div className="flex items-center gap-3">
                  <h1 className="text-2xl font-bold">{mockProject.name}</h1>
                  <Badge className="status-badge status-inprogress">ì§„í–‰ì¤‘</Badge>
                </div>
              </div>
              <div className="flex items-center gap-4">
                {/* íŒ€ ë©¤ë²„ ì•„ë°”íƒ€ */}
                <div className="flex -space-x-2">
                  {mockProject.members.map((member) => (
                    <Avatar key={member.id} className="w-8 h-8 border-2 border-background">
                      <AvatarFallback className="bg-secondary text-xs">{member.avatar}</AvatarFallback>
                    </Avatar>
                  ))}
                  <button className="w-8 h-8 rounded-full bg-secondary border-2 border-background flex items-center justify-center">
                    <Plus className="w-4 h-4 text-muted-foreground" />
                  </button>
                </div>
                {/* ë§ˆê°ì¼ */}
                <div className="flex items-center gap-2 text-sm text-muted-foreground">
                  <Calendar className="w-4 h-4" />
                  <span>D-30</span>
                </div>
              </div>
            </div>

            {/* ì§„í–‰ë¥  ë°” */}
            <div className="mt-4">
              <div className="flex items-center justify-between text-sm mb-2">
                <span className="text-muted-foreground">ì§„í–‰ë¥ </span>
                <span className="font-medium">{mockProject.progress}%</span>
              </div>
              <div className="h-2 bg-secondary rounded-full overflow-hidden">
                <div 
                  className="h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all"
                  style={{ width: `${mockProject.progress}%` }}
                />
              </div>
            </div>
          </div>
        </div>

        {/* 4. 3ì»¬ëŸ¼ ë©”ì¸ ë ˆì´ì•„ì›ƒ (ìš”ì•½ / í”¼ë“œ / íŒŒì¼&íšŒì˜ë¡) */}
        <div className="container px-4 py-6">
          <div className="grid lg:grid-cols-12 gap-6">
            
            {/* ì™¼ìª½ ì»¬ëŸ¼: í”„ë¡œì íŠ¸ ìš”ì•½ ë° íŒ€ ì •ë³´ */}
            <div className="lg:col-span-3 space-y-6">
              <div className="glass-card p-5">
                <h3 className="font-semibold mb-4 flex items-center gap-2">
                  <Users className="w-4 h-4 text-primary" />
                  í”„ë¡œì íŠ¸ ìš”ì•½
                </h3>
                <div className="space-y-4">
                  <div className="flex items-center justify-between">
                    <span className="text-sm text-muted-foreground">ì²­êµ¬ ëŒ€ê¸°</span>
                    <span className="font-semibold text-warning">3ê±´</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-sm text-muted-foreground">ìŠ¹ì¸ ì™„ë£Œ</span>
                    <span className="font-semibold text-success">12ê±´</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-sm text-muted-foreground">ì´ ì§€ì¶œ</span>
                    <span className="font-semibold">â‚©24,500,000</span>
                  </div>
                </div>
              </div>

              <div className="glass-card p-5">
                <h3 className="font-semibold mb-4 flex items-center gap-2">
                  <Users className="w-4 h-4 text-primary" />
                  íŒ€ ë©¤ë²„
                </h3>
                <div className="space-y-3">
                  {mockProject.members.map((member) => (
                    <div key={member.id} className="flex items-center gap-3">
                      <Avatar className="w-9 h-9">
                        <AvatarFallback className="bg-primary/10 text-primary text-sm">
                          {member.avatar}
                        </AvatarFallback>
                      </Avatar>
                      <div className="flex-1 min-w-0">
                        <div className="font-medium text-sm">{member.name}</div>
                        <div className="text-xs text-muted-foreground">{member.role}</div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* ì¤‘ì•™ ì»¬ëŸ¼: ì‹¤ì‹œê°„ íƒ€ì„ë¼ì¸ í”¼ë“œ */}
            <div className="lg:col-span-6">
              <div className="glass-card overflow-hidden">
                <div className="p-4 border-b border-border flex items-center justify-between">
                  <h3 className="font-semibold flex items-center gap-2">
                    <MessageSquare className="w-4 h-4 text-primary" />
                    íƒ€ì„ë¼ì¸
                  </h3>
                  <div className="flex items-center gap-2">
                    <Button variant="ghost" size="icon" className="w-8 h-8">
                      <Search className="w-4 h-4" />
                    </Button>
                    <Button variant="ghost" size="icon" className="w-8 h-8">
                      <Filter className="w-4 h-4" />
                    </Button>
                  </div>
                </div>

                {/* ë©”ì‹œì§€ ì…ë ¥ì°½ */}
                <div className="p-4 border-b border-border">
                  <div className="flex gap-3">
                    <Avatar className="w-9 h-9 shrink-0">
                      <AvatarFallback className="bg-primary/10 text-primary text-sm">ë‚˜</AvatarFallback>
                    </Avatar>
                    <div className="flex-1">
                      <div className="relative">
                        <Input
                          placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”... (@ë©˜ì…˜ ê°€ëŠ¥)"
                          value={message}
                          onChange={(e) => setMessage(e.target.value)}
                          className="pr-24 bg-secondary/50 border-transparent focus:border-primary/30"
                        />
                        <div className="absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1">
                          <Button variant="ghost" size="icon" className="w-7 h-7">
                            <AtSign className="w-4 h-4" />
                          </Button>
                          <Button variant="ghost" size="icon" className="w-7 h-7">
                            <Paperclip className="w-4 h-4" />
                          </Button>
                          <Button size="icon" className="w-7 h-7">
                            <Send className="w-4 h-4" />
                          </Button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* íƒ€ì„ë¼ì¸ ëª©ë¡ */}
                <div className="p-4 space-y-4 max-h-[600px] overflow-y-auto">
                  {mockTimeline.map((item) => (
                    <div key={item.id} className="relative">
                      {item.type === "message" ? (
                        <div className="flex gap-3">
                          <Avatar className="w-9 h-9 shrink-0">
                            <AvatarFallback className="bg-secondary text-sm">
                              {item.user?.avatar}
                            </AvatarFallback>
                          </Avatar>
                          <div className="flex-1 min-w-0">
                            <div className="flex items-center gap-2 mb-1">
                              <span className="font-medium text-sm">{item.user?.name}</span>
                              <span className="text-xs text-muted-foreground">{item.time}</span>
                            </div>
                            <div className="p-3 rounded-lg bg-secondary/50 text-sm">
                              {item.content}
                            </div>
                          </div>
                        </div>
                      ) : (
                        <div className="flex items-start gap-3 px-3 py-2 rounded-lg bg-muted/30 border border-border/50">
                          <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${
                            item.status === "approved" ? 'bg-success/10' : 'bg-primary/10'
                          }`}>
                            {item.status === "approved" ? (
                              <CheckCircle2 className="w-4 h-4 text-success" />
                            ) : (
                              <AlertCircle className="w-4 h-4 text-primary" />
                            )}
                          </div>
                          <div className="flex-1 min-w-0">
                            <div className="text-sm">{item.content}</div>
                            {item.attachment && (
                              <div className="mt-2 inline-flex items-center gap-2 px-3 py-1.5 rounded-lg bg-secondary/50 text-xs">
                                <FileText className="w-4 h-4 text-primary" />
                                <span>{item.attachment.name}</span>
                              </div>
                            )}
                            <div className="text-xs text-muted-foreground mt-1">{item.time}</div>
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* ì˜¤ë¥¸ìª½ ì»¬ëŸ¼: ì²¨ë¶€íŒŒì¼ ë° íšŒì˜ë¡ */}
            <div className="lg:col-span-3 space-y-6">
              <div className="glass-card p-5">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="font-semibold flex items-center gap-2">
                    <FolderOpen className="w-4 h-4 text-primary" />
                    ì²¨ë¶€íŒŒì¼
                  </h3>
                </div>
                <div className="space-y-2">
                  {mockFiles.map((file, i) => (
                    <div key={i} className="flex items-center gap-3 p-2 rounded-lg hover:bg-secondary/50 transition-colors cursor-pointer">
                      <div className="w-9 h-9 rounded-lg bg-primary/10 flex items-center justify-center">
                        <FileText className="w-4 h-4 text-primary" />
                      </div>
                      <div className="flex-1 min-w-0">
                        <div className="text-sm font-medium truncate">{file.name}</div>
                        <div className="text-xs text-muted-foreground">{file.size}</div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="glass-card p-5">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="font-semibold flex items-center gap-2">
                    <Clock className="w-4 h-4 text-primary" />
                    ìµœê·¼ íšŒì˜ë¡
                  </h3>
                </div>
                <div className="space-y-3">
                  {mockMeetings.map((meeting, i) => (
                    <div key={i} className="p-3 rounded-lg bg-secondary/30 hover:bg-secondary/50 transition-colors cursor-pointer">
                      <div className="text-xs text-muted-foreground mb-1">{meeting.date}</div>
                      <div className="text-sm font-medium">{meeting.title}</div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

          </div>
        </div>
      </main>
    </div>
  );
};

export default Dashboard;


============================================================
File Path: src/pages/GuestForm.tsx
============================================================
import { useState } from "react";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Label } from "@/components/ui/label";
import { 
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { 
  Upload, 
  FileText, 
  CheckCircle2, 
  Loader2, 
  Sparkles,
  Building2,
  CreditCard,
  User,
  Phone,
  Mail
} from "lucide-react";
import { toast } from "sonner";

// Mock data for demonstration
const mockEmployees = [
  { id: "1", name: "ê¹€ìˆ˜ì—°", department: "ì¬ë¬´íŒ€", phone: "010-1234-5678", email: "sooyeon@company.com" },
  { id: "2", name: "ì´ì¤€í˜", department: "ì˜ì—…íŒ€", phone: "010-2345-6789", email: "junhyuk@company.com" },
  { id: "3", name: "ë°•ë¯¼ì„œ", department: "ë§ˆì¼€íŒ…íŒ€", phone: "010-3456-7890", email: "minseo@company.com" },
];

const GuestForm = () => {
  const [step, setStep] = useState(1);
  const [isProcessing, setIsProcessing] = useState(false);
  const [uploadedFiles, setUploadedFiles] = useState<File[]>([]);
  const [extractedData, setExtractedData] = useState({
    amount: "",
    businessNumber: "",
    accountNumber: "",
  });
  const [formData, setFormData] = useState({
    companyName: "",
    description: "",
    amount: "",
    bankName: "",
    accountNumber: "",
    accountHolder: "",
    assignedEmployee: "",
  });

  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = e.target.files;
    if (!files?.length) return;

    setUploadedFiles(Array.from(files));
    setIsProcessing(true);

    // Simulate AI processing
    await new Promise(resolve => setTimeout(resolve, 2000));

    // Mock extracted data
    setExtractedData({
      amount: "3,500,000",
      businessNumber: "123-45-67890",
      accountNumber: "110-123-456789",
    });

    setFormData(prev => ({
      ...prev,
      amount: "3,500,000",
      accountNumber: "110-123-456789",
    }));

    setIsProcessing(false);
    toast.success("AIê°€ ë¬¸ì„œì—ì„œ ì •ë³´ë¥¼ ì¶”ì¶œí–ˆìŠµë‹ˆë‹¤!", {
      description: "ê¸ˆì•¡, ê³„ì¢Œë²ˆí˜¸ê°€ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.",
    });
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsProcessing(true);
    await new Promise(resolve => setTimeout(resolve, 1500));
    setIsProcessing(false);
    setStep(3);
    toast.success("ì²­êµ¬ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!", {
      description: "ë‹´ë‹¹ìì—ê²Œ ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤.",
    });
  };

  return (
    <div className="min-h-screen bg-background">
      <Header />
      
      <main className="pt-24 pb-16 px-4">
        <div className="max-w-2xl mx-auto">
          {/* Header */}
          <div className="text-center mb-10">
            <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20 mb-6">
              <FileText className="w-4 h-4 text-primary" />
              <span className="text-sm text-primary font-medium">ì™¸ë¶€ ê±°ë˜ì²˜ ì²­êµ¬ í¼</span>
            </div>
            <h1 className="text-3xl md:text-4xl font-bold mb-4">
              ì²­êµ¬ì„œ <span className="gradient-text">ê°„í¸ ì œì¶œ</span>
            </h1>
            <p className="text-muted-foreground">
              ê²¬ì ì„œ, í†µì¥ì‚¬ë³¸ì„ ì—…ë¡œë“œí•˜ë©´ AIê°€ ìë™ìœ¼ë¡œ ì •ë³´ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
            </p>
          </div>

          {/* Progress Steps */}
          <div className="flex items-center justify-center gap-4 mb-10">
            {[1, 2, 3].map((s) => (
              <div key={s} className="flex items-center gap-2">
                <div className={`w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all ${
                  s < step ? 'bg-success text-success-foreground' :
                  s === step ? 'bg-primary text-primary-foreground' :
                  'bg-secondary text-muted-foreground'
                }`}>
                  {s < step ? <CheckCircle2 className="w-5 h-5" /> : s}
                </div>
                <span className={`text-sm hidden sm:inline ${s === step ? 'text-foreground font-medium' : 'text-muted-foreground'}`}>
                  {s === 1 ? 'íŒŒì¼ ì—…ë¡œë“œ' : s === 2 ? 'ì •ë³´ ì…ë ¥' : 'ì™„ë£Œ'}
                </span>
                {s < 3 && <div className={`w-8 h-0.5 ${s < step ? 'bg-success' : 'bg-border'}`} />}
              </div>
            ))}
          </div>

          {/* Step 1: File Upload */}
          {step === 1 && (
            <div className="glass-card p-8">
              <div className="text-center mb-6">
                <h2 className="text-xl font-semibold mb-2">ì¦ë¹™ ì„œë¥˜ ì—…ë¡œë“œ</h2>
                <p className="text-sm text-muted-foreground">
                  ê²¬ì ì„œ, í†µì¥ì‚¬ë³¸, ì‚¬ì—…ìë“±ë¡ì¦ ë“±ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”
                </p>
              </div>

              {/* Upload Area */}
              <label className="block cursor-pointer">
                <div className={`border-2 border-dashed rounded-xl p-8 text-center transition-all ${
                  isProcessing 
                    ? 'border-primary bg-primary/5' 
                    : 'border-border hover:border-primary/50 hover:bg-secondary/30'
                }`}>
                  {isProcessing ? (
                    <div className="flex flex-col items-center gap-4">
                      <div className="w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center">
                        <Loader2 className="w-8 h-8 text-primary animate-spin" />
                      </div>
                      <div>
                        <p className="font-medium mb-1">AIê°€ ë¬¸ì„œë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                        <p className="text-sm text-muted-foreground">ê¸ˆì•¡, ê³„ì¢Œì •ë³´ ë“±ì„ ìë™ ì¶”ì¶œí•©ë‹ˆë‹¤</p>
                      </div>
                    </div>
                  ) : uploadedFiles.length > 0 ? (
                    <div className="flex flex-col items-center gap-4">
                      <div className="w-16 h-16 rounded-full bg-success/10 flex items-center justify-center">
                        <CheckCircle2 className="w-8 h-8 text-success" />
                      </div>
                      <div>
                        <p className="font-medium mb-2">{uploadedFiles.length}ê°œ íŒŒì¼ ì—…ë¡œë“œë¨</p>
                        <div className="flex flex-wrap gap-2 justify-center">
                          {uploadedFiles.map((file, i) => (
                            <span key={i} className="text-xs px-2 py-1 rounded-full bg-secondary text-muted-foreground">
                              {file.name}
                            </span>
                          ))}
                        </div>
                      </div>
                    </div>
                  ) : (
                    <div className="flex flex-col items-center gap-4">
                      <div className="w-16 h-16 rounded-full bg-secondary flex items-center justify-center">
                        <Upload className="w-8 h-8 text-muted-foreground" />
                      </div>
                      <div>
                        <p className="font-medium mb-1">í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ</p>
                        <p className="text-sm text-muted-foreground">PDF, Word, í•œê¸€, ì´ë¯¸ì§€ (JPG, PNG)</p>
                      </div>
                    </div>
                  )}
                </div>
                <input 
                  type="file" 
                  className="hidden" 
                  multiple 
                  accept=".pdf,.doc,.docx,.hwp,.jpg,.jpeg,.png"
                  onChange={handleFileUpload}
                />
              </label>

              {/* AI Extract Info */}
              {extractedData.amount && (
                <div className="mt-6 p-4 rounded-lg bg-primary/5 border border-primary/20">
                  <div className="flex items-center gap-2 mb-3">
                    <Sparkles className="w-4 h-4 text-primary" />
                    <span className="text-sm font-medium text-primary">AI ì¶”ì¶œ ì •ë³´</span>
                  </div>
                  <div className="grid grid-cols-2 gap-4 text-sm">
                    <div>
                      <span className="text-muted-foreground">ê¸ˆì•¡:</span>
                      <span className="ml-2 font-medium">â‚©{extractedData.amount}</span>
                    </div>
                    <div>
                      <span className="text-muted-foreground">ê³„ì¢Œë²ˆí˜¸:</span>
                      <span className="ml-2 font-medium">{extractedData.accountNumber}</span>
                    </div>
                  </div>
                </div>
              )}

              <Button 
                className="w-full mt-6" 
                size="lg"
                disabled={uploadedFiles.length === 0 || isProcessing}
                onClick={() => setStep(2)}
              >
                ë‹¤ìŒ ë‹¨ê³„ë¡œ
              </Button>
            </div>
          )}

          {/* Step 2: Form Input */}
          {step === 2 && (
            <form onSubmit={handleSubmit} className="glass-card p-8 space-y-6">
              {/* Company Info */}
              <div className="space-y-4">
                <div className="flex items-center gap-2 text-sm font-medium text-muted-foreground">
                  <Building2 className="w-4 h-4" />
                  ê±°ë˜ì²˜ ì •ë³´
                </div>
                <div className="grid sm:grid-cols-2 gap-4">
                  <div className="space-y-2">
                    <Label htmlFor="companyName">íšŒì‚¬ëª…</Label>
                    <Input 
                      id="companyName" 
                      placeholder="(ì£¼)ê±°ë˜ì²˜íšŒì‚¬" 
                      value={formData.companyName}
                      onChange={(e) => setFormData(prev => ({ ...prev, companyName: e.target.value }))}
                      required
                    />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="amount">ì²­êµ¬ ê¸ˆì•¡</Label>
                    <Input 
                      id="amount" 
                      placeholder="â‚© 0" 
                      value={formData.amount}
                      onChange={(e) => setFormData(prev => ({ ...prev, amount: e.target.value }))}
                      required
                    />
                  </div>
                </div>
                <div className="space-y-2">
                  <Label htmlFor="description">ì²­êµ¬ ë‚´ìš©</Label>
                  <Textarea 
                    id="description" 
                    placeholder="ì²­êµ¬ ë‚´ìš©ì„ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”"
                    className="min-h-[100px]"
                    value={formData.description}
                    onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}
                    required
                  />
                </div>
              </div>

              {/* Bank Info */}
              <div className="space-y-4 pt-4 border-t border-border">
                <div className="flex items-center gap-2 text-sm font-medium text-muted-foreground">
                  <CreditCard className="w-4 h-4" />
                  ì§€ê¸‰ ê³„ì¢Œ ì •ë³´
                </div>
                <div className="grid sm:grid-cols-3 gap-4">
                  <div className="space-y-2">
                    <Label htmlFor="bankName">ì€í–‰ëª…</Label>
                    <Select 
                      value={formData.bankName}
                      onValueChange={(value) => setFormData(prev => ({ ...prev, bankName: value }))}
                    >
                      <SelectTrigger id="bankName" className="bg-background">
                        <SelectValue placeholder="ì„ íƒ" />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectItem value="kb">êµ­ë¯¼ì€í–‰</SelectItem>
                        <SelectItem value="shinhan">ì‹ í•œì€í–‰</SelectItem>
                        <SelectItem value="woori">ìš°ë¦¬ì€í–‰</SelectItem>
                        <SelectItem value="hana">í•˜ë‚˜ì€í–‰</SelectItem>
                        <SelectItem value="nh">ë†í˜‘ì€í–‰</SelectItem>
                        <SelectItem value="ibk">ê¸°ì—…ì€í–‰</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="accountNumber">ê³„ì¢Œë²ˆí˜¸</Label>
                    <Input 
                      id="accountNumber" 
                      placeholder="ê³„ì¢Œë²ˆí˜¸"
                      value={formData.accountNumber}
                      onChange={(e) => setFormData(prev => ({ ...prev, accountNumber: e.target.value }))}
                      required
                    />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="accountHolder">ì˜ˆê¸ˆì£¼</Label>
                    <Input 
                      id="accountHolder" 
                      placeholder="ì˜ˆê¸ˆì£¼ëª…"
                      value={formData.accountHolder}
                      onChange={(e) => setFormData(prev => ({ ...prev, accountHolder: e.target.value }))}
                      required
                    />
                  </div>
                </div>
              </div>

              {/* Assign Employee */}
              <div className="space-y-4 pt-4 border-t border-border">
                <div className="flex items-center gap-2 text-sm font-medium text-muted-foreground">
                  <User className="w-4 h-4" />
                  ë‚´ë¶€ ë‹´ë‹¹ì ì§€ì •
                </div>
                <Select 
                  value={formData.assignedEmployee}
                  onValueChange={(value) => setFormData(prev => ({ ...prev, assignedEmployee: value }))}
                >
                  <SelectTrigger className="bg-background">
                    <SelectValue placeholder="ë‹´ë‹¹ìë¥¼ ì„ íƒí•˜ì„¸ìš”" />
                  </SelectTrigger>
                  <SelectContent>
                    {mockEmployees.map((emp) => (
                      <SelectItem key={emp.id} value={emp.id}>
                        <div className="flex items-center gap-3">
                          <div className="w-8 h-8 rounded-full bg-secondary flex items-center justify-center text-sm font-medium">
                            {emp.name.charAt(0)}
                          </div>
                          <div className="text-left">
                            <div className="font-medium">{emp.name}</div>
                            <div className="text-xs text-muted-foreground">{emp.department}</div>
                          </div>
                        </div>
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>

                {formData.assignedEmployee && (
                  <div className="p-3 rounded-lg bg-secondary/50 flex items-center gap-4">
                    <div className="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center">
                      <User className="w-5 h-5 text-primary" />
                    </div>
                    <div className="flex-1">
                      <div className="font-medium">
                        {mockEmployees.find(e => e.id === formData.assignedEmployee)?.name}
                      </div>
                      <div className="text-xs text-muted-foreground flex items-center gap-3 mt-1">
                        <span className="flex items-center gap-1">
                          <Phone className="w-3 h-3" />
                          {mockEmployees.find(e => e.id === formData.assignedEmployee)?.phone}
                        </span>
                        <span className="flex items-center gap-1">
                          <Mail className="w-3 h-3" />
                          {mockEmployees.find(e => e.id === formData.assignedEmployee)?.email}
                        </span>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              <div className="flex gap-3 pt-4">
                <Button type="button" variant="outline" onClick={() => setStep(1)} className="flex-1">
                  ì´ì „
                </Button>
                <Button type="submit" variant="hero" className="flex-1" disabled={isProcessing}>
                  {isProcessing ? (
                    <>
                      <Loader2 className="w-4 h-4 animate-spin" />
                      ì œì¶œ ì¤‘...
                    </>
                  ) : (
                    'ì²­êµ¬ì„œ ì œì¶œ'
                  )}
                </Button>
              </div>
            </form>
          )}

          {/* Step 3: Complete */}
          {step === 3 && (
            <div className="glass-card p-8 text-center">
              <div className="w-20 h-20 mx-auto mb-6 rounded-full bg-success/10 flex items-center justify-center">
                <CheckCircle2 className="w-10 h-10 text-success" />
              </div>
              <h2 className="text-2xl font-bold mb-2">ì²­êµ¬ì„œ ì œì¶œ ì™„ë£Œ!</h2>
              <p className="text-muted-foreground mb-6">
                ë‹´ë‹¹ì {mockEmployees.find(e => e.id === formData.assignedEmployee)?.name}ë‹˜ì—ê²Œ
                <br />ì¹´ì¹´ì˜¤í†¡/ì´ë©”ì¼ ì•Œë¦¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.
              </p>
              <div className="p-4 rounded-lg bg-secondary/50 text-left mb-6">
                <div className="text-sm space-y-2">
                  <div className="flex justify-between">
                    <span className="text-muted-foreground">ì²­êµ¬ ê¸ˆì•¡</span>
                    <span className="font-medium">â‚©{formData.amount}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-muted-foreground">ì ‘ìˆ˜ ë²ˆí˜¸</span>
                    <span className="font-mono text-primary">#INV-2025-0042</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-muted-foreground">ìƒíƒœ</span>
                    <span className="status-badge status-pending">ìŠ¹ì¸ ëŒ€ê¸°</span>
                  </div>
                </div>
              </div>
              <Button variant="outline" onClick={() => { setStep(1); setUploadedFiles([]); setFormData({ companyName: "", description: "", amount: "", bankName: "", accountNumber: "", accountHolder: "", assignedEmployee: "" }); }}>
                ìƒˆ ì²­êµ¬ì„œ ì‘ì„±
              </Button>
            </div>
          )}
        </div>
      </main>
    </div>
  );
};

export default GuestForm;



============================================================
File Path: src/pages/Index.tsx
============================================================
import { Header } from "@/components/landing/Header";
import { HeroSection } from "@/components/landing/HeroSection";
import { FeaturesSection } from "@/components/landing/FeaturesSection";
import { ArchitectureSection } from "@/components/landing/ArchitectureSection";
import { Footer } from "@/components/landing/Footer";

const Index = () => {
  return (
    <div className="min-h-screen bg-background">
      <Header />
      <main>
        <HeroSection />
        <FeaturesSection />
        <ArchitectureSection />
      </main>
      <Footer />
    </div>
  );
};

export default Index;



============================================================
File Path: src/pages/NotFound.tsx
============================================================
import { useLocation } from "react-router-dom";
import { useEffect } from "react";

const NotFound = () => {
  const location = useLocation();

  useEffect(() => {
    console.error("404 Error: User attempted to access non-existent route:", location.pathname);
  }, [location.pathname]);

  return (
    <div className="flex min-h-screen items-center justify-center bg-muted">
      <div className="text-center">
        <h1 className="mb-4 text-4xl font-bold">404</h1>
        <p className="mb-4 text-xl text-muted-foreground">Oops! Page not found</p>
        <a href="/" className="text-primary underline hover:text-primary/90">
          Return to Home
        </a>
      </div>
    </div>
  );
};

export default NotFound;



============================================================
File Path: src/pages/Onboarding.tsx
============================================================
import { useState, useRef } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { 
  Briefcase, ShieldCheck, Landmark, UploadCloud, Heart, 
  CheckCircle2, Loader2, Sparkles, Smartphone, MapPin, Globe, Mail, Hash, CreditCard,
  FileImage, SmartphoneIcon, UserCheck, Plus, Trash2
} from "lucide-react";
import { toast } from "sonner";
import { Separator } from "@/components/ui/separator";
import { ScrollArea } from "@/components/ui/scroll-area";
// êµ¬ê¸€ ë“œë¼ì´ë¸Œ API ë„êµ¬ ì„í¬íŠ¸
import { uploadFileToDrive } from "@/lib/driveApi";

const Onboarding = () => {
  const { profile, currentTenant, signOut } = useAuth();
  const [loading, setLoading] = useState(false);
  const idCardRef = useRef<HTMLInputElement>(null);
  const bankbookRef = useRef<HTMLInputElement>(null);

  const [formData, setFormData] = useState({
    hire_date: "", resignation_date: "", department: "", job_title: "ì‚¬ì›",
    resident_number: "", is_foreigner: "ë‚´êµ­ì¸", nationality: "ëŒ€í•œë¯¼êµ­", address: "",
    phone_mobile: "", phone_tel: "", email: profile?.email || "",
    bank_name: "", account_number: "", account_holder: profile?.full_name || "",
  });

  const [emergencyContacts, setEmergencyContacts] = useState([{ relation: "", name: "", phone: "" }]);
  const [bankType, setBankType] = useState<string>("");
  const [manualBankName, setManualBankName] = useState<string>("");
  const [idCardFile, setIdCardFile] = useState<File | null>(null);
  const [bankbookFile, setBankbookFile] = useState<File | null>(null);

  const addContact = () => setEmergencyContacts([...emergencyContacts, { relation: "", name: "", phone: "" }]);
  const removeContact = (index: number) => {
    if (emergencyContacts.length > 1) setEmergencyContacts(emergencyContacts.filter((_, i) => i !== index));
  };
  const updateContact = (index: number, field: string, value: string) => {
    const newContacts = [...emergencyContacts];
    newContacts[index] = { ...newContacts[index], [field]: value };
    setEmergencyContacts(newContacts);
  };

  // --- ì €ì¥ ë° ì—…ë¡œë“œ í•µì‹¬ ë¡œì§ ---
  const handleSave = async () => {
    // 1. í•„ìˆ˜ ì…ë ¥ê°’ ê²€ì¦
    if (!formData.hire_date || !formData.department || !formData.resident_number || !formData.address || !formData.account_number) {
      toast.error("í•„ìˆ˜ í•­ëª©(*)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    setLoading(true);
    try {
      const tenantId = currentTenant?.tenant_id;
      if (!tenantId) throw new Error("íšŒì‚¬ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

      // 2. êµ¬ê¸€ ë“œë¼ì´ë¸Œ íŒŒì¼ ì—…ë¡œë“œ ì‹¤í–‰
      // ì‹ ë¶„ì¦ ì—…ë¡œë“œ (í´ë”ëª…: ì‹ ë¶„ì¦)
      if (idCardFile) {
        const idRes = await uploadFileToDrive(tenantId, idCardFile, "ì‹ ë¶„ì¦");
        if (!idRes.success) {
          console.error("ì‹ ë¶„ì¦ ì—…ë¡œë“œ ì‹¤íŒ¨:", idRes.error);
          toast.warning("ì‹ ë¶„ì¦ íŒŒì¼ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ì„¤ì • í™•ì¸ í•„ìš”)");
        }
      }

      // í†µì¥ì‚¬ë³¸ ì—…ë¡œë“œ (í´ë”ëª…: í†µì¥ì‚¬ë³¸)
      if (bankbookFile) {
        const bankRes = await uploadFileToDrive(tenantId, bankbookFile, "í†µì¥ì‚¬ë³¸");
        if (!bankRes.success) {
          console.error("í†µì¥ì‚¬ë³¸ ì—…ë¡œë“œ ì‹¤íŒ¨:", bankRes.error);
          toast.warning("í†µì¥ì‚¬ë³¸ íŒŒì¼ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ì„¤ì • í™•ì¸ í•„ìš”)");
        }
      }

      // 3. Supabase DB ì •ë³´ ì—…ë°ì´íŠ¸ (ì§ê¸‰, ë¶€ì„œ ë“±)
      const { error } = await supabase
        .from("tenant_memberships")
        .update({
          job_title: formData.job_title,
          department: formData.department,
          // ì¶”ê°€ì ì¸ ë°ì´í„°(ì£¼ì†Œ, ì£¼ë¯¼ë²ˆí˜¸ ë“±)ë¥¼ ì €ì¥í•  ì»¬ëŸ¼ì´ DBì— ìˆë‹¤ë©´ ì—¬ê¸°ì— ì¶”ê°€
        })
        .eq("id", currentTenant?.id);

      if (error) throw error;

      toast.success("ì¸ì‚¬ ì •ë³´ ë° ì¦ë¹™ ì„œë¥˜ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
      
      // ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
      setTimeout(() => {
        window.location.href = "/dashboard";
      }, 1000);

    } catch (error: any) {
      console.error("Onboarding Error:", error);
      toast.error("ì •ë³´ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4 font-sans antialiased text-slate-900">
      <div className="w-full max-w-4xl bg-white rounded-[1.5rem] shadow-[0_20px_50px_-12px_rgba(0,0,0,0.1)] overflow-hidden flex flex-col h-[90vh]">
        
        {/* í—¤ë” ì„¹ì…˜ */}
        <div className="p-7 bg-[#0F172A] text-white shrink-0 relative">
          <div className="relative z-10 flex items-center justify-between">
            <div>
              <div className="flex items-center gap-2 text-blue-400 font-bold text-[11px] tracking-widest uppercase mb-1">
                <Sparkles className="w-3 h-3" /> Step 1. Onboarding
              </div>
              <h1 className="text-2xl font-black tracking-tight">
                ì •ë³´ ë“±ë¡ <span className="text-blue-400">ì‹œì‘í•˜ê¸°</span>
              </h1>
            </div>
            <div className="w-12 h-12 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center">
              <UserCheck className="w-6 h-6 text-blue-400" />
            </div>
          </div>
        </div>

        <ScrollArea className="flex-1 px-8 py-6 text-slate-800">
          <div className="max-w-3xl mx-auto space-y-10">
            
            {/* 01. ì¸ì‚¬ ì •ë³´ */}
            <section className="space-y-4">
              <div className="space-y-0.5 border-l-4 border-blue-600 pl-3">
                <h4 className="text-lg font-bold">ì†Œì† ë° ì§ë¬´</h4>
                <p className="text-[13px] text-slate-500 font-medium">íšŒì‚¬ ë‚´ì—ì„œì˜ ì—­í• ê³¼ ì…ì‚¬ì¼ì„ ì§€ì •í•©ë‹ˆë‹¤.</p>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3">
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ì…ì‚¬ì¼ì *</Label>
                  <Input type="date" className="h-10 rounded-lg" value={formData.hire_date} onChange={e => setFormData({...formData, hire_date: e.target.value})} />
                </div>
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">í‡´ì‚¬ì¼ì</Label>
                  <Input type="date" className="h-10 rounded-lg" value={formData.resignation_date} onChange={e => setFormData({...formData, resignation_date: e.target.value})} />
                </div>
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ë¶€ì„œ *</Label>
                  <Input placeholder="ë¶€ì„œëª…" className="h-10 rounded-lg" value={formData.department} onChange={e => setFormData({...formData, department: e.target.value})} />
                </div>
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ì§ê¸‰ *</Label>
                  <Select value={formData.job_title} onValueChange={val => setFormData({...formData, job_title: val})}>
                    <SelectTrigger className="h-10 rounded-lg"><SelectValue /></SelectTrigger>
                    <SelectContent>
                      {["ì´ì‚¬", "ë¶€ì¥", "ê³¼ì¥", "ëŒ€ë¦¬", "ì‚¬ì›", "ì¸í„´"].map(v => <SelectItem key={v} value={v}>{v}</SelectItem>)}
                    </SelectContent>
                  </Select>
                </div>
              </div>
            </section>

            <Separator className="bg-slate-100" />

            {/* 02. ê°œì¸ ì •ë³´ */}
            <section className="space-y-5">
              <div className="space-y-0.5 border-l-4 border-blue-600 pl-3">
                <h4 className="text-lg font-bold">ì¸ì  ì‚¬í•­</h4>
                <p className="text-[13px] text-slate-500 font-medium">ê¸‰ì—¬ ì‹ ê³  ë° ë³¸ì¸ í™•ì¸ì„ ìœ„í•œ ì •ë³´ì…ë‹ˆë‹¤.</p>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3">
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ *</Label>
                  <Input type="password" placeholder="000000-0000000" className="h-10 rounded-lg" value={formData.resident_number} onChange={e => setFormData({...formData, resident_number: e.target.value})} />
                </div>
                <div className="grid grid-cols-2 gap-3">
                  <div className="space-y-1">
                    <Label className="text-[12px] font-bold text-slate-600">êµ¬ë¶„ *</Label>
                    <Select value={formData.is_foreigner} onValueChange={val => setFormData({...formData, is_foreigner: val})}>
                      <SelectTrigger className="h-10 rounded-lg"><SelectValue /></SelectTrigger>
                      <SelectContent><SelectItem value="ë‚´êµ­ì¸">ë‚´êµ­ì¸</SelectItem><SelectItem value="ì™¸êµ­ì¸">ì™¸êµ­ì¸</SelectItem></SelectContent>
                    </Select>
                  </div>
                  <div className="space-y-1">
                    <Label className="text-[12px] font-bold text-slate-600">êµ­ì  *</Label>
                    <Input className="h-10 rounded-lg" value={formData.nationality} onChange={e => setFormData({...formData, nationality: e.target.value})} />
                  </div>
                </div>
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">íœ´ëŒ€í°ë²ˆí˜¸ *</Label>
                  <Input placeholder="010-0000-0000" className="h-10 rounded-lg" value={formData.phone_mobile} onChange={e => setFormData({...formData, phone_mobile: e.target.value})} />
                </div>
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ì´ë©”ì¼ *</Label>
                  <Input className="h-10 rounded-lg" value={formData.email} onChange={e => setFormData({...formData, email: e.target.value})} />
                </div>
                <div className="space-y-1 md:col-span-2">
                  <Label className="text-[12px] font-bold text-slate-600">í˜„ì¬ ê±°ì£¼ì§€ ì£¼ì†Œ *</Label>
                  <Input placeholder="ìƒì„¸ ì£¼ì†Œë¥¼ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”" className="h-10 rounded-lg" value={formData.address} onChange={e => setFormData({...formData, address: e.target.value})} />
                </div>
              </div>

              {/* ë¹„ìƒì—°ë½ì²˜ ë¦¬ìŠ¤íŠ¸ */}
              <div className="p-5 rounded-2xl bg-slate-50 border border-slate-100 space-y-4">
                <div className="flex items-center justify-between">
                  <Label className="text-[13px] font-extrabold flex items-center gap-2 text-rose-600">
                    <Heart className="w-3.5 h-3.5 fill-rose-600" /> ë¹„ìƒ ì—°ë½ì²˜ (ê°€ì¡±)
                  </Label>
                  <Button type="button" variant="outline" size="sm" onClick={addContact} className="h-7 text-[11px] px-2 rounded-md border-blue-200 text-blue-600">
                    + ì¶”ê°€í•˜ê¸°
                  </Button>
                </div>
                <div className="space-y-2">
                  {emergencyContacts.map((contact, index) => (
                    <div key={index} className="flex gap-2 animate-in fade-in slide-in-from-top-1">
                      <Input placeholder="ê´€ê³„" className="h-9 rounded-lg bg-white w-20 text-sm" value={contact.relation} onChange={(e) => updateContact(index, "relation", e.target.value)} />
                      <Input placeholder="ì„±í•¨" className="h-9 rounded-lg bg-white w-24 text-sm" value={contact.name} onChange={(e) => updateContact(index, "name", e.target.value)} />
                      <Input placeholder="ì—°ë½ì²˜" className="h-9 rounded-lg bg-white flex-1 text-sm" value={contact.phone} onChange={(e) => updateContact(index, "phone", e.target.value)} />
                      <Button type="button" variant="ghost" size="icon" onClick={() => removeContact(index)} className="h-9 w-9 text-slate-300 hover:text-rose-500"><Trash2 className="w-4 h-4" /></Button>
                    </div>
                  ))}
                </div>
              </div>
            </section>

            <Separator className="bg-slate-100" />

            {/* 03. ê³„ì¢Œ ì •ë³´ */}
            <section className="space-y-4">
              <div className="space-y-0.5 border-l-4 border-blue-600 pl-3">
                <h4 className="text-lg font-bold">ê¸‰ì—¬ ê³„ì¢Œ</h4>
                <p className="text-[13px] text-slate-500 font-medium">ê¸‰ì—¬ê°€ ì •ì‚°ë  ë³¸ì¸ ëª…ì˜ì˜ ê³„ì¢Œì…ë‹ˆë‹¤.</p>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3">
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ì…ê¸ˆ ì€í–‰ *</Label>
                  <Select value={bankType} onValueChange={setBankType}>
                    <SelectTrigger className="h-10 rounded-lg text-sm"><SelectValue placeholder="ì€í–‰ ì„ íƒ" /></SelectTrigger>
                    <SelectContent>
                      {["êµ­ë¯¼ì€í–‰", "ì‹ í•œì€í–‰", "ìš°ë¦¬ì€í–‰", "í•˜ë‚˜ì€í–‰", "manual"].map(b => (
                        <SelectItem key={b} value={b}>{b === "manual" ? "ì§ì ‘ ì…ë ¥" : b}</SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                  {bankType === "manual" && <Input placeholder="ì€í–‰ëª… ì…ë ¥" className="h-9 rounded-lg mt-1 text-sm" value={manualBankName} onChange={e => setManualBankName(e.target.value)} />}
                </div>
                <div className="space-y-1">
                  <Label className="text-[12px] font-bold text-slate-600">ì˜ˆê¸ˆì£¼ *</Label>
                  <Input className="h-10 rounded-lg bg-slate-50 font-bold" value={formData.account_holder} readOnly />
                </div>
                <div className="space-y-1 md:col-span-2">
                  <Label className="text-[12px] font-bold text-slate-600">ê³„ì¢Œë²ˆí˜¸ *</Label>
                  <Input placeholder="ìˆ«ìë§Œ ì…ë ¥" className="h-10 rounded-lg tabular-nums" value={formData.account_number} onChange={e => setFormData({...formData, account_number: e.target.value})} />
                </div>
              </div>
            </section>

            <Separator className="bg-slate-100" />

            {/* 04. ì„œë¥˜ ì—…ë¡œë“œ */}
            <section className="space-y-4 pb-6">
              <div className="space-y-0.5 border-l-4 border-blue-600 pl-3">
                <h4 className="text-lg font-bold">ì¦ë¹™ ì„œë¥˜</h4>
                <p className="text-[13px] text-slate-500 font-medium">ë³´ì•ˆ í´ë”ì— ì•ˆì „í•˜ê²Œ ë³´ê´€ë©ë‹ˆë‹¤.</p>
              </div>
              <div className="grid grid-cols-2 gap-4">
                {[ { label: "ì‹ ë¶„ì¦ ì‚¬ë³¸", ref: idCardRef, file: idCardFile, set: setIdCardFile, Icon: SmartphoneIcon },
                   { label: "í†µì¥ ì‚¬ë³¸", ref: bankbookRef, file: bankbookFile, set: setBankbookFile, Icon: FileImage }
                ].map((item, idx) => (
                  <div key={idx} onClick={() => item.ref.current?.click()} className={`p-6 border-2 border-dashed rounded-2xl text-center hover:bg-blue-50/50 transition-all cursor-pointer ${item.file ? 'border-green-500 bg-green-50/30' : 'border-slate-200'}`}>
                    <input type="file" ref={item.ref} className="hidden" onChange={e => item.set(e.target.files?.[0] || null)} />
                    {item.file ? (
                      <div className="text-green-600 font-bold animate-in zoom-in-95">
                        <CheckCircle2 className="w-8 h-8 mx-auto mb-1" />
                        <p className="text-[11px] truncate">{item.file.name}</p>
                      </div>
                    ) : (
                      <div className="text-slate-400 group-hover:text-blue-500 transition-colors">
                        <item.Icon className="w-8 h-8 mx-auto mb-2" />
                        <p className="text-sm font-bold text-slate-700">{item.label}</p>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </section>
          </div>
        </ScrollArea>

        {/* í•˜ë‹¨ ë°” */}
        <div className="px-8 py-5 border-t bg-white flex items-center justify-between shrink-0">
          <Button variant="ghost" className="text-slate-400 text-sm font-bold" onClick={signOut}>ë‚˜ì¤‘ì— ë“±ë¡</Button>
          <Button variant="hero" size="lg" className="px-12 text-md font-black rounded-xl shadow-lg min-w-[160px]" onClick={handleSave} disabled={loading}>
            {loading ? (
              <div className="flex items-center gap-2">
                <Loader2 className="w-5 h-5 animate-spin" />
                <span>ì²˜ë¦¬ ì¤‘...</span>
              </div>
            ) : "ì •ë³´ ë“±ë¡ ì™„ë£Œ"}
          </Button>
        </div>
      </div>
    </div>
  );
};

export default Onboarding;


============================================================
File Path: src/pages/ProfileManagement.tsx
============================================================
import { useState, useEffect, useRef } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Tabs, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Separator } from "@/components/ui/separator";
import { Badge } from "@/components/ui/badge";
import { Printer, User, CheckCircle2, FileCheck } from "lucide-react";
import { toast } from "sonner";

// --- Types ---
interface Artist {
  id: string;
  name: string;
  birth_date: string;
  gender: string;
  phone_mobile?: string;
  email?: string;
  address: string;
  resident_number: string;
  id_card_url: string;
  id_card_masked_url: string;
  signature_url: string;
}

interface Employee {
  id: string;
  full_name: string;
  phone: string;
  email: string;
  department?: string;
  job_title?: string;
  join_date?: string;
}

interface TenantInfo {
  name: string;
  rep_name: string;
  address: string;
}

// [ì¶”ê°€] ì´ë¯¸ì§€ë¥¼ Base64ë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
const convertImgToBase64 = async (url: string): Promise<string> => {
  try {
    const response = await fetch(url);
    const blob = await response.blob();
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onloadend = () => resolve(reader.result as string);
      reader.onerror = reject;
      reader.readAsDataURL(blob);
    });
  } catch (error) {
    console.error("Image conversion error:", error);
    return url; // ì‹¤íŒ¨ ì‹œ ì›ë³¸ URL ë°˜í™˜
  }
};

// --- Document Component (ì¸ì‡„ìš© í…œí”Œë¦¿) ---
const PortalDocTemplate = ({ 
  type, 
  artist, 
  employee, 
  tenantInfo,
  extraInfo 
}: { 
  type: "naver" | "daum" | "certificate"; 
  artist: Artist | null; 
  employee: Employee | null; 
  tenantInfo: TenantInfo;
  extraInfo: { empBirth: string; empAddress: string; relation: string; date: string; usage: string }
}) => {
  // ë‚ ì§œ ê³„ì‚°
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth() + 1;
  const day = today.getDate();
  
  const startDate = `${year}ë…„ ${month}ì›” ${day}ì¼`;
  const endDateObj = new Date(today.getFullYear() + 3, today.getMonth(), today.getDate());
  const endDate = `${endDateObj.getFullYear()}ë…„ ${endDateObj.getMonth() + 1}ì›” ${endDateObj.getDate()}ì¼`;

  const dateString = `${year}ë…„  ${month}ì›”  ${day}ì¼`;

  // === CSS Styles ===
  const styles = {
    page: {
      width: "210mm",
      minHeight: "297mm",
      backgroundColor: "white",
      color: "black",
      fontFamily: "'Malgun Gothic', 'Dotum', sans-serif",
      padding: "15mm 15mm",
      boxSizing: "border-box" as const,
      position: "relative" as const,
      lineHeight: "1.4",
    },
    title: {
      fontSize: "22pt",
      fontWeight: "bold",
      textAlign: "center" as const,
      marginBottom: "30px",
      letterSpacing: "-1px",
    },
    certTitle: {
      fontSize: "28pt",
      fontWeight: "bold",
      textAlign: "center" as const,
      marginBottom: "50px",
      letterSpacing: "5px",
    },
    table: {
      width: "100%",
      borderCollapse: "collapse" as const,
      fontSize: "10pt",
      marginBottom: "5px",
      borderTop: "2px solid black",
    },
    th: {
      border: "1px solid #000",
      backgroundColor: "#e8e8e8",
      padding: "6px 2px",
      textAlign: "center" as const,
      fontWeight: "bold",
      wordBreak: "keep-all" as const,
      verticalAlign: "middle",
    },
    td: {
      border: "1px solid #000",
      padding: "6px 5px",
      textAlign: "center" as const,
      verticalAlign: "middle",
    },
    tdLeft: {
      border: "1px solid #000",
      padding: "8px",
      textAlign: "left" as const,
      verticalAlign: "middle",
      lineHeight: "1.6",
    },
    inputUnderline: {
      borderBottom: "1px solid black",
      display: "inline-block",
      minWidth: "150px",
      textAlign: "center" as const,
      position: "relative" as const,
    },
    signatureImg: {
      position: "absolute" as const,
      top: "50%",
      left: "50%",
      transform: "translate(-50%, -50%)",
      maxHeight: "40px",
      maxWidth: "100px",
      zIndex: 1,
    },
    footerDate: {
      marginTop: "40px",
      marginBottom: "30px",
      fontSize: "16pt",
      fontWeight: "bold",
      textAlign: "center" as const,
    },
    footerSign: {
      display: "flex",
      justifyContent: "center",
      alignItems: "center",
      fontSize: "12pt",
      gap: "10px",
    },
    yellowBox: {
      backgroundColor: "#ffff00",
      fontWeight: "bold",
      padding: "2px 5px",
    }
  };

  // ì¬ì§ì¦ëª…ì„œ ë Œë”ë§
  if (type === "certificate") {
    if (!employee) return <div className="p-10 text-center">ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>;
    
    return (
      <div style={styles.page}>
        <div style={{ padding: "10mm" }}>
          <h1 style={styles.certTitle}>ì¬ ì§ ì¦ ëª… ì„œ</h1>
          
          <div style={{ marginBottom: "10px", fontWeight: "bold", fontSize: "14pt" }}>1. ì¸ì ì‚¬í•­</div>
          <table style={styles.table}>
            <tbody>
              <tr>
                <th style={styles.th}>ì„± ëª…</th>
                <td style={styles.td}>{employee.full_name}</td>
                <th style={styles.th}>ìƒë…„ì›”ì¼</th>
                <td style={styles.td}>{extraInfo.empBirth}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì£¼ ì†Œ</th>
                <td style={styles.td} colSpan={3}>{extraInfo.empAddress}</td>
              </tr>
            </tbody>
          </table>

          <div style={{ marginBottom: "10px", fontWeight: "bold", fontSize: "14pt", marginTop: "30px" }}>2. ì¬ì§ì‚¬í•­</div>
          <table style={styles.table}>
            <tbody>
              <tr>
                <th style={styles.th}>ì†Œ ì†</th>
                <td style={styles.td}>{tenantInfo.name}</td>
                <th style={styles.th}>ë¶€ ì„œ</th>
                <td style={styles.td}>{employee.department || "-"}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì§ ìœ„</th>
                <td style={styles.td}>{employee.job_title || "ë§¤ë‹ˆì €"}</td>
                <th style={styles.th}>ì¬ì§ê¸°ê°„</th>
                <td style={styles.td}>
                  {employee.join_date ? new Date(employee.join_date).toLocaleDateString() : "ì…ì‚¬ì¼ ë¯¸ìƒ"} ~ í˜„ì¬
                </td>
              </tr>
            </tbody>
          </table>

          <div style={{ marginBottom: "10px", fontWeight: "bold", fontSize: "14pt", marginTop: "30px" }}>3. ë°œê¸‰ìš©ë„</div>
          <table style={styles.table}>
            <tbody>
              <tr>
                <th style={styles.th}>ìš© ë„</th>
                <td style={styles.td}>{extraInfo.usage}</td>
              </tr>
            </tbody>
          </table>

          <div style={{ marginTop: "60px", textAlign: "center", fontSize: "14pt", lineHeight: "2" }}>
            <p>ìƒê¸° ì¸ì€ ìœ„ì™€ ê°™ì´ ë‹¹ì‚¬ì— ì¬ì§í•˜ê³  ìˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤.</p>
          </div>

          <div style={styles.footer}>
            <p style={{ fontSize: "16pt", marginBottom: "30px" }}>{dateString}</p>
            <div style={styles.companyName}>{tenantInfo.name}</div>
            <div style={styles.ceoName}>
              ëŒ€í‘œì´ì‚¬ &nbsp;&nbsp; {tenantInfo.rep_name || "(ëŒ€í‘œìëª…)"} &nbsp;&nbsp; (ì¸)
            </div>
            <div style={{ fontSize: "10pt", color: "#888", marginTop: "10px" }}>
              {tenantInfo.address}
            </div>
          </div>
        </div>
      </div>
    );
  }

  // ê¸°ì¡´ ìœ„ì„ì¥ ë¡œì§ (ë„¤ì´ë²„/ë‹¤ìŒ)
  if (!artist || !employee) return <div className="p-10 text-center">ì •ë³´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>;

  return (
    <div style={styles.page}>
      
      {/* -------------------- NAVER (ë„¤ì´ë²„) ìœ„ì„ì¥ -------------------- */}
      {type === "naver" && (
        <div className="flex flex-col h-full">
          <h1 style={styles.title}>ì¸ë¬¼ì •ë³´ ë“± ê´€ë¦¬ ìœ„ì„ì¥</h1>

          <table style={styles.table}>
            <colgroup>
              <col style={{ width: "12%" }} /><col style={{ width: "13%" }} /><col style={{ width: "25%" }} /><col style={{ width: "13%" }} /><col style={{ width: "19%" }} /><col style={{ width: "8%" }} /><col style={{ width: "10%" }} />
            </colgroup>
            <tbody>
              <tr>
                <th style={styles.th} rowSpan={3}>ë³¸ì¸<br/>(ìœ„ì„ì¸)</th>
                <th style={styles.th}>ë³¸ëª…</th>
                <td style={styles.td}>{artist.name}</td>
                <th style={styles.th}>ìƒë…„ì›”ì¼</th>
                <td style={styles.td}>{artist.birth_date?.replace(/-/g, '')}</td>
                <th style={styles.th}>ì„±ë³„</th>
                <td style={styles.td}>{artist.gender === 'male' ? 'ë‚¨' : artist.gender === 'female' ? 'ì—¬' : ''}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì „í™”ë²ˆí˜¸</th>
                <td style={styles.td}>{artist.phone_mobile}</td>
                <th style={styles.th}>ì´ë©”ì¼</th>
                <td style={styles.td} colSpan={3}>{artist.email}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì˜ˆëª…/ê·¸ë£¹ëª…</th>
                <td style={styles.td} colSpan={5}>
                  {artist.name} {artist.name !== (artist as any).stage_name && (artist as any).stage_name ? `(${ (artist as any).stage_name })` : ""}
                </td>
              </tr>
              <tr>
                <th style={styles.th}>ìœ„ì„ë‚´ìš©</th>
                <td style={styles.tdLeft} colSpan={6}>
                  - ë„¤ì´ë²„ ì¸ë¬¼ì •ë³´ ì„œë¹„ìŠ¤ì—ì„œ ë³¸ì¸ì˜ ì¸ë¬¼ì •ë³´ê°€ ì œê³µë˜ëŠ” ê²ƒê³¼ ê´€ë ¨, ë„¤ì´ë²„ãˆœë¥¼ ìƒëŒ€ë¡œ 
                  ê·¸ ì¸ë¬¼ì •ë³´ì˜ ë“±ë¡, ìˆ˜ì • ë˜ëŠ” ì‚­ì œë¥¼ ë‹¨ë…ìœ¼ë¡œ ì‹ ì²­í•˜ëŠ” ê²ƒì— ê´€í•œ ì¼ì²´ì˜ ì—…ë¬´<br/><br/>
                  - ë„¤ì´ë²„ãˆœë¥¼ ìƒëŒ€ë¡œ ë³¸ì¸ì˜ ëª…ì˜ˆ, ì‚¬ìƒí™œ, ì €ì‘ê¶Œ ë“± ê¶Œë¦¬ë¥¼ ì¹¨í•´í•˜ëŠ”, ê²Œì‹œë¬¼ ë“± ê²€ìƒ‰ê²°ê³¼
                  ì˜ ì œì™¸(ê²Œì‹œì¤‘ë‹¨ í¬í•¨) ë˜ëŠ” ê²€ìƒ‰ì–´ì˜ ì œì™¸ë¥¼ ë‹¨ë…ìœ¼ë¡œ ìš”ì²­í•˜ëŠ” ê²ƒì— ê´€í•œ ì¼ì²´ì˜ ì—…ë¬´
                </td>
              </tr>
              <tr>
                <th style={styles.th}>ìœ„ì„ê¸°ê°„</th>
                <td style={styles.tdLeft} colSpan={6}>
                  {startDate} ~ {endDate} (ìµœë‹¨ 1ì£¼ì¼ì—ì„œ ìµœì¥ 36ê°œì›”)<br/>
                  <span style={{ fontSize: "9pt", color: "#666" }}>
                    â€» ë³¸ ìœ„ì„ì„ ì² íšŒí•˜ì‹  ê²½ìš° ì¸ë¬¼ì •ë³´ ê³ ê°ì„¼í„°ë¡œ ì•Œë ¤ì£¼ì…”ì•¼ í•˜ë©°, ê·¸ ì „ê¹Œì§€ëŠ” ê¸°ì¬ëœ ìœ„
                    ì„ê¸°ê°„ì´ ê²½ê³¼í•˜ì§€ ì•Šì€ í•œ ëŒ€ë¦¬ì¸ì˜ ê´€ë¦¬ê¶Œí•œì´ ìœ íš¨í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.
                  </span>
                </td>
              </tr>
            </tbody>
          </table>

          <div style={{ height: "10px" }}></div>

          <table style={{ ...styles.table, borderTop: "2px solid black" }}>
            <colgroup>
              <col style={{ width: "12%" }} /><col style={{ width: "15%" }} /><col style={{ width: "38%" }} /><col style={{ width: "15%" }} /><col style={{ width: "20%" }} />
            </colgroup>
            <tbody>
              <tr>
                <th style={styles.th} rowSpan={4}>ëŒ€ë¦¬ì¸<br/>(ìˆ˜ì„ì¸)</th>
                <th style={styles.th}>ì„±ëª…</th>
                <td style={styles.td}>{employee.full_name}</td>
                <th style={styles.th}>ìƒë…„ì›”ì¼</th>
                <td style={styles.td}>{extraInfo.empBirth?.replace(/-/g, '')}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì „í™”ë²ˆí˜¸</th>
                <td style={styles.td}>{employee.phone}</td>
                <th style={styles.th}>ì´ë©”ì¼</th>
                <td style={styles.td}>{employee.email}</td>
              </tr>
              <tr>
                <th style={styles.th}>ë³¸ì¸ê³¼ì˜ ê´€ê³„</th>
                <td style={styles.td} colSpan={3}>{extraInfo.relation} ({tenantInfo.name})</td>
              </tr>
              <tr>
                <th style={styles.th}>ë³¸ì¸ì°¸ì—¬ ID</th>
                <td style={styles.td} colSpan={3}>
                  <div style={{ textAlign: "right", fontSize: "9pt", color: "#666", marginBottom: "2px" }}>
                    (ê´€ë¦¬ê¶Œí•œì„ í–‰ì‚¬í•  ë„¤ì´ë²„ IDë¡œì„œ, ì‹¤ëª… í™•ì¸ í•„ìˆ˜)
                  </div>
                  <div style={{ color: "red", fontSize: "9pt", fontWeight: "bold", textAlign: "left" }}>
                    â€» ì‹ ì²­ì ì •ë³´(ID, ì„±ëª…)ì™€ ë™ì¼í•˜ì§€ ì•Šì„ ì‹œ ê¶Œí•œì‹ ì²­ì´ ë³´ë¥˜ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì‘ì„± 
                    ì‹œ ì£¼ì˜í•´ì£¼ì„¸ìš”!
                  </div>
                </td>
              </tr>
              <tr>
                <th style={styles.th}>ì •ë³´ìˆ˜ì§‘ ë™ì˜</th>
                <td style={styles.tdLeft} colSpan={4}>
                  <div style={{ fontSize: "9pt", lineHeight: "1.5" }}>
                    â€» ëŒ€ë¦¬ì¸(ìˆ˜ì„ì¸)ì€ ë³¸ ìœ„ì„ì¥ ì œì¶œ ê³¼ì •ì—ì„œ ëŒ€ë¦¬ì¸ì˜ ì´ë¦„, ìƒë…„ì›”ì¼, ì „í™”ë²ˆí˜¸, 
                    ì´ë©”ì¼, ë³¸ì¸ê³¼ì˜ ê´€ê³„, ë„¤ì´ë²„ ID, ì•„ë˜ ìœ„ì„ê´€ê³„ ì¦ë¹™ìš© í•„ìˆ˜ ì œì¶œ ì„œë¥˜ê°€ ë„¤ì´ë²„
                    ãˆœì— ì˜í•´ ìˆ˜ì§‘ë˜ì–´, ìƒê¸° ë³¸ì¸ì˜ ì¸ë¬¼ì •ë³´ ë“±ë¡, ìˆ˜ì •, ì‚­ì œë¥¼ ìœ„í•´ ì´ìš©ë˜ë©°, ìœ„
                    ì„ì— ì˜í•œ ì‹ ì²­ ë˜ëŠ” ìš”ì²­ ì²˜ë¦¬ ì´ë ¥, ë¶ˆë§Œ ì²˜ë¦¬ ì´ë ¥ ë“±ì€ ë¶„ìŸ í•´ê²°ì„ ìœ„í•´ í•„ìš”
                    í•œ ê¸°ë¡ ë³´ê´€ì„ ëª©ì ìœ¼ë¡œ <b>ì„œë¹„ìŠ¤ ì´ìš©ê¸°ê°„ ë˜ëŠ” ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ ë³´ê´€ë˜ëŠ” 
                    ê²ƒì— ë™ì˜í•˜ì‹­ë‹ˆê¹Œ?</b>
                  </div>
                  <div style={{ marginTop: "5px" }}>
                    <span style={styles.yellowBox}>ë™ì˜í•©ë‹ˆë‹¤. ( V )</span>
                  </div>
                  <div style={{ fontSize: "9pt", color: "#888", marginTop: "2px" }}>
                    ê´„í˜¸ì•ˆì— ë™ì˜ì²´í¬ " V " í•´ì£¼ì…”ì•¼ ì •ìƒ ì²˜ë¦¬ë©ë‹ˆë‹¤.
                  </div>
                  <div style={{ fontSize: "9pt", marginTop: "5px" }}>
                    â€» ìœ„ì˜ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ëŒ€í•œ ë™ì˜ë¥¼ ê±°ë¶€í•  ê¶Œë¦¬ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë™
                    ì˜í•˜ì§€ ì•Šìœ¼ì‹¤ ê²½ìš° ì„œë¹„ìŠ¤ ì œê³µì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <div style={{ fontSize: "10pt", marginTop: "15px", lineHeight: "1.6" }}>
            <ol style={{ paddingLeft: "20px", margin: 0 }}>
              <li style={{ marginBottom: "5px" }}>
                ë³¸ì¸(ìœ„ì„ì¸)ì€ ë„¤ì´ë²„ ì¸ë¬¼ì •ë³´ ë“± ì„œë¹„ìŠ¤ì—ì„œì˜ ë³¸ì¸ì˜ ì¸ë¬¼ì •ë³´ ë“±ì˜ ê´€ë¦¬ì— ê´€í•˜ì—¬ ìƒê¸° ìœ„ì„ë‚´ìš©
                ìƒì˜ ì¼ì²´ì˜ ì—…ë¬´ë¥¼ ìƒê¸° ëŒ€ë¦¬ì¸(ìˆ˜ì„ì¸)ì—ê²Œ ìœ„ì„í•©ë‹ˆë‹¤.
              </li>
              <li>
                ë³¸ì¸(ìœ„ì„ì¸)ì€ ëŒ€ë¦¬ì¸(ìˆ˜ì„ì¸)ì´ ê·¸ì˜ ê´€ë¦¬ê¶Œí•œì´ ìœ íš¨í•˜ê²Œ ì¡´ì†í•˜ëŠ” ê¸°ê°„ ì¤‘ ë„¤ì´ë²„ãˆœë¥¼ ìƒëŒ€ë¡œ ì‹ ì²­ 
                ë˜ëŠ” ìš”ì²­í•œ ì‚¬í•­ì´ ì¶”í›„ ì‚¬ì‹¤ì´ ì•„ë‹˜ì´ ë°í˜€ì§ˆ ê²½ìš° ê·¸ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì±…ì„ì„ ë³¸ì¸ì´ ë¶€ë‹´í•  ê²ƒì„
                ì„ í™•ì¸í•©ë‹ˆë‹¤.
              </li>
            </ol>
          </div>

          <div style={styles.footerDate}>
            {year} &nbsp;ë…„&nbsp;&nbsp;&nbsp; {month} &nbsp;ì›”&nbsp;&nbsp;&nbsp; {day} &nbsp;ì¼
          </div>

          <div style={styles.footerSign}>
            <span style={styles.yellowBox}>ë³¸ì¸(ìœ„ì„ì¸)</span>
            <div style={{ ...styles.inputUnderline, width: "200px", borderBottom: "1px solid black" }}>
              {artist.name} (ì¸)
              {artist.signature_url && (
                <img src={artist.signature_url} alt="ì„œëª…" style={styles.signatureImg} />
              )}
            </div>
            <span style={{ ...styles.yellowBox, fontSize: "10pt", fontWeight: "normal", backgroundColor: "yellow" }}>(ë‚ ì¸ ë˜ëŠ” ì„œëª…)</span>
          </div>
        </div>
      )}

      {/* -------------------- DAUM (ë‹¤ìŒ) ìœ„ì„ì¥ -------------------- */}
      {type === "daum" && (
        <div className="flex flex-col h-full">
          <h1 style={styles.title}>ìœ„ ì„ ì¥(ê°œì¸)</h1>

          <table style={styles.table}>
            <colgroup>
              <col style={{ width: "15%" }} /><col style={{ width: "20%" }} /><col style={{ width: "30%" }} /><col style={{ width: "15%" }} /><col style={{ width: "20%" }} />
            </colgroup>
            <tbody>
              <tr>
                <th style={styles.th} rowSpan={4}>ìœ„ì„ì¸</th>
                <th style={styles.th}>ì„±ëª…</th>
                <td style={styles.td}>
                    {artist.name} (ì¸)
                    {artist.signature_url && (
                        <div style={{position:'relative', display:'inline-block', width:'0', height:'0', overflow:'visible'}}>
                            <img src={artist.signature_url} alt="ì„œëª…" style={{position:'absolute', top:'-10px', left:'-20px', maxHeight:'30px', maxWidth:'60px'}} />
                        </div>
                    )}
                </td>
                <th style={styles.th}>ìƒë…„ì›”ì¼</th>
                <td style={styles.td}>{artist.birth_date?.replace(/-/g, '. ')}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì£¼ì†Œ</th>
                <td style={styles.td} colSpan={3}>{artist.address}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì „í™”ë²ˆí˜¸</th>
                <td style={styles.td} colSpan={3}>{artist.phone_mobile}</td>
              </tr>
              <tr>
                <th style={styles.th}>í”„ë¡œí•„ ì´ë¦„</th>
                <td style={styles.td} colSpan={3}>{artist.name}</td>
              </tr>
              <tr>
                <th style={styles.th}>ìœ„ì„ê¸°ê°„</th>
                <td style={styles.td} colSpan={4}>
                  <div style={{ padding: "5px 0" }}>
                    {startDate} ë¶€í„° &nbsp; {endDate} (ìµœì¥ 3ë…„ ì´ë‚´ë¡œ ê°€ëŠ¥)
                  </div>
                  <div style={{ fontSize: "8pt", color: "#666", lineHeight: "1.3" }}>
                    (â€» ê¸°í•œì„ ëª…ì‹œí•˜ì§€ ì•Šì•˜ê±°ë‚˜ 3ë…„ì´ ë„˜ëŠ” ê²½ìš°, ìœ„ì„ì¼ë¡œë¶€í„° 3ë…„ê°„ìœ¼ë¡œ ì¼ê´„ ì ìš©í•¨<br/>
                    â€» ìœ„ì„ê¸°ê°„ì€ ì¸ë¬¼ê²€ìƒ‰ ë“± axzì—ì„œ ìš´ì˜í•˜ëŠ” ì„œë¹„ìŠ¤ì— í”„ë¡œí•„ì •ë³´ê°€ ì‚¬ìš©ë˜ëŠ” ê¸°ê°„ê³¼ ìƒì´í•  ìˆ˜ ìˆìœ¼<br/>
                    ë©°, í”„ë¡œí•„ ì •ë³´ê°€ ì‚¬ìš© ë° ë³´ì¡´ë˜ëŠ” ê¸°ê°„ì€ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì— ë”°ë¦„)
                  </div>
                </td>
              </tr>
              <tr>
                <th style={styles.th}>ì´ìš©ì„œë¹„ìŠ¤</th>
                <td style={styles.td} colSpan={4}>ë§ˆì´í”„ë¡œí•„(ì¸ë¬¼ê²€ìƒ‰ í”„ë¡œí•„ ìˆ˜ì • ì„œë¹„ìŠ¤)</td>
              </tr>
            </tbody>
          </table>

          <div style={{ height: "20px" }}></div>

          <table style={styles.table}>
            <colgroup>
              <col style={{ width: "15%" }} /><col style={{ width: "20%" }} /><col style={{ width: "30%" }} /><col style={{ width: "15%" }} /><col style={{ width: "20%" }} />
            </colgroup>
            <tbody>
              <tr>
                <th style={styles.th} rowSpan={3}>ìˆ˜ì„ì¸<br/>(ëŒ€ë¦¬ì¸)</th>
                <th style={styles.th}>ì„±ëª…(ë²•ì¸ëª…)</th>
                <td style={styles.td}>{employee.full_name} (ì¸)</td>
                <th style={styles.th}>ìƒë…„ì›”ì¼<br/>(ë²•ì¸ì¸ ê²½ìš° ì‚¬ì—…<br/>ìë“±ë¡ë²ˆí˜¸)</th>
                <td style={styles.td}>{extraInfo.empBirth?.replace(/-/g, '. ')}</td>
              </tr>
              <tr>
                <th style={styles.th}>ì£¼ì†Œ</th>
                <td style={styles.td} colSpan={3}>{extraInfo.empAddress}</td>
              </tr>
              <tr>
                <th style={styles.th}>ìœ„ì„ì¸ê³¼ì˜<br/>ê´€ê³„</th>
                <td style={styles.td} colSpan={3}>{extraInfo.relation} ({tenantInfo.name})</td>
              </tr>
            </tbody>
          </table>

          <div style={{ fontSize: "10pt", lineHeight: "1.6", marginTop: "20px", marginBottom: "20px", textAlign: "justify" }}>
            ìƒê¸° ìœ„ì„ì¸ <u>&nbsp;&nbsp;{artist.name}&nbsp;&nbsp;</u> ì€ ì¸ë¬¼ê²€ìƒ‰ì„ í¬í•¨í•˜ì—¬, axzì—ì„œ ìš´ì˜í•˜ëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©ë˜
            ê²Œ í•  ëª©ì ìœ¼ë¡œ ìœ„ì„ì¸ì˜ í”„ë¡œí•„ ì •ë³´ë¥¼ <span style={{color:'red', fontWeight:'bold'}}>ë§ˆì´í”„ë¡œí•„(ì¸ë¬¼ê²€ìƒ‰ í”„ë¡œí•„ ë“±ë¡ ë° ìˆ˜ì • ì„œë¹„
            ìŠ¤)</span>ì„ í†µí•˜ì—¬ axzì— ì œê³µí•¨ê³¼ ê´€ë ¨í•œ ëª¨ë“  ê¶Œí•œ(ê°œì¸ì •ë³´ì˜ ì—´ëŒ, ì œê³µ, ë“±ë¡Â·ì •ì •Â·ì‚­ì œ, 
            ì²˜ë¦¬ì •ì§€ ìš”êµ¬ í¬í•¨)ì„ ìˆ˜ì„ì¸ <u>&nbsp;&nbsp;{employee.full_name}&nbsp;&nbsp;</u> ì—ê²Œ ìœ„ì„í•©ë‹ˆë‹¤. ìœ„ì„ ê¸°ê°„ ì¤‘ ìˆ˜ì„ì¸ì˜ ìš”ì²­ìœ¼
            ë¡œ ìˆ˜ì •, ë“±ë¡, ì‚­ì œë˜ëŠ” í”„ë¡œí•„ ì •ë³´ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¬¸ì œëŠ” ìœ„ì„ì¸ ë³¸ì¸ì´ ëª¨ë“  ì±…ì„
            ì„ ì§€ê³ , axzì— ë¯¼, í˜•ì‚¬ìƒ ì–´ë– í•œ ì´ì˜ë„ í•˜ì§€ ì•Šì„ ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.
          </div>

          <div style={{ fontSize: "10pt", fontWeight: "bold", marginBottom: "5px" }}>*ì§„ìœ„í™•ì¸ ë° ê´€ê³„ì¦ëª…ì„ ìœ„í•œ ì²¨ë¶€ì„œë¥˜</div>
          <table style={styles.table}>
            <colgroup>
              <col style={{ width: "15%" }} /><col style={{ width: "20%" }} /><col style={{ width: "20%" }} /><col style={{ width: "20%" }} /><col style={{ width: "25%" }} />
            </colgroup>
            <thead>
              <tr>
                <th style={styles.th}>êµ¬ë¶„</th>
                <th style={styles.th}>ë³¸ì¸(ìœ„ì„ì¸)</th>
                <th style={styles.th}>ê°€ì¡±</th>
                <th style={styles.th}>ì†Œì†ì‚¬</th>
                <th style={styles.th}>ê¸°íƒ€ëŒ€ë¦¬ì¸</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th style={{...styles.th, height: "80px"}}>ì²¨ë¶€ì„œë¥˜</th>
                <td style={styles.td}>-ì‹ ë¶„ì¦ ì‚¬ë³¸</td>
                <td style={styles.td}>-ìœ„ì„ì¸ì˜ ì‹ ë¶„ì¦<br/>ì‚¬ë³¸<br/>-ê°€ì¡±ê´€ê³„ì¦ëª…ì„œ<br/>ì™€ ì˜ë£Œë³´í—˜ì¦ ì‚¬<br/>ë³¸ ì¤‘ íƒ 1</td>
                <td style={styles.td}>-ìœ„ì„ì¸ì˜ ì‹ ë¶„ì¦<br/>ì‚¬ë³¸<br/>-ì‚¬ì—…ìë“±ë¡ì¦,<br/>ìˆ˜ì„ì¸ì˜ ì¬ì§ì¦<br/>ëª…ì„œ, ìœ„ì„ì¸ì˜<br/>ì¸ê°ì¦ëª…ì„œ<br/>ì¤‘ íƒ 1</td>
                <td style={styles.td}>-ìœ„ì„ì¸ì˜ ì‹ ë¶„ì¦<br/>ì‚¬ë³¸<br/>-ìœ„ì„ì¸ì˜ ì¸ê°ì¦<br/>ëª…ì„œ</td>
              </tr>
            </tbody>
          </table>

          <div style={{ marginTop: "40px", textAlign: "center", fontSize: "16pt" }}>
            <p style={{ marginBottom: "30px", fontWeight: "bold" }}>
              {year} ë…„ &nbsp; {month} ì›” &nbsp; {day} ì¼
            </p>
            <p style={{ fontSize: "18pt", fontWeight: "bold", position: 'relative', display: 'inline-block' }}>
              ìœ„ì„ì¸ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {artist.name} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ì¸)
              {artist.signature_url && (
                <img src={artist.signature_url} alt="ì„œëª…" style={{
                    position: "absolute",
                    right: "-20px",
                    top: "50%",
                    transform: "translateY(-50%)",
                    maxHeight: "50px",
                    maxWidth: "80px",
                    zIndex: 1
                }} />
              )}
            </p>
          </div>
        </div>
      )}

      {/* --- PAGE 2: ì¦ë¹™ ì„œë¥˜ (ìë™ ì²¨ë¶€) --- */}
      {type !== "certificate" && (
        <div className="flex flex-col page-break-before-always pt-10" style={{ pageBreakBefore: 'always', minHeight: "297mm" }}>
          <h2 style={{ fontSize: "18pt", fontWeight: "bold", borderBottom: "2px solid black", paddingBottom: "10px", marginBottom: "30px" }}>
            ì²¨ë¶€ ì„œë¥˜ (ì¦ë¹™)
          </h2>
          <div className="grid grid-cols-1 gap-10">
            <div style={{ border: "1px solid #ccc", padding: "20px", borderRadius: "10px" }}>
              <h3 style={{ fontSize: "14pt", fontWeight: "bold", marginBottom: "10px" }}>1. ìœ„ì„ì¸(ë°°ìš°) ì‹ ë¶„ì¦ ì‚¬ë³¸</h3>
              <div style={{ height: "300px", display: "flex", alignItems: "center", justifyContent: "center", border: "2px dashed #ddd" }}>
                {artist.id_card_masked_url || artist.id_card_url ? (
                  <img 
                    src={artist.id_card_masked_url || artist.id_card_url} 
                    style={{ maxHeight: "100%", maxWidth: "100%", objectFit: "contain" }} 
                    alt="Artist ID" 
                    crossOrigin="anonymous"
                  />
                ) : (
                  <span style={{ color: "#aaa" }}>ì‹ ë¶„ì¦ ì´ë¯¸ì§€ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</span>
                )}
              </div>
            </div>
            <div style={{ border: "1px solid #ccc", padding: "20px", borderRadius: "10px" }}>
              <h3 style={{ fontSize: "14pt", fontWeight: "bold", marginBottom: "10px" }}>2. ìˆ˜ì„ì¸(ëŒ€ë¦¬ì¸) ì‹ ë¶„ì¦ ì‚¬ë³¸</h3>
              <div style={{ height: "200px", display: "flex", alignItems: "center", justifyContent: "center", border: "2px dashed #ddd" }}>
                 <p style={{ color: "#aaa" }}>ì´ê³³ì— ëŒ€ë¦¬ì¸ ì‹ ë¶„ì¦ì„ ë¶€ì°©í•˜ì„¸ìš”.</p>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// --- Main Page Component ---
const ProfileManagement = () => {
  const { currentTenant } = useAuth();
  const [loading, setLoading] = useState(true);
  const [artists, setArtists] = useState<Artist[]>([]);
  const [employees, setEmployees] = useState<Employee[]>([]);
  const [tenantInfo, setTenantInfo] = useState<TenantInfo>({ name: "", rep_name: "", address: "" });
  
  const [selectedArtistId, setSelectedArtistId] = useState<string>("");
  const [selectedEmployeeId, setSelectedEmployeeId] = useState<string>("");
  
  const [extraInfo, setExtraInfo] = useState({
    empBirth: "",
    empAddress: "",
    relation: "ì†Œì†ì‚¬ ë‹´ë‹¹ì",
    date: new Date().toISOString().split('T')[0],
    usage: "í¬í„¸ ì‚¬ì´íŠ¸ ì¸ë¬¼ì •ë³´ ë“±ë¡ ë° ìˆ˜ì • ìš”ì²­"
  });

  const printRef = useRef<HTMLDivElement>(null);
  const [activeTab, setActiveTab] = useState<"naver" | "daum" | "certificate">("naver");

  useEffect(() => {
    const fetchData = async () => {
      if (!currentTenant) return;
      setLoading(true);
      
      const { data: artistData } = await supabase
        .from("artists")
        .select("id, name, birth_date, gender, phone_mobile, email, address, resident_number, id_card_url, id_card_masked_url, signature_url")
        .eq("tenant_id", currentTenant.tenant_id)
        .eq("is_active", true);

      const { data: memberData } = await supabase
        .from("tenant_memberships")
        .select(`
          user_id, role, department, job_title, created_at,
          profiles:user_id ( full_name, phone, email )
        `)
        .eq("tenant_id", currentTenant.tenant_id);

      const { data: tInfo } = await supabase
        .from("tenants")
        .select("name, rep_name, address")
        .eq("id", currentTenant.tenant_id)
        .single();

      if (artistData) setArtists(artistData as any);
      if (memberData) {
        const formattedEmployees = memberData.map((m: any) => ({
          id: m.user_id,
          full_name: m.profiles?.full_name,
          phone: m.profiles?.phone,
          email: m.profiles?.email,
          department: m.department,
          job_title: m.job_title,
          join_date: m.created_at
        }));
        setEmployees(formattedEmployees);
      }
      if (tInfo) setTenantInfo({ name: tInfo.name, rep_name: tInfo.rep_name || "", address: tInfo.address || "" });
      setLoading(false);
    };
    fetchData();
  }, [currentTenant]);

  const selectedArtist = artists.find(a => a.id === selectedArtistId) || null;
  const selectedEmployee = employees.find(e => e.id === selectedEmployeeId) || null;

  // [ì¸ì‡„ ê¸°ëŠ¥] ìˆœìˆ˜ JS + Base64 ì´ë¯¸ì§€ ë³€í™˜
  const handlePrint = async () => {
    const printContent = printRef.current;
    if (!printContent) {
      toast.error("ì¸ì‡„í•  ë‚´ìš©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      return;
    }

    const iframe = document.createElement("iframe");
    iframe.style.position = "absolute";
    iframe.style.width = "0px";
    iframe.style.height = "0px";
    iframe.style.border = "none";
    document.body.appendChild(iframe);

    // ìŠ¤íƒ€ì¼ ê°€ì ¸ì˜¤ê¸° (Tailwind ë“±)
    const styles = Array.from(document.querySelectorAll("style, link[rel='stylesheet']"))
      .map(node => node.outerHTML)
      .join("");

    const doc = iframe.contentWindow?.document;
    if (!doc) return;

    doc.open();
    doc.write(`
      <html>
        <head>
          <title>${selectedArtist?.name || 'ë¬¸ì„œ'}_${activeTab}_ìœ„ì„ì¥</title>
          <style>
            body { margin: 0; padding: 0; background: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            @page { size: A4; margin: 0; }
            .page-break-before-always { page-break-before: always; }
            /* Tailwind Reset ì¼ë¶€ ì ìš© */
            * { box-sizing: border-box; }
            table { width: 100%; border-collapse: collapse; }
            th, td { border: 1px solid black; padding: 5px; }
          </style>
        </head>
        <body>
          ${printContent.innerHTML}
          <script>
            window.onload = () => {
              setTimeout(() => {
                window.print();
              }, 800);
            };
          </script>
        </body>
      </html>
    `);
    doc.close();
    
    toast.success("PDF ìƒì„± ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
  };

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />
      <main className="pt-24 pb-16 px-4 max-w-7xl mx-auto">
        <div className="mb-8">
          <h1 className="text-3xl font-bold tracking-tight flex items-center gap-3">
            <User className="w-8 h-8 text-primary" /> ì¸ë¬¼ì •ë³´ ë“±ë¡ ê´€ë¦¬
          </h1>
          <p className="text-muted-foreground mt-1">
            ë„¤ì´ë²„, ë‹¤ìŒ(ì¹´ì¹´ì˜¤) ì¸ë¬¼ê²€ìƒ‰ ë“±ë¡ì„ ìœ„í•œ ìœ„ì„ì¥ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
          </p>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
          {/* Controls */}
          <div className="lg:col-span-4 space-y-6">
            <Card className="glass-card">
              <CardHeader>
                <CardTitle className="text-lg">1. ëŒ€ìƒ ì„ íƒ</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                {activeTab !== "certificate" && (
                  <div className="space-y-2">
                    <Label>ìœ„ì„ì¸ (ë°°ìš°/ì•„í‹°ìŠ¤íŠ¸)</Label>
                    <Select value={selectedArtistId} onValueChange={setSelectedArtistId}>
                      <SelectTrigger><SelectValue placeholder="ë°°ìš° ì„ íƒ" /></SelectTrigger>
                      <SelectContent>{artists.map(a => <SelectItem key={a.id} value={a.id}>{a.name}</SelectItem>)}</SelectContent>
                    </Select>
                  </div>
                )}
                <div className="space-y-2">
                  <Label>{activeTab === "certificate" ? "ë°œê¸‰ ëŒ€ìƒì (ì§ì›)" : "ìˆ˜ì„ì¸ (ë‹´ë‹¹ ë§¤ë‹ˆì €)"}</Label>
                  <Select value={selectedEmployeeId} onValueChange={setSelectedEmployeeId}>
                    <SelectTrigger><SelectValue placeholder="ì§ì› ì„ íƒ" /></SelectTrigger>
                    <SelectContent>{employees.map(e => <SelectItem key={e.id} value={e.id}>{e.full_name} ({e.department || "ì†Œì†"})</SelectItem>)}</SelectContent>
                  </Select>
                </div>
              </CardContent>
            </Card>

            <Card className="glass-card">
              <CardHeader>
                <CardTitle className="text-lg">2. ì¶”ê°€ ì •ë³´ ì…ë ¥</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="space-y-2">
                  <Label>ëŒ€ë¦¬ì¸ ìƒë…„ì›”ì¼</Label>
                  <Input 
                    type="date" 
                    value={extraInfo.empBirth} 
                    onChange={e => setExtraInfo({...extraInfo, empBirth: e.target.value})} 
                  />
                </div>
                <div className="space-y-2">
                  <Label>ëŒ€ë¦¬ì¸ ì£¼ì†Œ (íšŒì‚¬/ê°œì¸)</Label>
                  <Input 
                    placeholder="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬..." 
                    value={extraInfo.empAddress} 
                    onChange={e => setExtraInfo({...extraInfo, empAddress: e.target.value})} 
                  />
                </div>
                <div className="space-y-2">
                  <Label>ê´€ê³„</Label>
                  <Input 
                    value={extraInfo.relation} 
                    onChange={e => setExtraInfo({...extraInfo, relation: e.target.value})} 
                  />
                </div>
                
                <Button 
                  className="w-full mt-4" 
                  size="lg" 
                  onClick={handlePrint}
                  disabled={!selectedArtistId || !selectedEmployeeId}
                >
                  <Printer className="w-4 h-4 mr-2" /> ìœ„ì„ì¥ ì¸ì‡„ / PDF ì €ì¥
                </Button>
              </CardContent>
            </Card>
          </div>

          {/* Preview */}
          <div className="lg:col-span-8">
            <Tabs value={activeTab} onValueChange={(v: any) => setActiveTab(v)} className="w-full">
              <div className="flex items-center justify-between mb-4">
                <TabsList>
                  <TabsTrigger value="naver" className="w-24">ë„¤ì´ë²„</TabsTrigger>
                  <TabsTrigger value="daum" className="w-24">ë‹¤ìŒ</TabsTrigger>
                  <TabsTrigger value="certificate" className="w-32 gap-2"><FileCheck className="w-4 h-4" /> ì¬ì§ì¦ëª…ì„œ</TabsTrigger>
                </TabsList>
                <div className="flex gap-2">
                   <Badge variant="outline" className="gap-1"><CheckCircle2 className="w-3 h-3 text-green-500" /> ìë™ì™„ì„± ì ìš©ë¨</Badge>
                </div>
              </div>

              <div className="border rounded-xl bg-gray-100 p-8 overflow-auto max-h-[800px] shadow-inner">
                <div className="transform scale-90 origin-top">
                  <div className="bg-white shadow-xl mx-auto w-[210mm] min-h-[297mm]">
                     <PortalDocTemplate 
                        type={activeTab} 
                        artist={selectedArtist} 
                        employee={selectedEmployee} 
                        tenantInfo={tenantInfo}
                        extraInfo={extraInfo}
                     />
                  </div>
                </div>
              </div>
            </Tabs>
          </div>
        </div>

        <div className="hidden">
          <div ref={printRef}>
            <PortalDocTemplate 
              type={activeTab} 
              artist={selectedArtist} 
              employee={selectedEmployee} 
              tenantInfo={tenantInfo}
              extraInfo={extraInfo}
            />
          </div>
        </div>
      </main>
    </div>
  );
};

export default ProfileManagement;


============================================================
File Path: src/pages/SuperAdmin.tsx
============================================================
import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Separator } from "@/components/ui/separator";
import { supabase } from "@/integrations/supabase/client";
import { toast } from "sonner";
import {
  Building2, Search, Plus, Users, Settings, 
  ShieldCheck, Activity, Database, Server,
  ExternalLink, MoreHorizontal, Check, X, Loader2, Edit2, Trash2, Key,
  MessageSquareShare // ì•„ì´ì½˜ ì¶”ê°€ë¨
} from "lucide-react";
import {
  Select, SelectContent, SelectItem, SelectTrigger, SelectValue,
} from "@/components/ui/select";
import {
  DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger, DropdownMenuSeparator,
} from "@/components/ui/dropdown-menu";
import {
  AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle,
} from "@/components/ui/alert-dialog";

interface SignupRequest {
  id: string;
  user_id: string;
  company_name: string;
  status: "pending" | "approved" | "rejected";
  created_at: string;
  assigned_tenant_id: string | null;
  user_email?: string;
  user_name?: string;
}

const SuperAdmin = () => {
  const navigate = useNavigate();
  const [signupRequests, setSignupRequests] = useState<SignupRequest[]>([]);
  const [tenants, setTenants] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [selectedTenants, setSelectedTenants] = useState<Record<string, string>>({});
  const [processingIds, setProcessingIds] = useState<Set<string>>(new Set());
  const [deletingTenantId, setDeletingTenantId] = useState<string | null>(null);
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);

  // --- ë°ì´í„° Fetching (ê¸°ì¡´ ë¡œì§ 100% ìœ ì§€) ---
  const fetchData = async () => {
    try {
      const { data: requests } = await supabase
        .from("signup_requests")
        .select("*")
        .eq("status", "pending")
        .order("created_at", { ascending: false });

      if (requests && requests.length > 0) {
        const userIds = requests.map((r) => r.user_id);
        const { data: profiles } = await supabase
          .from("profiles")
          .select("id, email, full_name")
          .in("id", userIds);

        const enrichedRequests = requests.map((request) => {
          const profile = profiles?.find((p) => p.id === request.user_id);
          return { ...request, user_email: profile?.email, user_name: profile?.full_name };
        });
        setSignupRequests(enrichedRequests as SignupRequest[]);
      } else {
        setSignupRequests([]);
      }

      const { data: tenantsData, error: tenantError } = await supabase
        .from("tenants")
        .select("*")
        .order("created_at", { ascending: false });

      if (tenantError) throw tenantError;
      setTenants(tenantsData || []);
    } catch (error) {
      console.error("Error fetching data:", error);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchData();
    const tenantChannel = supabase.channel("tenants-realtime").on("postgres_changes", { event: "*", schema: "public", table: "tenants" }, () => fetchData()).subscribe();
    const requestChannel = supabase.channel("requests-realtime").on("postgres_changes", { event: "*", schema: "public", table: "signup_requests" }, () => fetchData()).subscribe();
    return () => { supabase.removeChannel(tenantChannel); supabase.removeChannel(requestChannel); };
  }, []);

  // --- í•¸ë“¤ëŸ¬ë“¤ (ê¸°ì¡´ ë¡œì§ 100% ìœ ì§€) ---
  const handleDeleteTenant = async () => {
    if (!deletingTenantId) return;
    try {
      const { error } = await supabase.from("tenants").delete().eq("id", deletingTenantId);
      if (error) throw error;
      toast.success("ê³ ê°ì‚¬ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
      setIsDeleteDialogOpen(false);
      fetchData();
    } catch (error: any) {
      toast.error("ì‚­ì œ ì‹¤íŒ¨: " + error.message);
    }
  };

  const handleApprove = async (request: SignupRequest) => {
    const tenantId = selectedTenants[request.id];
    if (!tenantId) { toast.error("ë°°ì •í•  íšŒì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"); return; }
    setProcessingIds((prev) => new Set(prev).add(request.id));
    try {
      await supabase.from("signup_requests").update({ status: "approved", assigned_tenant_id: tenantId, reviewed_at: new Date().toISOString() }).eq("id", request.id);
      await supabase.from("tenant_memberships").insert({ user_id: request.user_id, tenant_id: tenantId, role: "employee" });
      toast.success("ìŠ¹ì¸ ì™„ë£Œ");
      fetchData();
    } catch (error) { toast.error("ì˜¤ë¥˜ ë°œìƒ"); } 
    finally { setProcessingIds((prev) => { const next = new Set(prev); next.delete(request.id); return next; }); }
  };

  const handleReject = async (request: SignupRequest) => {
    setProcessingIds((prev) => new Set(prev).add(request.id));
    try {
      await supabase.from("signup_requests").update({ status: "rejected", reviewed_at: new Date().toISOString() }).eq("id", request.id);
      toast.success("ê±°ì ˆ ì™„ë£Œ");
      fetchData();
    } catch (error) { toast.error("ì˜¤ë¥˜ ë°œìƒ"); }
    finally { setProcessingIds((prev) => { const next = new Set(prev); next.delete(request.id); return next; }); }
  };

  return (
    <div className="min-h-screen bg-slate-50 text-foreground">
      <Header />

      <main className="pt-24 pb-16 px-4 max-w-[1600px] mx-auto space-y-8">
        
        {/* 1. ìƒë‹¨ í—¤ë” & ìš”ì•½ í†µê³„ */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
          <div className="md:col-span-4 mb-2">
            <h1 className="text-3xl font-black tracking-tight text-slate-900 flex items-center gap-2">
              <ShieldCheck className="w-8 h-8 text-primary" /> Super Admin Center
            </h1>
            <p className="text-slate-500 mt-1">Boteda OS ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœ ë° í…Œë„ŒíŠ¸ ê´€ë¦¬ ì½˜ì†”ì…ë‹ˆë‹¤.</p>
          </div>

          <Card className="shadow-sm border-l-4 border-l-blue-500">
            <CardHeader className="pb-2">
              <CardDescription>ì´ ê³ ê°ì‚¬ (Tenants)</CardDescription>
              <CardTitle className="text-3xl font-bold flex items-center gap-2">
                {tenants.length} <span className="text-sm font-normal text-muted-foreground">ê°œ ì‚¬</span>
              </CardTitle>
            </CardHeader>
          </Card>
          <Card className="shadow-sm border-l-4 border-l-amber-500">
            <CardHeader className="pb-2">
              <CardDescription>ê°€ì… ìŠ¹ì¸ ëŒ€ê¸°</CardDescription>
              <CardTitle className="text-3xl font-bold flex items-center gap-2 text-amber-600">
                {signupRequests.length} <span className="text-sm font-normal text-muted-foreground">ê±´</span>
              </CardTitle>
            </CardHeader>
          </Card>
          <Card className="shadow-sm border-l-4 border-l-green-500">
            <CardHeader className="pb-2">
              <CardDescription>ì‹œìŠ¤í…œ ìƒíƒœ</CardDescription>
              <CardTitle className="text-3xl font-bold flex items-center gap-2 text-green-600">
                Healthy <Activity className="w-5 h-5 animate-pulse" />
              </CardTitle>
            </CardHeader>
          </Card>
          <Card className="shadow-sm border-l-4 border-l-purple-500 bg-purple-50/50">
            <CardHeader className="pb-2">
              <CardDescription>ì´ë²ˆ ë‹¬ ì‹ ê·œ ê°€ì…</CardDescription>
              <CardTitle className="text-3xl font-bold text-purple-700">
                +2 <span className="text-sm font-normal text-muted-foreground">ê±´</span>
              </CardTitle>
            </CardHeader>
          </Card>
        </div>

        <Separator />

        {/* 2. ê´€ë¦¬ ë©”ë‰´ ê·¸ë¦¬ë“œ (ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ê´€ë¦¬ ì¶”ê°€ë¨) */}
        <div>
          <h2 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
            <Settings className="w-5 h-5" /> ê´€ë¦¬ ë„êµ¬ (Management Tools)
          </h2>
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {/* ê³ ê°ì‚¬ ì¶”ê°€ */}
            <div 
              onClick={() => navigate("/super-admin/tenants/new")}
              className="group bg-white p-5 rounded-xl border border-slate-200 hover:border-blue-500 hover:shadow-md transition-all cursor-pointer flex flex-col gap-3"
            >
              <div className="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 group-hover:scale-110 transition-transform">
                <Plus className="w-6 h-6" />
              </div>
              <div>
                <h3 className="font-bold text-slate-900">ìƒˆ ê³ ê°ì‚¬ ë“±ë¡</h3>
                <p className="text-xs text-slate-500 mt-1">ìƒˆë¡œìš´ í…Œë„ŒíŠ¸ë¥¼ ìƒì„±í•˜ê³  ì´ˆê¸° ì„¤ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤.</p>
              </div>
            </div>

            {/* ë¯¸ë””ì–´ ê´€ë¦¬ */}
            <div 
              onClick={() => navigate("/super-admin/press-contacts")}
              className="group bg-white p-5 rounded-xl border border-slate-200 hover:border-indigo-500 hover:shadow-md transition-all cursor-pointer flex flex-col gap-3"
            >
              <div className="w-10 h-10 rounded-lg bg-indigo-100 flex items-center justify-center text-indigo-600 group-hover:scale-110 transition-transform">
                <Users className="w-6 h-6" />
              </div>
              <div>
                <h3 className="font-bold text-slate-900">ë¯¸ë””ì–´ ì—°ë½ì²˜ ì„¼í„°</h3>
                <p className="text-xs text-slate-500 mt-1">ê³µìš© ê¸°ì DB ë° ì–¸ë¡ ì‚¬ ì—°ë½ë§ì„ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
              </div>
            </div>

            {/* [ì‹ ê·œ] ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ê´€ë¦¬ (ë™ì  ë©”ì‹œì§€ ì„¤ì •) */}
            <div 
              onClick={() => navigate("/super-admin/messages")}
              className="group bg-white p-5 rounded-xl border border-slate-200 hover:border-orange-500 hover:shadow-md transition-all cursor-pointer flex flex-col gap-3"
            >
              <div className="w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center text-orange-600 group-hover:scale-110 transition-transform">
                <MessageSquareShare className="w-6 h-6" />
              </div>
              <div>
                <h3 className="font-bold text-slate-900">ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ê´€ë¦¬</h3>
                <p className="text-xs text-slate-500 mt-1">SNS ê³µìœ  ì¹´ë“œ, ì´ë©”ì¼, ì•Œë¦¼ ë¬¸êµ¬ë¥¼ ë™ì ìœ¼ë¡œ ì œì–´í•©ë‹ˆë‹¤.</p>
              </div>
            </div>

            {/* API ê´€ë¦¬ */}
            <div 
              onClick={() => navigate("/super-admin/api-management")}
              className="group bg-white p-5 rounded-xl border border-slate-200 hover:border-purple-500 hover:shadow-md transition-all cursor-pointer flex flex-col gap-3"
            >
              <div className="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center text-purple-600 group-hover:scale-110 transition-transform">
                <Key className="w-6 h-6" />
              </div>
              <div>
                <h3 className="font-bold text-slate-900">ì‹œìŠ¤í…œ API ì„¤ì •</h3>
                <p className="text-xs text-slate-500 mt-1">AI í† í°, ê²°ì œ ëª¨ë“ˆ ë“± ì „ì—­ ì‹œìŠ¤í…œ í‚¤ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
              </div>
            </div>

            {/* ì„œë²„ ë¡œê·¸ (ì¤€ë¹„ ì¤‘) */}
            <div className="group bg-slate-50 p-5 rounded-xl border border-dashed border-slate-300 flex flex-col gap-3 opacity-60">
              <div className="w-10 h-10 rounded-lg bg-slate-200 flex items-center justify-center text-slate-500">
                <Server className="w-6 h-6" />
              </div>
              <div>
                <h3 className="font-bold text-slate-700">ì‹œìŠ¤í…œ ê°ì‚¬ ë¡œê·¸</h3>
                <p className="text-xs text-slate-500 mt-1">ì¤€ë¹„ ì¤‘ì¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤.</p>
              </div>
            </div>
          </div>
        </div>

        {/* 3. ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ (ê¸°ì¡´ ë¡œì§ ìœ ì§€) */}
        {signupRequests.length > 0 && (
          <div className="border-2 border-amber-400 bg-amber-50 rounded-xl overflow-hidden shadow-sm animate-in fade-in slide-in-from-bottom-2">
            <div className="p-4 bg-amber-100 border-b border-amber-200 flex items-center justify-between">
              <h3 className="font-bold text-amber-900 flex items-center gap-2">
                <Users className="w-5 h-5" /> ê°€ì… ìŠ¹ì¸ ìš”ì²­ ({signupRequests.length})
              </h3>
              <Badge className="bg-amber-500 hover:bg-amber-600">Action Required</Badge>
            </div>
            <div className="divide-y divide-amber-200/50">
              {signupRequests.map((request) => (
                <div key={request.id} className="p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                  <div>
                    <div className="font-bold text-slate-800">{request.user_name} ({request.user_email})</div>
                    <div className="text-sm text-slate-600 flex items-center gap-1 mt-1">
                      <Building2 className="w-3 h-3" /> ìš”ì²­ íšŒì‚¬ëª…: <span className="font-semibold text-amber-700">{request.company_name}</span>
                    </div>
                  </div>
                  <div className="flex items-center gap-2 bg-white p-2 rounded-lg shadow-sm border border-amber-200">
                    <Select onValueChange={(v) => setSelectedTenants((p) => ({ ...p, [request.id]: v }))}>
                      <SelectTrigger className="w-[180px] h-9 text-xs"><SelectValue placeholder="ì†Œì† íšŒì‚¬ ì„ íƒ" /></SelectTrigger>
                      <SelectContent>
                        {tenants.map((t) => <SelectItem key={t.id} value={t.id}>{t.name}</SelectItem>)}
                      </SelectContent>
                    </Select>
                    <Button size="sm" className="h-9 bg-green-600 hover:bg-green-700 text-white" onClick={() => handleApprove(request)} disabled={processingIds.has(request.id)}>
                      ìŠ¹ì¸
                    </Button>
                    <Button size="sm" variant="ghost" className="h-9 text-red-500 hover:bg-red-50 hover:text-red-700" onClick={() => handleReject(request)} disabled={processingIds.has(request.id)}>
                      ê±°ì ˆ
                    </Button>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* 4. ê³ ê°ì‚¬ ëª©ë¡ í…Œì´ë¸” (ê¸°ì¡´ ë¡œì§ ìœ ì§€) */}
        <div className="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
          <div className="p-5 border-b border-slate-100 flex flex-col sm:flex-row sm:items-center justify-between gap-4">
            <h2 className="text-lg font-bold flex items-center gap-2">
              <Building2 className="w-5 h-5 text-slate-500" /> ë“±ë¡ëœ ê³ ê°ì‚¬ ëª©ë¡
            </h2>
            <div className="relative w-full sm:w-72">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" />
              <Input placeholder="ê³ ê°ì‚¬ëª… ë˜ëŠ” ë„ë©”ì¸ ê²€ìƒ‰" className="pl-9 h-10 bg-slate-50 border-slate-200" />
            </div>
          </div>

          <div className="overflow-x-auto">
            <table className="w-full text-sm text-left">
              <thead className="text-xs text-slate-500 uppercase bg-slate-50 border-b border-slate-100">
                <tr>
                  <th className="px-6 py-4 font-semibold">ê³ ê°ì‚¬ ëª…</th>
                  <th className="px-6 py-4 font-semibold">ì ‘ì† ë„ë©”ì¸</th>
                  <th className="px-6 py-4 font-semibold text-center">ë“±ë¡ì¼</th>
                  <th className="px-6 py-4 font-semibold text-right">ê´€ë¦¬</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-slate-100">
                {tenants.map((tenant) => (
                  <tr key={tenant.id} className="hover:bg-slate-50/80 transition-colors">
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-3">
                        <div className="w-9 h-9 rounded-lg bg-blue-100 text-blue-600 flex items-center justify-center font-bold">
                          {tenant.name.substring(0, 1)}
                        </div>
                        <span className="font-semibold text-slate-700">{tenant.name}</span>
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-2">
                        <code className="px-2 py-1 bg-slate-100 rounded text-slate-600 font-mono text-xs border border-slate-200">
                          {tenant.domain || "-"}
                        </code>
                        {tenant.domain && <ExternalLink className="w-3 h-3 text-slate-400 cursor-pointer hover:text-blue-500" onClick={() => window.open(`https://${tenant.domain}`, "_blank")} />}
                      </div>
                    </td>
                    <td className="px-6 py-4 text-center text-slate-500">
                      {new Date(tenant.created_at).toLocaleDateString()}
                    </td>
                    <td className="px-6 py-4 text-right">
                      <DropdownMenu>
                        <DropdownMenuTrigger asChild>
                          <Button variant="ghost" size="sm" className="h-8 w-8 p-0"><MoreHorizontal className="w-4 h-4" /></Button>
                        </DropdownMenuTrigger>
                        <DropdownMenuContent align="end">
                          <DropdownMenuItem onClick={() => navigate(`/super-admin/tenants/edit/${tenant.id}`)}>
                            <Edit2 className="w-4 h-4 mr-2" /> ì •ë³´ ìˆ˜ì •
                          </DropdownMenuItem>
                          <DropdownMenuSeparator />
                          <DropdownMenuItem className="text-red-600 focus:text-red-600 focus:bg-red-50" onClick={() => { setDeletingTenantId(tenant.id); setIsDeleteDialogOpen(true); }}>
                            <Trash2 className="w-4 h-4 mr-2" /> ì‚­ì œ
                          </DropdownMenuItem>
                        </DropdownMenuContent>
                      </DropdownMenu>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      </main>

      {/* ì‚­ì œ í™•ì¸ Dialog (ê¸°ì¡´ ìœ ì§€) */}
      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="text-destructive font-bold">ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</AlertDialogTitle>
            <AlertDialogDescription>
              ê³ ê°ì‚¬ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ë©´ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì—°ê²°ëœ ëª¨ë“  ì‚¬ìš©ì ê³„ì •ê³¼ ë°ì´í„°ê°€ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>ì·¨ì†Œ</AlertDialogCancel>
            <AlertDialogAction onClick={handleDeleteTenant} className="bg-destructive hover:bg-destructive/90">ì‚­ì œ í™•ì •</AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
};

export default SuperAdmin;


============================================================
File Path: src/pages/TenantRegistration.tsx
============================================================
import { useState, useEffect } from "react";
import { useNavigate, useParams } from "react-router-dom";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { Switch } from "@/components/ui/switch";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";
import { Badge } from "@/components/ui/badge";
import { 
  Globe, 
  FileText, 
  User, 
  Users, 
  Calendar as CalendarIcon, 
  MapPin, 
  Mail, 
  ArrowLeft,
  Save,
  Loader2,
  Info
} from "lucide-react";
import { toast } from "sonner";
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from "@/components/ui/tooltip";

const TenantRegistration = () => {
  const navigate = useNavigate();
  const { id } = useParams();
  const isEditMode = !!id;

  const [loading, setLoading] = useState(false);
  const [fetching, setFetching] = useState(isEditMode);
  const [isJointRep, setIsJointRep] = useState(false);
  const [members, setMembers] = useState<any[]>([]);

  const [formData, setFormData] = useState({
    name: "",
    domain_prefix: "",
    biz_number: "",
    corp_number: "",
    rep_name: "",
    opening_date: "",
    tax_email: "",
    biz_type: "",
    biz_item: "",
    address: "",
  });

  useEffect(() => {
    if (isEditMode) {
      const getTenantAndMembers = async () => {
        try {
          // 1. ê³ ê°ì‚¬ ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
          const { data: tenant, error: tenantError } = await supabase
            .from("tenants")
            .select("*")
            .eq("id", id)
            .single();

          if (tenantError) throw tenantError;

          // 2. ì†Œì† ì„ì§ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (ê´€ê³„ ëª¨í˜¸ì„± í•´ê²°ì„ ìœ„í•´ user_id ëª…ì‹œ)
          const { data: memberData, error: memberError } = await supabase
            .from("tenant_memberships")
            .select(`
              id,
              role,
              department,
              job_title,
              profiles:user_id (
                id,
                full_name,
                email,
                avatar_url
              )
            `)
            .eq("tenant_id", id);

          if (memberError) throw memberError;

          if (tenant) {
            const prefix = tenant.domain?.split(".")[0] || "";
            setFormData({
              name: tenant.name || "",
              domain_prefix: prefix,
              biz_number: tenant.biz_number || "",
              corp_number: tenant.corp_number || "",
              rep_name: tenant.rep_name || "",
              opening_date: tenant.opening_date || "",
              tax_email: tenant.tax_email || "",
              biz_type: tenant.biz_type || "",
              biz_item: tenant.biz_item || "",
              address: tenant.address || "",
            });
            if (tenant.rep_name?.includes(",")) setIsJointRep(true);
          }

          if (memberData) {
            setMembers(memberData);
          }
        } catch (error: any) {
          console.error("Fetch error:", error);
          toast.error("ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        } finally {
          setFetching(false);
        }
      };

      getTenantAndMembers();
    }
  }, [id, isEditMode, navigate]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);

    try {
      const fullDomain = formData.domain_prefix 
        ? `${formData.domain_prefix.toLowerCase()}.boteda.com` 
        : null;

      const payload = {
        name: formData.name,
        domain: fullDomain,
        biz_number: formData.biz_number,
        corp_number: formData.corp_number,
        rep_name: formData.rep_name,
        opening_date: formData.opening_date,
        tax_email: formData.tax_email,
        biz_type: formData.biz_type,
        biz_item: formData.biz_item,
        address: formData.address,
      };

      if (isEditMode) {
        const { error } = await supabase.from("tenants").update(payload).eq("id", id);
        if (error) throw error;
        toast.success("ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
      } else {
        const { error } = await supabase.from("tenants").insert([payload]);
        if (error) throw error;
        toast.success("ìƒˆ ê³ ê°ì‚¬ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }
      navigate("/super-admin");
    } catch (error: any) {
      toast.error("ì €ì¥ ì‹¤íŒ¨: " + error.message);
    } finally {
      setLoading(false);
    }
  };

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    const { id, value } = e.target;
    setFormData(prev => ({ ...prev, [id]: value }));
  };

  if (fetching) {
    return <div className="min-h-screen flex items-center justify-center"><Loader2 className="animate-spin text-primary w-10 h-10" /></div>;
  }

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />
      <main className="pt-24 pb-16 px-4">
        <div className="max-w-4xl mx-auto">
          <button onClick={() => navigate("/super-admin")} className="flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6 transition-colors">
            <ArrowLeft className="w-4 h-4" /> ìŠˆí¼ ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°
          </button>

          <div className="mb-8">
            <h1 className="text-3xl font-bold tracking-tight">
              ê³ ê°ì‚¬ ì •ë³´ ìˆ˜ì •
            </h1>
            <p className="text-muted-foreground">í…Œë„ŒíŠ¸ ì¸í”„ë¼ ë° ì‚¬ì—…ì ì„¸ë¶€ ì •ë³´ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
          </div>

          <form onSubmit={handleSubmit} className="space-y-8">
            {/* 1. ì‹œìŠ¤í…œ ì ‘ì† ì •ë³´ */}
            <Card className="glass-card border-primary/20 shadow-lg">
              <CardHeader>
                <CardTitle className="flex items-center gap-2 text-lg">
                  <Globe className="w-5 h-5 text-primary" /> ì‹œìŠ¤í…œ ì ‘ì† ì •ë³´
                </CardTitle>
              </CardHeader>
              <CardContent className="grid md:grid-cols-2 gap-6">
                <div className="space-y-2">
                  <Label htmlFor="name">íšŒì‚¬ ì‹ë³„ ì´ë¦„ (ë‚´ë¶€ìš©)</Label>
                  <Input id="name" value={formData.name} onChange={handleChange} required />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="domain_prefix">ì ‘ì† ì„œë¸Œë„ë©”ì¸</Label>
                  <div className="flex items-center">
                    <Input id="domain_prefix" value={formData.domain_prefix} onChange={handleChange} className="rounded-r-none border-r-0" required />
                    <span className="bg-secondary px-3 h-10 flex items-center border border-input rounded-r-md text-sm">.boteda.com</span>
                  </div>
                </div>
              </CardContent>
            </Card>

            {/* 2. ì„ì§ì› í˜„í™© ì„¹ì…˜ */}
            <Card className="glass-card shadow-md border-accent/20">
              <CardHeader>
                <CardTitle className="flex items-center gap-2 text-lg">
                  <Users className="w-5 h-5 text-accent" /> ì†Œì† ì„ì§ì› í˜„í™©
                </CardTitle>
                <CardDescription>í˜„ì¬ ì´ ê³ ê°ì‚¬ì— ë“±ë¡ëœ ì´ {members.length}ëª…ì˜ ì¸ë ¥ì…ë‹ˆë‹¤. ëŒ€í‘œ ê´€ë¦¬ìëŠ” íšŒì‚¬ ê´€ë¦¬ ë©”ë‰´ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  {members.length > 0 ? (
                    members.map((member) => (
                      <div key={member.id} className="flex items-center justify-between p-3 rounded-lg bg-secondary/30 border border-border/50">
                        <div className="flex items-center gap-4">
                          <Avatar>
                            <AvatarImage src={member.profiles?.avatar_url} />
                            <AvatarFallback className="bg-primary/10 text-primary">
                              {member.profiles?.full_name?.substring(0, 1) || "U"}
                            </AvatarFallback>
                          </Avatar>
                          <div>
                            <div className="text-sm font-bold flex items-center gap-2">
                              {member.profiles?.full_name}
                              <Badge variant={member.role === 'company_admin' ? 'default' : 'secondary'} className="text-[10px] h-4">
                                {member.role === 'company_admin' ? 'ëŒ€í‘œ ê´€ë¦¬ì' : member.role === 'manager' ? 'ë§¤ë‹ˆì €' : 'ì‚¬ì›'}
                              </Badge>
                            </div>
                            <div className="text-xs text-muted-foreground">{member.profiles?.email}</div>
                          </div>
                        </div>
                        <div className="flex items-center gap-3">
                          <div className="text-right hidden sm:block">
                            <div className="text-xs font-medium">{member.department || "ë¶€ì„œ ë¯¸ì§€ì •"}</div>
                            <div className="text-[11px] text-muted-foreground">{member.job_title || "ì§í•¨ ë¯¸ì§€ì •"}</div>
                          </div>
                          {member.role !== 'company_admin' ? (
                            <Button 
                              type="button"
                              variant="outline" 
                              size="sm"
                              onClick={async () => {
                                try {
                                  const { error } = await supabase
                                    .from("tenant_memberships")
                                    .update({ role: 'company_admin' })
                                    .eq("id", member.id);
                                  if (error) throw error;
                                  toast.success(`${member.profiles?.full_name}ë‹˜ì„ ëŒ€í‘œ ê´€ë¦¬ìë¡œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.`);
                                  setMembers(prev => prev.map(m => 
                                    m.id === member.id ? { ...m, role: 'company_admin' } : m
                                  ));
                                } catch (error: any) {
                                  toast.error("ê¶Œí•œ ë³€ê²½ ì‹¤íŒ¨: " + error.message);
                                }
                              }}
                            >
                              ê´€ë¦¬ì ì§€ì •
                            </Button>
                          ) : (
                            <Button 
                              type="button"
                              variant="ghost" 
                              size="sm"
                              className="text-destructive hover:text-destructive"
                              onClick={async () => {
                                try {
                                  const { error } = await supabase
                                    .from("tenant_memberships")
                                    .update({ role: 'employee' })
                                    .eq("id", member.id);
                                  if (error) throw error;
                                  toast.success(`${member.profiles?.full_name}ë‹˜ì˜ ê´€ë¦¬ì ê¶Œí•œì„ í•´ì œí–ˆìŠµë‹ˆë‹¤.`);
                                  setMembers(prev => prev.map(m => 
                                    m.id === member.id ? { ...m, role: 'employee' } : m
                                  ));
                                } catch (error: any) {
                                  toast.error("ê¶Œí•œ ë³€ê²½ ì‹¤íŒ¨: " + error.message);
                                }
                              }}
                            >
                              ê¶Œí•œ í•´ì œ
                            </Button>
                          )}
                        </div>
                      </div>
                    ))
                  ) : (
                    <div className="text-center py-8 text-muted-foreground text-sm">ë“±ë¡ëœ ì„ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                  )}
                </div>
              </CardContent>
            </Card>

            {/* 3. ì‚¬ì—…ì ë“±ë¡ ì •ë³´ */}
            <Card className="glass-card shadow-md">
              <CardHeader className="pb-4">
                <div className="flex items-center justify-between">
                  <CardTitle className="flex items-center gap-2 text-lg">
                    <FileText className="w-5 h-5 text-primary" /> ì‚¬ì—…ì ë“±ë¡ ì •ë³´
                  </CardTitle>
                  <div className="flex items-center gap-2 bg-secondary/50 px-3 py-1.5 rounded-full border border-border">
                    <Label htmlFor="joint-rep-switch" className="text-xs cursor-pointer">ê³µë™ëŒ€í‘œ ì—¬ë¶€</Label>
                    <Switch id="joint-rep-switch" checked={isJointRep} onCheckedChange={setIsJointRep} />
                  </div>
                </div>
              </CardHeader>
              <CardContent className="space-y-6">
                <div className="grid md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="biz_number">ë“±ë¡ë²ˆí˜¸ (ì‚¬ì—…ìë²ˆí˜¸)</Label>
                    <Input id="biz_number" value={formData.biz_number} onChange={handleChange} placeholder="000-00-00000" />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="rep_name">ëŒ€í‘œì ì„±ëª…</Label>
                    <div className="relative">
                      {isJointRep ? <Users className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-primary" /> : <User className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />}
                      <Input id="rep_name" value={formData.rep_name} onChange={handleChange} className="pl-10" placeholder={isJointRep ? "ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„ ì…ë ¥" : "ì„±í•¨ ì…ë ¥"} />
                    </div>
                  </div>
                </div>

                <div className="grid md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="corp_number">ë²•ì¸ë“±ë¡ë²ˆí˜¸</Label>
                    <Input id="corp_number" value={formData.corp_number} onChange={handleChange} placeholder="000000-0000000" />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="opening_date">ê°œì—…ì—°ì›”ì¼</Label>
                    <Input id="opening_date" value={formData.opening_date} onChange={handleChange} type="date" />
                  </div>
                </div>

                <div className="grid md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="tax_email">ì „ìì„¸ê¸ˆê³„ì‚°ì„œ ì´ë©”ì¼</Label>
                    <Input id="tax_email" value={formData.tax_email} onChange={handleChange} type="email" placeholder="tax@company.com" />
                  </div>
                  <div className="grid grid-cols-2 gap-3">
                    <div className="space-y-2">
                      <Label htmlFor="biz_type">ì—…íƒœ</Label>
                      <Input id="biz_type" value={formData.biz_type} onChange={handleChange} placeholder="ì„œë¹„ìŠ¤ì—…" />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="biz_item">ì¢…ëª©</Label>
                      <Input id="biz_item" value={formData.biz_item} onChange={handleChange} placeholder="ê´‘ê³  ëŒ€í–‰" />
                    </div>
                  </div>
                </div>

                <div className="space-y-2">
                  <Label htmlFor="address">ì‚¬ì—…ì¥ ì†Œì¬ì§€</Label>
                  <Textarea id="address" value={formData.address} onChange={handleChange} className="min-h-[80px]" placeholder="ì‚¬ì—…ì¥ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”." />
                </div>
              </CardContent>
            </Card>

            <div className="flex items-center justify-end gap-4 pt-4 border-t border-border">
              <Button type="button" variant="ghost" onClick={() => navigate("/super-admin")}>ì·¨ì†Œ</Button>
              <Button type="submit" variant="hero" size="xl" disabled={loading} className="px-12">
                {loading ? <Loader2 className="mr-2 h-5 w-5 animate-spin" /> : <Save className="mr-2 h-5 w-5" />}
                {isEditMode ? "ìˆ˜ì • ì™„ë£Œ" : "ê³ ê°ì‚¬ ë“±ë¡ ì™„ë£Œ"}
              </Button>
            </div>
          </form>
        </div>
      </main>
    </div>
  );
};

export default TenantRegistration;


============================================================
File Path: src/pages/admin/ArtistManagement.tsx
============================================================
import { useState, useEffect, useRef } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
// import { useReactToPrint } from "react-to-print"; // [ì‚­ì œ] ì˜¤ë¥˜ ì›ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œê±°
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { Card, CardContent } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Separator } from "@/components/ui/separator";
import { ScrollArea } from "@/components/ui/scroll-area";
import {
  Sheet, SheetContent, SheetHeader, SheetTitle, SheetFooter, SheetClose
} from "@/components/ui/sheet";
import {
  Select, SelectContent, SelectItem, SelectTrigger, SelectValue
} from "@/components/ui/select";
import {
  AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent,
  AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { Switch } from "@/components/ui/switch";
import { toast } from "sonner";
import {
  UserCircle, Plus, Search, Loader2, Save, Edit2, Trash2, AlertCircle, Star, 
  Calendar, Globe, Instagram, Youtube, FileImage, UploadCloud, User, Printer, Mail, Phone
} from "lucide-react";

// --- Types ---
interface Artist {
  id: string;
  tenant_id: string;
  name: string;
  stage_name: string | null;
  birth_date: string | null;
  gender: string | null;
  bio: string | null;
  is_active: boolean;
  
  // Contact Info
  email: string | null;
  contact_phone: string | null;

  // Additional Info
  resident_number: string | null;
  address: string | null;
  contract_start_date: string | null;
  contract_end_date: string | null;
  namuwiki_url: string | null;
  instagram_url: string | null;
  youtube_url: string | null;
  
  // Images (URLs)
  profile_image_url: string | null;
  id_card_url: string | null;
  id_card_masked_url: string | null;
  signature_url: string | null;
}

// --- A4 Document Component (ì¸ì‡„ìš©) ---
const ArtistProfileDocument = ({ data, tenantName }: { data: any, tenantName: string }) => {
  return (
    <div className="w-[210mm] min-h-[297mm] p-[15mm] bg-white text-black font-sans box-border flex flex-col relative" style={{ printColorAdjust: 'exact', WebkitPrintColorAdjust: 'exact' }}>
      {/* 1. Header */}
      <div className="border-b-2 border-black pb-4 mb-6 flex justify-between items-end">
        <div>
          <h1 className="text-3xl font-black tracking-tight mb-1">ARTIST PROFILE</h1>
          <p className="text-sm font-bold text-gray-600 tracking-widest">{tenantName?.toUpperCase()}</p>
        </div>
        <div className="text-right">
          <p className="text-xs text-gray-400">Printed: {new Date().toLocaleDateString()}</p>
        </div>
      </div>

      {/* 2. Top Section: Photo & Basic Info */}
      <div className="flex gap-6 mb-6">
        {/* Profile Photo */}
        <div className="w-[60mm] h-[80mm] bg-gray-100 border border-gray-300 flex items-center justify-center overflow-hidden rounded-sm shrink-0 shadow-sm">
          {data.profile_image_url ? (
            <img src={data.profile_image_url} alt="Profile" className="w-full h-full object-cover" />
          ) : (
            <span className="text-gray-400 text-xs">ì‚¬ì§„ ì—†ìŒ</span>
          )}
        </div>

        {/* Basic Info Table */}
        <div className="flex-1">
          <table className="w-full text-sm border-collapse border-t-2 border-black">
            <tbody>
              <tr className="border-b border-gray-300">
                <th className="text-left py-3 px-2 w-28 bg-gray-50 font-bold border-r border-gray-200">ì„±ëª… (ë³¸ëª…)</th>
                <td className="py-3 px-4 font-bold text-lg">{data.name}</td>
              </tr>
              <tr className="border-b border-gray-300">
                <th className="text-left py-3 px-2 bg-gray-50 font-bold border-r border-gray-200">í™œë™ëª… (ì˜ˆëª…)</th>
                <td className="py-3 px-4 text-base">{data.stage_name || "-"}</td>
              </tr>
              <tr className="border-b border-gray-300">
                <th className="text-left py-3 px-2 bg-gray-50 font-bold border-r border-gray-200">ìƒë…„ì›”ì¼ / ì„±ë³„</th>
                <td className="py-3 px-4">{data.birth_date} / {data.gender === 'male' ? 'ë‚¨ì„±' : data.gender === 'female' ? 'ì—¬ì„±' : 'ê¸°íƒ€'}</td>
              </tr>
              <tr className="border-b border-gray-300">
                <th className="text-left py-3 px-2 bg-gray-50 font-bold border-r border-gray-200">ì—°ë½ì²˜</th>
                <td className="py-3 px-4">
                  <div>HP: {data.contact_phone || "-"}</div>
                  <div>Email: {data.email || "-"}</div>
                </td>
              </tr>
              <tr className="border-b border-gray-300">
                <th className="text-left py-3 px-2 bg-gray-50 font-bold border-r border-gray-200">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th>
                <td className="py-3 px-4 font-mono tracking-wider">{data.resident_number || "-"}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      {/* 3. Detail Info Grid */}
      <div className="mb-8">
        <h3 className="text-sm font-bold border-l-4 border-black pl-2 mb-2 uppercase">ìƒì„¸ ì •ë³´ (Details)</h3>
        <table className="w-full text-sm border-t border-black border-b border-black">
          <tbody>
            <tr className="border-b border-gray-200">
              <th className="py-3 px-3 bg-gray-50 w-32 text-left font-bold border-r border-gray-200 align-top">ê±°ì£¼ì§€ ì£¼ì†Œ</th>
              <td className="py-3 px-4" colSpan={3}>{data.address || "-"}</td>
            </tr>
            <tr className="border-b border-gray-200">
              <th className="py-3 px-3 bg-gray-50 text-left font-bold border-r border-gray-200">ì „ì†ê³„ì•½ ê¸°ê°„</th>
              <td className="py-3 px-4 font-mono" colSpan={3}>
                {data.contract_start_date || "ë¯¸ì •"} ~ {data.contract_end_date || "ë¯¸ì •"}
              </td>
            </tr>
            <tr className="border-b border-gray-200">
              <th className="py-3 px-3 bg-gray-50 text-left font-bold border-r border-gray-200 align-top">ì†Œì…œ/ì™¸ë¶€ ë§í¬</th>
              <td className="py-3 px-4 text-xs space-y-1" colSpan={3}>
                <div className="flex items-center gap-2">
                  <span className="font-bold w-20 text-gray-500">Instagram</span>
                  <span className="font-mono">{data.instagram_url || "-"}</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="font-bold w-20 text-gray-500">YouTube</span>
                  <span className="font-mono">{data.youtube_url || "-"}</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="font-bold w-20 text-gray-500">ë‚˜ë¬´ìœ„í‚¤</span>
                  <span className="font-mono">{data.namuwiki_url || "-"}</span>
                </div>
              </td>
            </tr>
            <tr>
              <th className="py-3 px-3 bg-gray-50 text-left font-bold border-r border-gray-200 align-top h-32">ì†Œê°œ (Bio)</th>
              <td className="py-3 px-4 align-top" colSpan={3}>
                <p className="whitespace-pre-wrap leading-relaxed text-gray-800 text-xs">{data.bio || "-"}</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      {/* 4. Attachments (Images) - ì§ë ¬(Vertical) ë°°ì¹˜ */}
      <div className="mt-4">
        <h3 className="text-sm font-bold border-l-4 border-black pl-2 mb-4 uppercase">ì¦ë¹™ ë° ì„œëª… (Documents)</h3>
        <div className="flex flex-col gap-8">
          <div className="break-inside-avoid">
            <span className="text-sm font-bold text-black mb-2 block border-b pb-1">1. ì‹ ë¶„ì¦ ì›ë³¸ (ë³´ì•ˆìš©)</span>
            <div className="w-full h-[80mm] bg-gray-50 border border-gray-300 rounded flex items-center justify-center overflow-hidden">
              {data.id_card_url ? (
                <img src={data.id_card_url} className="h-full w-auto object-contain max-w-full" alt="ID Card" />
              ) : (
                <span className="text-gray-300 text-sm">ì´ë¯¸ì§€ ë¯¸ë“±ë¡</span>
              )}
            </div>
          </div>
          <div className="break-inside-avoid">
            <span className="text-sm font-bold text-black mb-2 block border-b pb-1">2. ì‹ ë¶„ì¦ (ë§ˆìŠ¤í‚¹ìš©)</span>
            <div className="w-full h-[80mm] bg-gray-50 border border-gray-300 rounded flex items-center justify-center overflow-hidden">
              {data.id_card_masked_url ? (
                <img src={data.id_card_masked_url} className="h-full w-auto object-contain max-w-full" alt="Masked ID" />
              ) : (
                <span className="text-gray-300 text-sm">ì´ë¯¸ì§€ ë¯¸ë“±ë¡</span>
              )}
            </div>
          </div>
          <div className="break-inside-avoid">
            <span className="text-sm font-bold text-black mb-2 block border-b pb-1">3. ìí•„ ì„œëª…</span>
            <div className="w-full h-[50mm] bg-white border border-gray-300 rounded flex items-center justify-center overflow-hidden">
              {data.signature_url ? (
                <img src={data.signature_url} className="h-full w-auto object-contain max-w-full p-4" alt="Signature" />
              ) : (
                <span className="text-gray-300 text-sm">ì´ë¯¸ì§€ ë¯¸ë“±ë¡</span>
              )}
            </div>
          </div>
        </div>
      </div>
      
      {/* Footer */}
      <div className="mt-8 pt-4 border-t-2 border-gray-200 text-center">
        <p className="text-[10px] text-gray-500">ë³¸ ë¬¸ì„œëŠ” {tenantName}ì˜ ë‚´ë¶€ ë³´ì•ˆ ë¬¸ì„œì…ë‹ˆë‹¤. ì™¸ë¶€ ìœ ì¶œì„ ì—„ê²©íˆ ê¸ˆì§€í•©ë‹ˆë‹¤.</p>
        <p className="text-[10px] text-gray-400 mt-1">System Generated by Boteda OS</p>
      </div>
    </div>
  );
};


// --- Main Component ---
const ArtistManagement = () => {
  const { currentTenant, isCompanyAdmin, isSuperAdmin } = useAuth();
  const [artists, setArtists] = useState<Artist[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState("");

  const [isSheetOpen, setIsSheetOpen] = useState(false);
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [currentArtist, setCurrentArtist] = useState<Artist | null>(null);
  const [isSaving, setIsSaving] = useState(false);

  // Print Ref
  const printRef = useRef<HTMLDivElement>(null);

  // Refs for file inputs
  const profileInputRef = useRef<HTMLInputElement>(null);
  const idCardInputRef = useRef<HTMLInputElement>(null);
  const idMaskedInputRef = useRef<HTMLInputElement>(null);
  const signatureInputRef = useRef<HTMLInputElement>(null);

  const [formData, setFormData] = useState({
    name: "",
    stage_name: "",
    birth_date: "",
    gender: "",
    bio: "",
    is_active: true,
    email: "",
    contact_phone: "",
    resident_number: "",
    address: "",
    contract_start_date: "",
    contract_end_date: "",
    namuwiki_url: "",
    instagram_url: "",
    youtube_url: "",
    profile_image_url: "",
    id_card_url: "",
    id_card_masked_url: "",
    signature_url: "",
  });

  // [ìˆ˜ì •] ìˆœìˆ˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì¸ì‡„ ê¸°ëŠ¥ (ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œê±°)
  const handlePrint = () => {
    const printContent = printRef.current;
    if (!printContent) {
      toast.error("ì¸ì‡„í•  ë‚´ìš©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      return;
    }

    const iframe = document.createElement("iframe");
    iframe.style.position = "absolute";
    iframe.style.width = "0px";
    iframe.style.height = "0px";
    iframe.style.border = "none";
    document.body.appendChild(iframe);

    // ìŠ¤íƒ€ì¼ ê°€ì ¸ì˜¤ê¸°
    const styles = Array.from(document.querySelectorAll("style, link[rel='stylesheet']"))
      .map(node => node.outerHTML)
      .join("");

    const doc = iframe.contentWindow?.document;
    if (!doc) return;

    doc.open();
    doc.write(`
      <html>
        <head>
          <title>${formData.name}_Profile_Card</title>
          ${styles}
          <style>
            body { margin: 0; padding: 0; background: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            @page { size: A4; margin: 10mm; }
            /* ì´ë¯¸ì§€ ì¤„ë°”ê¿ˆ ë°©ì§€ */
            .break-inside-avoid { break-inside: avoid; page-break-inside: avoid; }
          </style>
        </head>
        <body>
          ${printContent.innerHTML}
          <script>
            window.onload = () => {
              setTimeout(() => {
                window.print();
                // iframe ì œê±° ë¡œì§ì€ ìƒëµ (ì‚¬ìš©ì ê²½í—˜ìƒ ìœ ì§€í•´ë„ ë¬´ë°©)
              }, 800);
            };
          </script>
        </body>
      </html>
    `);
    doc.close();
    
    toast.success("PDF ìƒì„± ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
  };

  const fetchArtists = async () => {
    if (!currentTenant) return;
    setLoading(true);

    let query = supabase
      .from("artists")
      .select("*")
      .eq("tenant_id", currentTenant.tenant_id)
      .order("name");

    if (searchQuery) {
      query = query.or(`name.ilike.%${searchQuery}%,stage_name.ilike.%${searchQuery}%`);
    }

    const { data, error } = await query;
    if (error) {
      toast.error("ë°°ìš° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    } else {
      setArtists((data || []) as Artist[]);
    }
    setLoading(false);
  };

  useEffect(() => {
    fetchArtists();
  }, [currentTenant, searchQuery]);

  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>, fieldName: string) => {
    const file = e.target.files?.[0];
    if (!file) return;
    const fakeUrl = URL.createObjectURL(file);
    setFormData(prev => ({ ...prev, [fieldName]: fakeUrl }));
    toast.success(`${file.name} íŒŒì¼ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.`);
  };

  const handleSave = async () => {
    if (!formData.name || !currentTenant) {
      toast.error("ì´ë¦„ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.");
      return;
    }
    setIsSaving(true);

    try {
      const payload = {
        tenant_id: currentTenant.tenant_id,
        name: formData.name,
        stage_name: formData.stage_name || null,
        birth_date: formData.birth_date || null,
        gender: formData.gender || null,
        bio: formData.bio || null,
        is_active: formData.is_active,
        email: formData.email || null,
        contact_phone: formData.contact_phone || null,
        resident_number: formData.resident_number || null,
        address: formData.address || null,
        contract_start_date: formData.contract_start_date || null,
        contract_end_date: formData.contract_end_date || null,
        namuwiki_url: formData.namuwiki_url || null,
        instagram_url: formData.instagram_url || null,
        youtube_url: formData.youtube_url || null,
        profile_image_url: formData.profile_image_url || null,
        id_card_url: formData.id_card_url || null,
        id_card_masked_url: formData.id_card_masked_url || null,
        signature_url: formData.signature_url || null,
      };

      if (currentArtist) {
        const { error } = await supabase
          .from("artists")
          .update(payload)
          .eq("id", currentArtist.id);
        if (error) throw error;
        toast.success("ë°°ìš° ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
      } else {
        const { error } = await supabase
          .from("artists")
          .insert(payload);
        if (error) throw error;
        toast.success("ë°°ìš°ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }
      setIsSheetOpen(false);
      fetchArtists();
    } catch (error: any) {
      toast.error(`ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setIsSaving(false);
    }
  };

  const handleDelete = async () => {
    if (!currentArtist) return;
    setIsSaving(true);
    try {
      const { error } = await supabase
        .from("artists")
        .delete()
        .eq("id", currentArtist.id);
      if (error) throw error;
      toast.success("ë°°ìš° ì •ë³´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
      setIsDeleteDialogOpen(false);
      fetchArtists();
    } catch (error: any) {
      toast.error(`ì‚­ì œ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setIsSaving(false);
      setCurrentArtist(null);
    }
  };

  const handleNewArtist = () => {
    setCurrentArtist(null);
    setFormData({
      name: "", stage_name: "", birth_date: "", gender: "", bio: "", is_active: true,
      email: "", contact_phone: "",
      resident_number: "", address: "", contract_start_date: "", contract_end_date: "",
      namuwiki_url: "", instagram_url: "", youtube_url: "",
      profile_image_url: "", id_card_url: "", id_card_masked_url: "", signature_url: "",
    });
    setIsSheetOpen(true);
  };

  const handleEditArtist = (artist: Artist) => {
    setCurrentArtist(artist);
    setFormData({
      name: artist.name,
      stage_name: artist.stage_name || "",
      birth_date: artist.birth_date || "",
      gender: artist.gender || "",
      bio: artist.bio || "",
      is_active: artist.is_active,
      email: artist.email || "",
      contact_phone: artist.contact_phone || "",
      resident_number: artist.resident_number || "",
      address: artist.address || "",
      contract_start_date: artist.contract_start_date || "",
      contract_end_date: artist.contract_end_date || "",
      namuwiki_url: artist.namuwiki_url || "",
      instagram_url: artist.instagram_url || "",
      youtube_url: artist.youtube_url || "",
      profile_image_url: artist.profile_image_url || "",
      id_card_url: artist.id_card_url || "",
      id_card_masked_url: artist.id_card_masked_url || "",
      signature_url: artist.signature_url || "",
    });
    setIsSheetOpen(true);
  };

  if (!isCompanyAdmin) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        <div className="text-center space-y-4">
          <AlertCircle className="w-12 h-12 text-destructive mx-auto" />
          <p className="text-muted-foreground font-medium">ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</p>
          <Button onClick={() => window.history.back()} variant="outline">ë’¤ë¡œ ê°€ê¸°</Button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />
      <main className="pt-24 pb-16 px-4 max-w-7xl mx-auto">
        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
          <div>
            <h1 className="text-3xl font-bold tracking-tight flex items-center gap-3">
              <Star className="w-8 h-8 text-primary" /> ë°°ìš°/ì•„í‹°ìŠ¤íŠ¸ ê´€ë¦¬
            </h1>
            <p className="text-muted-foreground mt-1">
              {isSuperAdmin ? "ì „ì²´ íšŒì‚¬" : currentTenant?.tenant.name}ì˜ ë°°ìš° ë° ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ë¥¼ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.
            </p>
          </div>
          <Button variant="hero" className="gap-2" size="lg" onClick={handleNewArtist}>
            <Plus className="w-5 h-5" /> ë°°ìš° ë“±ë¡
          </Button>
        </div>

        {/* ê²€ìƒ‰ */}
        <Card className="glass-card shadow-sm border border-border mb-8">
          <CardContent className="pt-4 flex flex-col sm:flex-row gap-4">
            <div className="relative flex-1">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
              <Input
                placeholder="ì´ë¦„ ë˜ëŠ” í™œë™ëª…ìœ¼ë¡œ ê²€ìƒ‰"
                className="pl-9 bg-secondary/50 border-none h-10 text-sm"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
              />
            </div>
            <Button variant="outline" onClick={() => setSearchQuery("")}>
              ì´ˆê¸°í™”
            </Button>
          </CardContent>
        </Card>

        {/* ì•„í‹°ìŠ¤íŠ¸ ì¹´ë“œ ê·¸ë¦¬ë“œ */}
        {loading ? (
          <div className="flex items-center justify-center h-64">
            <Loader2 className="w-8 h-8 animate-spin text-primary" />
          </div>
        ) : artists.length > 0 ? (
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {artists.map((artist) => (
              <Card key={artist.id} className="glass-card overflow-hidden hover:shadow-lg transition-all hover:scale-[1.02] cursor-pointer group" onClick={() => handleEditArtist(artist)}>
                <div className="aspect-[4/5] relative bg-secondary/30">
                  {artist.profile_image_url ? (
                    <img src={artist.profile_image_url} alt={artist.name} className="w-full h-full object-cover" />
                  ) : (
                    <div className="w-full h-full flex items-center justify-center">
                      <UserCircle className="w-24 h-24 text-muted-foreground/30" />
                    </div>
                  )}
                  <div className="absolute top-2 right-2 flex gap-1">
                    <Badge variant={artist.is_active ? "default" : "secondary"}>
                      {artist.is_active ? "í™œë™ì¤‘" : "ë¹„í™œë™"}
                    </Badge>
                  </div>
                  {/* Hover Actions */}
                  <div className="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-3">
                    <Button size="sm" variant="secondary" className="w-32" onClick={(e) => { e.stopPropagation(); handleEditArtist(artist); }}>
                      <Edit2 className="w-4 h-4 mr-2" /> ì •ë³´ ìˆ˜ì •
                    </Button>
                    <Button size="sm" variant="destructive" className="w-32" onClick={(e) => { e.stopPropagation(); setCurrentArtist(artist); setIsDeleteDialogOpen(true); }}>
                      <Trash2 className="w-4 h-4 mr-2" /> ì‚­ì œ
                    </Button>
                  </div>
                </div>
                <CardContent className="p-4">
                  <h3 className="font-bold text-lg flex items-center gap-2">
                    {artist.name}
                    <span className="text-xs font-normal text-muted-foreground">{artist.gender === 'male' ? '(ë‚¨)' : artist.gender === 'female' ? '(ì—¬)' : ''}</span>
                  </h3>
                  {artist.stage_name && (
                    <p className="text-sm font-medium text-primary mb-1">{artist.stage_name}</p>
                  )}
                  
                  <div className="space-y-1 mt-3">
                    <div className="text-xs text-muted-foreground flex items-center gap-1.5">
                      <Calendar className="w-3 h-3" /> 
                      {artist.birth_date || "ìƒë…„ì›”ì¼ ë¯¸ìƒ"}
                    </div>
                    {artist.contract_end_date && (
                      <div className="text-xs text-muted-foreground flex items-center gap-1.5">
                        <FileImage className="w-3 h-3" /> 
                        ê³„ì•½ë§Œë£Œ: {artist.contract_end_date}
                      </div>
                    )}
                  </div>
                </CardContent>
              </Card>
            ))}
          </div>
        ) : (
          <div className="text-center py-16 text-muted-foreground bg-secondary/20 rounded-xl">
            <Star className="w-12 h-12 mx-auto mb-3 opacity-20" />
            ë“±ë¡ëœ ë°°ìš°/ì•„í‹°ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.
          </div>
        )}
      </main>

      {/* ì¶”ê°€/ìˆ˜ì • Sheet */}
      <Sheet open={isSheetOpen} onOpenChange={setIsSheetOpen}>
        <SheetContent className="sm:max-w-4xl w-[90vw] p-0 overflow-hidden flex flex-col bg-slate-50">
          <SheetHeader className="p-6 border-b bg-white shrink-0">
            <SheetTitle className="text-2xl font-bold flex items-center gap-2">
              <Star className="w-6 h-6 text-primary" />
              {currentArtist ? "ë°°ìš° ì •ë³´ ìˆ˜ì •" : "ìƒˆ ë°°ìš° ë“±ë¡"}
            </SheetTitle>
          </SheetHeader>
          
          <ScrollArea className="flex-1">
            <div className="p-8 space-y-8">
              
              {/* 1. ê¸°ë³¸ í”„ë¡œí•„ ì„¹ì…˜ (ì´ë¯¸ì§€ + ê¸°ë³¸ì •ë³´) */}
              <section className="flex flex-col md:flex-row gap-8">
                {/* í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ */}
                <div className="w-full md:w-64 flex-shrink-0 flex flex-col gap-3">
                  <Label className="text-sm font-bold text-slate-700">í”„ë¡œí•„ ì´ë¯¸ì§€</Label>
                  <div 
                    onClick={() => profileInputRef.current?.click()}
                    className="aspect-[4/5] rounded-xl border-2 border-dashed border-slate-300 bg-white hover:bg-slate-50 hover:border-primary/50 transition-all cursor-pointer flex flex-col items-center justify-center overflow-hidden relative group shadow-sm"
                  >
                    {formData.profile_image_url ? (
                      <>
                        <img src={formData.profile_image_url} alt="Profile" className="w-full h-full object-cover" />
                        <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                          <UploadCloud className="w-8 h-8 text-white" />
                        </div>
                      </>
                    ) : (
                      <>
                        <User className="w-16 h-16 text-slate-200 mb-2" />
                        <span className="text-xs text-slate-400">ì´ë¯¸ì§€ ì—…ë¡œë“œ</span>
                      </>
                    )}
                    <input type="file" ref={profileInputRef} className="hidden" accept="image/*" onChange={(e) => handleFileUpload(e, 'profile_image_url')} />
                  </div>
                  <div className="flex items-center justify-between px-1">
                    <Label htmlFor="is_active" className="text-xs text-muted-foreground">í™œë™ ìƒíƒœ</Label>
                    <Switch
                      id="is_active"
                      checked={formData.is_active}
                      onCheckedChange={(checked) => setFormData({ ...formData, is_active: checked })}
                    />
                  </div>
                </div>

                {/* ê¸°ë³¸ ì •ë³´ í¼ */}
                <div className="flex-1 space-y-5">
                  <div className="flex items-center gap-2 pb-2 border-b border-slate-200">
                    <UserCircle className="w-5 h-5 text-primary" />
                    <h3 className="font-bold text-lg text-slate-800">ê¸°ë³¸ ì¸ì ì‚¬í•­</h3>
                  </div>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div className="space-y-2">
                      <Label htmlFor="name">ë³¸ëª… <span className="text-red-500">*</span></Label>
                      <Input
                        id="name"
                        placeholder="ì˜ˆ: ê¹€ë¯¼ìˆ˜"
                        className="bg-white"
                        value={formData.name}
                        onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="stage_name">í™œë™ëª… (ì˜ˆëª…)</Label>
                      <Input
                        id="stage_name"
                        placeholder="ì˜ˆ: ë¯¼ìˆ˜"
                        className="bg-white"
                        value={formData.stage_name}
                        onChange={(e) => setFormData({ ...formData, stage_name: e.target.value })}
                      />
                    </div>
                    
                    {/* [NEW] Contact Info */}
                    <div className="space-y-2">
                      <Label htmlFor="contact_phone">íœ´ëŒ€í° ë²ˆí˜¸</Label>
                      <div className="relative">
                        <Phone className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
                        <Input
                          id="contact_phone"
                          placeholder="010-0000-0000"
                          className="bg-white pl-10"
                          value={formData.contact_phone}
                          onChange={(e) => setFormData({ ...formData, contact_phone: e.target.value })}
                        />
                      </div>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="email">ì´ë©”ì¼</Label>
                      <div className="relative">
                        <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
                        <Input
                          id="email"
                          placeholder="artist@example.com"
                          className="bg-white pl-10"
                          value={formData.email}
                          onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label htmlFor="resident_number">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</Label>
                      <Input
                        id="resident_number"
                        placeholder="000000-0000000"
                        className="bg-white"
                        value={formData.resident_number}
                        onChange={(e) => setFormData({ ...formData, resident_number: e.target.value })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="gender">ì„±ë³„</Label>
                      <Select value={formData.gender} onValueChange={(val) => setFormData({ ...formData, gender: val })}>
                        <SelectTrigger id="gender" className="bg-white">
                          <SelectValue placeholder="ì„±ë³„ ì„ íƒ" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="male">ë‚¨ì„±</SelectItem>
                          <SelectItem value="female">ì—¬ì„±</SelectItem>
                          <SelectItem value="other">ê¸°íƒ€</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="birth_date">ìƒë…„ì›”ì¼</Label>
                      <Input
                        id="birth_date"
                        type="date"
                        className="bg-white"
                        value={formData.birth_date}
                        onChange={(e) => setFormData({ ...formData, birth_date: e.target.value })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="address">ì£¼ì†Œ (ê±°ì£¼ì§€)</Label>
                      <Input
                        id="address"
                        placeholder="ë„ë¡œëª… ì£¼ì†Œ ì…ë ¥"
                        className="bg-white"
                        value={formData.address}
                        onChange={(e) => setFormData({ ...formData, address: e.target.value })}
                      />
                    </div>
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="bio">ì†Œê°œ/ë°”ì´ì˜¤</Label>
                    <Textarea
                      id="bio"
                      placeholder="ì•„í‹°ìŠ¤íŠ¸ ì†Œê°œê¸€, íŠ¹ê¸°, ì·¨ë¯¸ ë“±..."
                      className="bg-white resize-none"
                      value={formData.bio}
                      onChange={(e) => setFormData({ ...formData, bio: e.target.value })}
                      rows={3}
                    />
                  </div>
                </div>
              </section>

              <Separator />

              {/* 2. ê³„ì•½ ë° ë§í¬ ì •ë³´ */}
              <section className="grid md:grid-cols-2 gap-8">
                {/* ê³„ì•½ ì •ë³´ */}
                <div className="space-y-5">
                  <div className="flex items-center gap-2 pb-2 border-b border-slate-200">
                    <Calendar className="w-5 h-5 text-primary" />
                    <h3 className="font-bold text-lg text-slate-800">ì „ì† ê³„ì•½ ì •ë³´</h3>
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="contract_start_date">ê³„ì•½ ì‹œì‘ì¼</Label>
                      <Input
                        id="contract_start_date"
                        type="date"
                        className="bg-white"
                        value={formData.contract_start_date}
                        onChange={(e) => setFormData({ ...formData, contract_start_date: e.target.value })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="contract_end_date">ê³„ì•½ ì¢…ë£Œì¼</Label>
                      <Input
                        id="contract_end_date"
                        type="date"
                        className="bg-white"
                        value={formData.contract_end_date}
                        onChange={(e) => setFormData({ ...formData, contract_end_date: e.target.value })}
                      />
                    </div>
                  </div>
                </div>

                {/* ì†Œì…œ ë° ì™¸ë¶€ ë§í¬ */}
                <div className="space-y-5">
                  <div className="flex items-center gap-2 pb-2 border-b border-slate-200">
                    <Globe className="w-5 h-5 text-primary" />
                    <h3 className="font-bold text-lg text-slate-800">ì™¸ë¶€ ë§í¬</h3>
                  </div>
                  <div className="space-y-3">
                    <div className="flex items-center gap-3">
                      <div className="w-8 flex justify-center"><Instagram className="w-5 h-5 text-pink-600" /></div>
                      <Input 
                        placeholder="Instagram URL" 
                        className="bg-white flex-1"
                        value={formData.instagram_url}
                        onChange={(e) => setFormData({ ...formData, instagram_url: e.target.value })}
                      />
                    </div>
                    <div className="flex items-center gap-3">
                      <div className="w-8 flex justify-center"><Youtube className="w-5 h-5 text-red-600" /></div>
                      <Input 
                        placeholder="YouTube Channel URL" 
                        className="bg-white flex-1"
                        value={formData.youtube_url}
                        onChange={(e) => setFormData({ ...formData, youtube_url: e.target.value })}
                      />
                    </div>
                    <div className="flex items-center gap-3">
                      <div className="w-8 flex justify-center text-xs font-bold text-green-700 bg-green-100 rounded px-1">N</div>
                      <Input 
                        placeholder="ë‚˜ë¬´ìœ„í‚¤ URL" 
                        className="bg-white flex-1"
                        value={formData.namuwiki_url}
                        onChange={(e) => setFormData({ ...formData, namuwiki_url: e.target.value })}
                      />
                    </div>
                  </div>
                </div>
              </section>

              <Separator />

              {/* 3. ì¦ë¹™ ë° ì¤‘ìš” ì„œë¥˜ ì´ë¯¸ì§€ */}
              <section className="space-y-5">
                <div className="flex items-center gap-2 pb-2 border-b border-slate-200">
                  <FileImage className="w-5 h-5 text-primary" />
                  <h3 className="font-bold text-lg text-slate-800">ì¦ë¹™ ë° ì„œëª… ì´ë¯¸ì§€</h3>
                </div>
                
                <div className="grid grid-cols-1 sm:grid-cols-3 gap-6">
                  {/* ì‹ ë¶„ì¦ ì›ë³¸ */}
                  <div className="space-y-2">
                    <Label className="text-sm">ì‹ ë¶„ì¦ ì›ë³¸ (ë³´ì•ˆ)</Label>
                    <div 
                      onClick={() => idCardInputRef.current?.click()}
                      className="h-32 rounded-lg border-2 border-dashed border-slate-300 bg-white hover:bg-slate-50 transition-colors cursor-pointer flex flex-col items-center justify-center p-4 relative overflow-hidden"
                    >
                      {formData.id_card_url ? (
                        <div className="w-full h-full flex items-center justify-center bg-green-50 text-green-600 font-bold">
                          <FileImage className="w-6 h-6 mr-2" /> ë“±ë¡ë¨
                        </div>
                      ) : (
                        <>
                          <UploadCloud className="w-6 h-6 text-slate-400 mb-2" />
                          <span className="text-xs text-slate-500">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                        </>
                      )}
                      <input type="file" ref={idCardInputRef} className="hidden" onChange={(e) => handleFileUpload(e, 'id_card_url')} />
                    </div>
                  </div>

                  {/* ë§ˆìŠ¤í‚¹ ì‹ ë¶„ì¦ */}
                  <div className="space-y-2">
                    <Label className="text-sm">ì‹ ë¶„ì¦ (ë§ˆìŠ¤í‚¹ìš©)</Label>
                    <div 
                      onClick={() => idMaskedInputRef.current?.click()}
                      className="h-32 rounded-lg border-2 border-dashed border-slate-300 bg-white hover:bg-slate-50 transition-colors cursor-pointer flex flex-col items-center justify-center p-4 relative overflow-hidden"
                    >
                      {formData.id_card_masked_url ? (
                        <div className="w-full h-full flex items-center justify-center bg-green-50 text-green-600 font-bold">
                          <FileImage className="w-6 h-6 mr-2" /> ë“±ë¡ë¨
                        </div>
                      ) : (
                        <>
                          <UploadCloud className="w-6 h-6 text-slate-400 mb-2" />
                          <span className="text-xs text-slate-500">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                        </>
                      )}
                      <input type="file" ref={idMaskedInputRef} className="hidden" onChange={(e) => handleFileUpload(e, 'id_card_masked_url')} />
                    </div>
                  </div>

                  {/* ì„œëª… ì´ë¯¸ì§€ */}
                  <div className="space-y-2">
                    <Label className="text-sm">ìí•„ ì„œëª… (íˆ¬ëª… ë°°ê²½)</Label>
                    <div 
                      onClick={() => signatureInputRef.current?.click()}
                      className="h-32 rounded-lg border-2 border-dashed border-slate-300 bg-white hover:bg-slate-50 transition-colors cursor-pointer flex flex-col items-center justify-center p-4 relative overflow-hidden"
                    >
                      {formData.signature_url ? (
                        <img src={formData.signature_url} alt="Signature" className="h-full object-contain" />
                      ) : (
                        <>
                          <Edit2 className="w-6 h-6 text-slate-400 mb-2" />
                          <span className="text-xs text-slate-500">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                        </>
                      )}
                      <input type="file" ref={signatureInputRef} className="hidden" accept="image/png" onChange={(e) => handleFileUpload(e, 'signature_url')} />
                    </div>
                  </div>
                </div>
              </section>

            </div>
          </ScrollArea>

          {/* Hidden Printable Component */}
          <div className="hidden">
            <div ref={printRef}>
              <ArtistProfileDocument data={formData} tenantName={currentTenant?.tenant.name || "Boteda Entertainment"} />
            </div>
          </div>

          <SheetFooter className="p-6 border-t bg-white shrink-0 flex gap-2">
            <div className="flex-1 flex justify-start">
              <Button variant="outline" onClick={() => handlePrint()} className="gap-2">
                <Printer className="w-4 h-4" /> íŒŒì¼ë¡œ ì €ì¥(PDF)
              </Button>
            </div>
            <SheetClose asChild>
              <Button variant="outline" disabled={isSaving}>ì·¨ì†Œ</Button>
            </SheetClose>
            <Button onClick={handleSave} disabled={isSaving || !formData.name} className="px-8">
              {isSaving ? <Loader2 className="w-4 h-4 mr-2 animate-spin" /> : <Save className="w-4 h-4 mr-2" />}
              {currentArtist ? "ìˆ˜ì • ì™„ë£Œ" : "ë“±ë¡ ì™„ë£Œ"}
            </Button>
          </SheetFooter>
        </SheetContent>
      </Sheet>

      {/* ì‚­ì œ í™•ì¸ Dialog */}
      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="text-destructive font-bold text-xl">ë°°ìš°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</AlertDialogTitle>
            <AlertDialogDescription>
              "{currentArtist?.name}" ë°°ìš° ì •ë³´ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel disabled={isSaving}>ì·¨ì†Œ</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} disabled={isSaving} className="bg-destructive text-destructive-foreground hover:bg-destructive/90">
              {isSaving ? <Loader2 className="w-4 h-4 animate-spin mr-2" /> : null}ì‚­ì œ
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
};

export default ArtistManagement;


============================================================
File Path: src/pages/admin/CompanyManagement.tsx
============================================================
import { useState, useEffect, useRef } from "react";
import { 
  Building, Save, Globe, MessageSquare, ShieldCheck, Loader2, ArrowLeft, 
  CreditCard, Landmark, FileText, Image as ImageIcon, 
  User, UploadCloud, Edit2, FileCheck, FileDown, ExternalLink
} from "lucide-react";
import { Header } from "@/components/landing/Header";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Separator } from "@/components/ui/separator";
import { Badge } from "@/components/ui/badge";
import { toast } from "sonner";
import { useNavigate } from "react-router-dom";

const CompanyManagement = () => {
  const { currentTenant } = useAuth();
  const navigate = useNavigate();
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);

  // íŒŒì¼ ì—…ë¡œë“œ ì°¸ì¡°ìš© Ref
  const logoRef = useRef<HTMLInputElement>(null);
  const sealRef = useRef<HTMLInputElement>(null);
  const signatureRef = useRef<HTMLInputElement>(null);

  const [formData, setFormData] = useState({
    name: "", rep_name: "", biz_number: "", corp_number: "", address: "", zip_code: "",
    biz_type: "", biz_item: "", pr_intro: "", naver_id: "", daum_id: "", contact_email: "",
    bank_name_kr: "", account_number_kr: "", account_holder_kr: "",
    bank_name_en: "", account_number_en: "", account_name_en: "", swift_code: "",
    branch_name_en: "", bank_address_en: "", rep_home_address: "", rep_resident_number: "",
    // ì´ë¯¸ì§€ìš© URL (ì§ì ‘ ì—…ë¡œë“œ í›„ ìƒì„±ë¨)
    logo_url: "", seal_url: "", signature_url: "",
    // ì„œë¥˜ìš© URL (êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§í¬ ì…ë ¥)
    biz_reg_doc_url: "", bank_copy_kr_url: "", bank_copy_en_url: ""
  });

  useEffect(() => {
    const fetchCompanyData = async () => {
      if (!currentTenant) return;
      setLoading(true);
      const { data, error } = await supabase.from("tenants").select("*").eq("id", currentTenant.tenant_id).single();
      if (data) {
        const sanitizedData = Object.keys(data).reduce((acc: any, key) => {
          acc[key] = data[key] === null ? "" : data[key];
          return acc;
        }, {});
        setFormData(prev => ({ ...prev, ...sanitizedData, contact_email: data.tax_email || "" }));
      }
      setLoading(false);
    };
    fetchCompanyData();
  }, [currentTenant]);

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    const { id, value } = e.target;
    setFormData(prev => ({ ...prev, [id]: value }));
  };

  // --- [í•µì‹¬] ì´ë¯¸ì§€ ì§ì ‘ ì—…ë¡œë“œ í•¸ë“¤ëŸ¬ ---
  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>, fieldName: string) => {
    const file = e.target.files?.[0];
    if (!file || !currentTenant) return;

    setSaving(true);
    try {
      const fileExt = file.name.split('.').pop();
      // ê²½ë¡œë¥¼ [í…Œë„ŒíŠ¸ID/íŒŒì¼ëª…] êµ¬ì¡°ë¡œ ë‹¨ìˆœí™”í•˜ì—¬ ìƒì„±
      const filePath = `${currentTenant.tenant_id}/${fieldName}_${Date.now()}.${fileExt}`;

      const { error: uploadError } = await supabase.storage
        .from('tenant-assets') // ë²„í‚· ì´ë¦„ í™•ì¸
        .upload(filePath, file, {
          upsert: true // ë™ì¼ íŒŒì¼ì´ ìˆì–´ë„ ë®ì–´ì“°ê¸° í—ˆìš©
        });

      if (uploadError) throw uploadError;

      const { data: { publicUrl } } = supabase.storage
        .from('tenant-assets')
        .getPublicUrl(filePath);

      setFormData(prev => ({ ...prev, [fieldName]: publicUrl }));
      toast.success("íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.");
    } catch (error: any) {
      console.error("Storage Error:", error);
      toast.error(`ì—…ë¡œë“œ ì‹¤íŒ¨: ${error.message}. ë²„í‚·ì´ ì¡´ì¬í•˜ê³  Publicìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.`);
    } finally {
      setSaving(false);
    }
  };

  const handleSave = async () => {
    if (!currentTenant) return;
    setSaving(true);
    try {
      // DB ì»¬ëŸ¼ëª…ê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë§Œ ì¶”ì¶œí•˜ì—¬ ì „ì†¡
      const { error } = await supabase
        .from("tenants")
        .update({
          name: formData.name,
          rep_name: formData.rep_name,
          biz_number: formData.biz_number,
          corp_number: formData.corp_number,
          address: formData.address,
          zip_code: formData.zip_code,
          biz_type: formData.biz_type,
          biz_item: formData.biz_item,
          tax_email: formData.contact_email, // ë§¤í•‘ ì£¼ì˜
          pr_intro: formData.pr_intro,
          naver_id: formData.naver_id,
          daum_id: formData.daum_id,
          bank_name_kr: formData.bank_name_kr,
          account_number_kr: formData.account_number_kr,
          account_holder_kr: formData.account_holder_kr,
          bank_name_en: formData.bank_name_en,
          account_number_en: formData.account_number_en,
          account_name_en: formData.account_name_en,
          swift_code: formData.swift_code,
          branch_name_en: formData.branch_name_en,
          bank_address_en: formData.bank_address_en,
          rep_home_address: formData.rep_home_address,
          rep_resident_number: formData.rep_resident_number,
          logo_url: formData.logo_url,
          seal_url: formData.seal_url,
          signature_url: formData.signature_url,
          biz_reg_doc_url: formData.biz_reg_doc_url,
          bank_copy_kr_url: formData.bank_copy_kr_url,
          bank_copy_en_url: formData.bank_copy_en_url,
          updated_at: new Date().toISOString()
        })
        .eq("id", currentTenant.tenant_id);

      if (error) throw error;
      toast.success("íšŒì‚¬ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.");
    } catch (error: any) {
      console.error("Save Error:", error);
      toast.error(`ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setSaving(false);
    }
  };

  if (loading) return <div className="min-h-screen flex items-center justify-center"><Loader2 className="animate-spin text-primary w-10 h-10" /></div>;

  return (
    <div className="min-h-screen bg-slate-50/50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-6xl mx-auto">
        <div className="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4">
          <div className="flex items-center gap-4">
            <Button variant="ghost" size="icon" onClick={() => navigate("/admin")}><ArrowLeft className="w-5 h-5" /></Button>
            <div>
              <h1 className="text-3xl font-bold tracking-tight">íšŒì‚¬ ì •ë³´ ë° ìì‚° ê´€ë¦¬</h1>
              <p className="text-slate-500 font-medium">ì‚¬ì—…ì ì •ë³´ ë° ê¸ˆìœµ/ì¸ê° ë°ì´í„°ë¥¼ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
            </div>
          </div>
          <Button onClick={handleSave} disabled={saving} className="gap-2 px-10 h-12 text-md font-bold shadow-lg">
            {saving ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
            ì„¤ì • ì €ì¥í•˜ê¸°
          </Button>
        </div>

        <Tabs defaultValue="basic" className="space-y-6">
          <TabsList className="bg-white border p-1 h-12 shadow-sm inline-flex w-full md:w-auto">
            <TabsTrigger value="basic" className="px-6">ì‚¬ì—…ì ê¸°ë³¸ì •ë³´</TabsTrigger>
            <TabsTrigger value="finance" className="px-6">ê¸ˆìœµ ë° ì¸ë³´ì´ìŠ¤</TabsTrigger>
            <TabsTrigger value="assets" className="px-6 font-bold text-blue-600">ì¸ê° ë° ì¦ë¹™ì„œë¥˜</TabsTrigger>
            <TabsTrigger value="pr" className="px-6">ëŒ€ì™¸ í™ë³´ ì„¤ì •</TabsTrigger>
          </TabsList>

          {/* 1. ê¸°ë³¸ ì •ë³´ íƒ­ (ê¸°ì¡´ê³¼ ë™ì¼) */}
          <TabsContent value="basic" className="space-y-6">
            <Card className="border-none shadow-sm">
              <CardHeader><CardTitle className="text-lg flex items-center gap-2"><FileText className="w-5 h-5 text-blue-500" /> ê³µì‹ ì‚¬ì—…ì ë“±ë¡ ì •ë³´</CardTitle></CardHeader>
              <CardContent className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div className="space-y-2"><Label>ë²•ì¸/ìƒí˜¸ëª…</Label><Input id="name" value={formData.name} onChange={handleChange} /></div>
                <div className="space-y-2"><Label>ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸</Label><Input id="biz_number" value={formData.biz_number} onChange={handleChange} /></div>
                <div className="space-y-2"><Label>ë²•ì¸ ë“±ë¡ë²ˆí˜¸</Label><Input id="corp_number" value={formData.corp_number} onChange={handleChange} /></div>
                <div className="space-y-2"><Label>ì—…íƒœ</Label><Input id="biz_type" value={formData.biz_type} onChange={handleChange} /></div>
                <div className="space-y-2"><Label>ì¢…ëª©</Label><Input id="biz_item" value={formData.biz_item} onChange={handleChange} /></div>
                <div className="space-y-2"><Label>ìš°í¸ë²ˆí˜¸</Label><Input id="zip_code" value={formData.zip_code} onChange={handleChange} /></div>
                <div className="md:col-span-3 space-y-2"><Label>ì‚¬ì—…ì¥ ì†Œì¬ì§€ (ë„ë¡œëª…)</Label><Input id="address" value={formData.address} onChange={handleChange} /></div>
              </CardContent>
            </Card>
            <Card className="border-none shadow-sm bg-blue-50/30">
              <CardHeader><CardTitle className="text-lg flex items-center gap-2"><User className="w-5 h-5 text-blue-600" /> ëŒ€í‘œì´ì‚¬ ìƒì„¸ ë³´ì•ˆ ì •ë³´</CardTitle></CardHeader>
              <CardContent className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div className="space-y-2"><Label>ëŒ€í‘œì´ì‚¬ ì„±ëª…</Label><Input id="rep_name" value={formData.rep_name} onChange={handleChange} /></div>
                <div className="space-y-2"><Label>ì£¼ë¯¼/ì™¸êµ­ì¸ ë“±ë¡ë²ˆí˜¸</Label><Input id="rep_resident_number" type="password" value={formData.rep_resident_number} onChange={handleChange} /></div>
                <div className="md:col-span-2 space-y-2"><Label>ëŒ€í‘œì´ì‚¬ ê±°ì£¼ì§€ ì£¼ì†Œ</Label><Input id="rep_home_address" value={formData.rep_home_address} onChange={handleChange} /></div>
              </CardContent>
            </Card>
          </TabsContent>

          {/* 2. ê¸ˆìœµ ì •ë³´ íƒ­ (ê¸°ì¡´ê³¼ ë™ì¼) */}
          <TabsContent value="finance" className="space-y-6">
            <Card className="border-none shadow-sm">
              <CardHeader><CardTitle className="text-lg flex items-center gap-2"><CreditCard className="w-5 h-5 text-green-600" /> ê²°ì œ ë° ì¸ë³´ì´ìŠ¤ ì •ë³´</CardTitle></CardHeader>
              <CardContent className="space-y-8">
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <div className="space-y-2"><Label>ê±°ë˜ì€í–‰ (êµ­ë¬¸)</Label><Input id="bank_name_kr" value={formData.bank_name_kr} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label>ê³„ì¢Œë²ˆí˜¸ (êµ­ë¬¸)</Label><Input id="account_number_kr" value={formData.account_number_kr} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label>ì˜ˆê¸ˆì£¼ (êµ­ë¬¸)</Label><Input id="account_holder_kr" value={formData.account_holder_kr} onChange={handleChange} /></div>
                </div>
                <Separator />
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2"><Label className="text-slate-500 font-bold">BANK NAME (ENG)</Label><Input id="bank_name_en" value={formData.bank_name_en} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label className="text-slate-500 font-bold">ACCOUNT NAME (ENG)</Label><Input id="account_name_en" value={formData.account_name_en} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label className="text-slate-500 font-bold">ACCOUNT NUMBER</Label><Input id="account_number_en" value={formData.account_number_en} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label className="text-slate-500 font-bold">SWIFT CODE</Label><Input id="swift_code" value={formData.swift_code} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label className="text-slate-500 font-bold">BRANCH NAME</Label><Input id="branch_name_en" value={formData.branch_name_en} onChange={handleChange} /></div>
                  <div className="space-y-2"><Label className="text-slate-500 font-bold">BANK ADDRESS</Label><Input id="bank_address_en" value={formData.bank_address_en} onChange={handleChange} /></div>
                </div>
              </CardContent>
            </Card>
          </TabsContent>

          {/* 3. [í•µì‹¬] í•˜ì´ë¸Œë¦¬ë“œ ìì‚° íƒ­ (ì—…ë¡œë“œ + ë§í¬) */}
          <TabsContent value="assets" className="space-y-6">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {/* ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ (ì„œë²„ ì €ì¥) */}
              <ImageAssetCard title="íšŒì‚¬ CI / ë¡œê³ " url={formData.logo_url} inputRef={logoRef} onUpload={(e) => handleImageUpload(e, 'logo_url')} />
              <ImageAssetCard title="ë²•ì¸ ì¸ê° (ë„ì¥)" url={formData.seal_url} inputRef={sealRef} onUpload={(e) => handleImageUpload(e, 'seal_url')} isSquare />
              <ImageAssetCard title="ëŒ€í‘œì ì„œëª…" url={formData.signature_url} inputRef={signatureRef} onUpload={(e) => handleImageUpload(e, 'signature_url')} />

              {/* ë¬¸ì„œ ë§í¬ ì˜ì—­ (ë“œë¼ì´ë¸Œ ì €ì¥) */}
              <Card className="md:col-span-3 border-none shadow-sm bg-slate-900 text-white">
                <CardHeader>
                  <CardTitle className="text-sm font-bold flex items-center gap-2"><ShieldCheck className="w-4 h-4 text-blue-400" /> ì™¸ë¶€ ì„œë¥˜ ë³´ê´€í•¨ (Google Drive Link)</CardTitle>
                </CardHeader>
                <CardContent className="grid grid-cols-1 md:grid-cols-3 gap-8">
                  <div className="space-y-2">
                    <Label className="text-slate-400">ì‚¬ì—…ìë“±ë¡ì¦ ì‚¬ë³¸ (ë§í¬)</Label>
                    <div className="flex gap-2"><Input id="biz_reg_doc_url" value={formData.biz_reg_doc_url} onChange={handleChange} className="bg-slate-800 border-slate-700 text-blue-300" />{formData.biz_reg_doc_url && <Button variant="secondary" size="icon" onClick={() => window.open(formData.biz_reg_doc_url)}><ExternalLink className="w-4 h-4" /></Button>}</div>
                  </div>
                  <div className="space-y-2">
                    <Label className="text-slate-400">í†µì¥ì‚¬ë³¸ êµ­ë¬¸ (ë§í¬)</Label>
                    <div className="flex gap-2"><Input id="bank_copy_kr_url" value={formData.bank_copy_kr_url} onChange={handleChange} className="bg-slate-800 border-slate-700 text-blue-300" />{formData.bank_copy_kr_url && <Button variant="secondary" size="icon" onClick={() => window.open(formData.bank_copy_kr_url)}><ExternalLink className="w-4 h-4" /></Button>}</div>
                  </div>
                  <div className="space-y-2">
                    <Label className="text-slate-400">í†µì¥ì‚¬ë³¸ ì˜ë¬¸ (ë§í¬)</Label>
                    <div className="flex gap-2"><Input id="bank_copy_en_url" value={formData.bank_copy_en_url} onChange={handleChange} className="bg-slate-800 border-slate-700 text-blue-300" />{formData.bank_copy_en_url && <Button variant="secondary" size="icon" onClick={() => window.open(formData.bank_copy_en_url)}><ExternalLink className="w-4 h-4" /></Button>}</div>
                  </div>
                </CardContent>
              </Card>
            </div>
          </TabsContent>
          
          <TabsContent value="pr" className="space-y-6">
             <Card className="border-none shadow-sm"><CardHeader><CardTitle className="text-lg">ë³´ë„ìë£Œ ê³µì‹ ì†Œê°œë¬¸</CardTitle></CardHeader><CardContent><Textarea id="pr_intro" value={formData.pr_intro} onChange={handleChange} className="min-h-[200px]" placeholder="ë°°í¬ìš© íšŒì‚¬ ì†Œê°œë¬¸ì„ ì‘ì„±í•˜ì‹­ì‹œì˜¤." /></CardContent></Card>
             <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <Card className="border-none shadow-sm"><CardHeader className="pb-2"><CardTitle className="text-sm font-bold">ë„¤ì´ë²„ ì¸ë¬¼ì •ë³´ ê´€ë¦¬ì ID</CardTitle></CardHeader><CardContent><Input id="naver_id" value={formData.naver_id} onChange={handleChange} /></CardContent></Card>
                <Card className="border-none shadow-sm"><CardHeader className="pb-2"><CardTitle className="text-sm font-bold">ë‹¤ìŒ ì¸ë¬¼ì •ë³´ ê´€ë¦¬ì ID</CardTitle></CardHeader><CardContent><Input id="daum_id" value={formData.daum_id} onChange={handleChange} /></CardContent></Card>
             </div>
          </TabsContent>
        </Tabs>
      </main>
    </div>
  );
};

// --- ì„œë¸Œ ì»´í¬ë„ŒíŠ¸: ì´ë¯¸ì§€ ìì‚° ì¹´ë“œ ---
const ImageAssetCard = ({ title, url, inputRef, onUpload, isSquare = false }: any) => (
  <Card className="border-none shadow-sm text-center bg-white">
    <CardHeader className="pb-2"><CardTitle className="text-xs font-bold text-slate-500 uppercase">{title}</CardTitle></CardHeader>
    <CardContent className="flex flex-col items-center gap-4">
      <div className="h-32 w-full border-2 border-dashed rounded-xl bg-slate-50 flex items-center justify-center relative overflow-hidden group hover:border-blue-400 transition-colors">
        {url ? (
          <img src={url} className={`h-full w-full object-contain p-2 ${isSquare ? 'max-w-[100px]' : ''}`} alt={title} />
        ) : (
          <UploadCloud className="text-slate-300 w-10 h-10" />
        )}
        <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer" onClick={() => inputRef.current?.click()}>
          <Edit2 className="text-white w-6 h-6" />
        </div>
        <input type="file" ref={inputRef} className="hidden" accept="image/*" onChange={onUpload} />
      </div>
    </CardContent>
  </Card>
);

export default CompanyManagement;


============================================================
File Path: src/pages/admin/CorporateCardManagement.tsx
============================================================
import { useState, useEffect } from "react";
import { Header } from "@/components/landing/Header";
import { supabase } from "@/integrations/supabase/client";
import { useAuth } from "@/hooks/useAuth";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import { Button } from "@/components/ui/button";
import { CreditCard, Plus, FileText, Calendar as CalendarIcon } from "lucide-react";
import { toast } from "sonner";

const CorporateCardManagement = () => {
  const { currentTenant } = useAuth();
  const [cards, setCards] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (currentTenant) fetchCards();
  }, [currentTenant]);

  const fetchCards = async () => {
    setLoading(true);
    const { data } = await supabase
      .from("corporate_cards")
      .select("*")
      .eq("tenant_id", currentTenant.tenant_id);
    if (data) setCards(data);
    setLoading(false);
  };

  return (
    <div className="min-h-screen bg-slate-50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-7xl mx-auto">
        <div className="flex justify-between items-center mb-8">
          <div>
            <h1 className="text-3xl font-bold flex items-center gap-3">
              <CreditCard className="w-8 h-8 text-orange-500" /> ë²•ì¸ì¹´ë“œ ê´€ë¦¬
            </h1>
            <p className="text-slate-500 mt-1">ì„ì§ì› ë²•ì¸ì¹´ë“œ ì‚¬ìš© ë‚´ì—­ ë° ì¦ë¹™ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
          </div>
          <Button className="bg-orange-600 hover:bg-orange-700 gap-2">
            <Plus size={18} /> ì¹´ë“œ ë‚´ì—­ ë“±ë¡
          </Button>
        </div>

        <Card className="border-none shadow-sm overflow-hidden">
          <Table>
            <TableHeader className="bg-slate-100">
              <TableRow>
                <TableHead>ì¹´ë“œ ë²ˆí˜¸</TableHead>
                <TableHead>ì‚¬ìš©ì</TableHead>
                <TableHead>ì´ë©”ì¼</TableHead>
                <TableHead>ì‚¬ìš©ì¼ (ìº˜ë¦°ë”)</TableHead>
                <TableHead>ì°¨ëŸ‰ë²ˆí˜¸</TableHead>
                <TableHead>íŒŒì¼ì´ë¦„ (ì¦ë¹™)</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {cards.map((card) => (
                <TableRow key={card.id}>
                  <TableCell className="font-mono">{card.card_number}</TableCell>
                  <TableCell className="font-bold">{card.user_name}</TableCell>
                  <TableCell>{card.user_email}</TableCell>
                  <TableCell>
                    <div className="flex items-center gap-1 text-slate-500">
                      <CalendarIcon size={14} /> {card.usage_date}
                    </div>
                  </TableCell>
                  <TableCell><Badge variant="outline">{card.vehicle_number}</Badge></TableCell>
                  <TableCell>
                    <Button variant="ghost" size="sm" className="text-blue-600 gap-1">
                      <FileText size={14} /> {card.evidence_file_name || "ë³´ê¸°"}
                    </Button>
                  </TableCell>
                </TableRow>
              ))}
              {cards.length === 0 && !loading && (
                <TableRow><TableCell colSpan={6} className="text-center py-10 text-slate-400">ë“±ë¡ëœ ì¹´ë“œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</TableCell></TableRow>
              )}
            </TableBody>
          </Table>
        </Card>
      </main>
    </div>
  );
};

export default CorporateCardManagement;


============================================================
File Path: src/pages/admin/DriveSettings.tsx
============================================================
import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
// --- [í•µì‹¬] Header ì„í¬íŠ¸ í™•ì¸ ---
import { Header } from "@/components/landing/Header"; 
import { 
  ArrowLeft, CheckCircle, Trash2, Settings2, Info, Terminal 
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { 
  Accordion, 
  AccordionContent, 
  AccordionItem, 
  AccordionTrigger 
} from "@/components/ui/accordion";
import { supabase } from "@/integrations/supabase/client";
import { useAuth } from "@/hooks/useAuth";
import { toast } from "sonner";

interface TenantDriveSettings {
  id: string;
  name: string;
  drive_folder_id: string | null;
  drive_connected_at: string | null;
  google_credentials: string | null;
}

const DriveSettings = () => {
  const navigate = useNavigate();
  const { user, currentTenant, isSuperAdmin } = useAuth(); 
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [tenant, setTenant] = useState<TenantDriveSettings | null>(null);
  const [folderId, setFolderId] = useState("");
  const [credentialsFile, setCredentialsFile] = useState<File | null>(null);
  const [hasExistingCredentials, setHasExistingCredentials] = useState(false);

  useEffect(() => {
    fetchTenantSettings();
  }, [currentTenant]);

  const fetchTenantSettings = async () => {
    if (!currentTenant) return;

    try {
      setLoading(true);
      if (currentTenant.role !== "company_admin" && !isSuperAdmin) {
        toast.error("í•´ë‹¹ íšŒì‚¬ì˜ ê´€ë¦¬ì ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        navigate("/dashboard");
        return;
      }

      const { data: tenantData, error: tenantError } = await supabase
        .from("tenants")
        .select("id, name, drive_folder_id, drive_connected_at, google_credentials")
        .eq("id", currentTenant.tenant_id)
        .single();

      if (tenantError) throw tenantError;

      setTenant(tenantData);
      setFolderId(tenantData.drive_folder_id || "");
      setHasExistingCredentials(!!tenantData.google_credentials);
    } catch (error) {
      console.error("Error fetching settings:", error);
    } finally {
      setLoading(false);
    }
  };

  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file && file.type === "application/json") {
      setCredentialsFile(file);
    } else if (file) {
      toast.error("JSON íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
    }
  };

  const handleSave = async () => {
    if (!tenant) return;
    if (!folderId.trim()) {
      toast.error("Google Drive í´ë” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    setSaving(true);
    try {
      let credentialsJson: string | null = null;
      if (credentialsFile) {
        const fileContent = await credentialsFile.text();
        credentialsJson = btoa(unescape(encodeURIComponent(fileContent)));
      }

      const updateData: any = {
        drive_folder_id: folderId.trim(),
        drive_connected_at: new Date().toISOString(),
        drive_connected_by: user?.id,
      };
      
      if (credentialsJson) updateData.google_credentials = credentialsJson;

      const { error } = await supabase
        .from("tenants")
        .update(updateData)
        .eq("id", tenant.id);

      if (error) throw error;

      toast.success(`${tenant.name}ì˜ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
      setHasExistingCredentials(true);
      setCredentialsFile(null);
      await fetchTenantSettings();
    } catch (error: any) {
      toast.error(`ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setSaving(false);
    }
  };

  const handleDisconnect = async () => {
    if (!confirm(`${tenant?.name}ì˜ ì—°ë™ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
    setSaving(true);
    try {
      const { error } = await supabase
        .from("tenants")
        .update({ google_credentials: null, drive_folder_id: null, drive_connected_at: null })
        .eq("id", tenant?.id);
      if (error) throw error;
      toast.success("ì—°ë™ì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
      setFolderId("");
      setHasExistingCredentials(false);
      await fetchTenantSettings();
    } catch (error) {
      toast.error("ì—°ë™ í•´ì œ ì‹¤íŒ¨");
    } finally {
      setSaving(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary" />
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-slate-50/50 pb-20 text-slate-900">
      {/* ê³ ì • í—¤ë” */}
      <Header /> 

      {/* ë³¸ë¬¸ (pt-28ë¡œ í—¤ë” ê³µê°„ í™•ë³´) */}
      <div className="max-w-4xl mx-auto p-6 pt-28 space-y-6"> 
        <div className="flex items-center gap-4">
          <Button variant="ghost" size="icon" onClick={() => navigate(-1)}>
            <ArrowLeft className="h-5 w-5" />
          </Button>
          <div>
            <h1 className="text-2xl font-bold tracking-tight">í†µí•© ì €ì¥ì†Œ ì„¤ì •</h1>
            <p className="text-blue-600 font-bold">{tenant?.name} Â· Google Drive ì—°ë™</p>
          </div>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div className="lg:col-span-2 space-y-6">
            <Card className="shadow-sm border-slate-200 bg-white">
              <CardHeader className="border-b bg-slate-50/50 py-4">
                <CardTitle className="text-lg flex items-center gap-2">
                  <Settings2 className="h-5 w-5 text-primary" /> {tenant?.name} ì—°ë™ ì •ë³´
                </CardTitle>
              </CardHeader>
              <CardContent className="pt-6 space-y-6">
                <div className="space-y-2">
                  <Label className="font-bold">1. ì„œë¹„ìŠ¤ ê³„ì • í‚¤ (JSON)</Label>
                  <Input type="file" accept=".json" onChange={handleFileChange} className="cursor-pointer bg-white" />
                  {hasExistingCredentials && !credentialsFile && (
                    <p className="text-xs text-green-600 font-medium flex items-center gap-1">
                      <CheckCircle className="h-3 w-3" /> ê¸°ì¡´ í‚¤ê°€ ì´ë¯¸ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                    </p>
                  )}
                </div>

                <div className="space-y-2">
                  <Label className="font-bold">2. êµ¬ê¸€ ë“œë¼ì´ë¸Œ í´ë” ID</Label>
                  <Input 
                    placeholder="í´ë”ì˜ ê³ ìœ  IDë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                    value={folderId} 
                    onChange={(e) => setFolderId(e.target.value)} 
                    className="bg-white"
                  />
                  <p className="text-[11px] text-slate-400">êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì£¼ì†Œì°½ /folders/ ë’¤ì˜ ê¸´ ë¬¸ìì—´ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
                </div>

                <div className="flex gap-3 pt-2">
                  <Button onClick={handleSave} disabled={saving} className="flex-1 font-bold">
                    {saving ? "ì €ì¥ ì¤‘..." : `${tenant?.name} ì„¤ì • ì €ì¥`}
                  </Button>
                  {hasExistingCredentials && (
                    <Button variant="outline" onClick={handleDisconnect} disabled={saving} className="text-destructive">
                      <Trash2 className="h-4 w-4 mr-2" /> ì—°ë™ í•´ì œ
                    </Button>
                  )}
                </div>
              </CardContent>
            </Card>

            <Card className="border-amber-100 shadow-sm overflow-hidden bg-white">
              <CardHeader className="bg-amber-50/50 border-b border-amber-100 py-3">
                <CardTitle className="text-sm font-bold flex items-center gap-2 text-amber-700">
                  <Terminal className="h-4 w-4" /> ì„¤ì • ê°€ì´ë“œ
                </CardTitle>
              </CardHeader>
              <CardContent className="p-0">
                <Accordion type="single" collapsible className="w-full">
                  <AccordionItem value="item-1" className="border-b-0">
                    <AccordionTrigger className="px-4 py-3 hover:no-underline">
                      <span className="text-sm font-semibold">ì„œë¹„ìŠ¤ ê³„ì • ì´ë©”ì¼ ì´ˆëŒ€ í•„ìˆ˜</span>
                    </AccordionTrigger>
                    <AccordionContent className="px-4 pb-4 text-xs text-slate-600 leading-relaxed">
                      JSON íŒŒì¼ ë‚´ì˜ <strong>client_email</strong> ì£¼ì†Œë¥¼ ë³µì‚¬í•˜ì—¬, ëŒ€ìƒ êµ¬ê¸€ ë“œë¼ì´ë¸Œ í´ë”ì˜ [ê³µìœ ] ì„¤ì •ì—ì„œ 'í¸ì§‘ì' ê¶Œí•œìœ¼ë¡œ ë°˜ë“œì‹œ ì´ˆëŒ€í•´ì•¼ ì—…ë¡œë“œê°€ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.
                    </AccordionContent>
                  </AccordionItem>
                </Accordion>
              </CardContent>
            </Card>
          </div>

          <div className="space-y-6">
            <Card className="border-primary/20 bg-blue-50 shadow-none">
              <CardHeader className="pb-3">
                <CardTitle className="text-sm font-bold flex items-center gap-2 text-blue-700">
                  <Info className="h-4 w-4" /> ì£¼ì˜ ì‚¬í•­
                </CardTitle>
              </CardHeader>
              <CardContent className="text-[12px] leading-relaxed text-blue-800 space-y-2">
                <p>â€¢ ì§€ê¸ˆ ì„¤ì •í•˜ëŠ” ë‚´ìš©ì€ <strong>{tenant?.name}</strong>ì—ë§Œ ì ìš©ë©ë‹ˆë‹¤.</p>
                <p>â€¢ ë‹¤ë¥¸ íšŒì‚¬ì˜ ë“œë¼ì´ë¸Œë¥¼ ì„¤ì •í•˜ë ¤ë©´ ìƒë‹¨ ë©”ë‰´ì—ì„œ íšŒì‚¬ë¥¼ ë³€ê²½í•œ í›„ ë‹¤ì‹œ ì ‘ì†í•´ì£¼ì„¸ìš”.</p>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </div>
  );
};

export default DriveSettings;


============================================================
File Path: src/pages/admin/HRManagement.tsx
============================================================
import { useState, useEffect, useRef } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetDescription,
  SheetFooter,
} from "@/components/ui/sheet";
import { Label } from "@/components/ui/label";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import {
  Users,
  UserPlus,
  Mail,
  Briefcase,
  User,
  Loader2,
  ShieldCheck,
  Landmark,
  Clock,
  AlertCircle,
  Heart,
  FileImage,
  UploadCloud,
  Send,
  X,
  Copy,
  Check,
} from "lucide-react";
import { toast } from "sonner";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";
import { Separator } from "@/components/ui/separator";
import { ScrollArea } from "@/components/ui/scroll-area";

interface Invitation {
  id: string;
  email: string;
  role: string;
  department: string | null;
  job_title: string | null;
  status: string;
  expires_at: string;
  created_at: string;
}

const HRManagement = () => {
  const { currentTenant, isCompanyAdmin, user } = useAuth();
  const [members, setMembers] = useState<any[]>([]);
  const [invitations, setInvitations] = useState<Invitation[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState("");
  const [isEditOpen, setIsEditOpen] = useState(false);
  const [selectedMember, setSelectedMember] = useState<any>(null);

  // ì´ˆëŒ€ ê´€ë ¨ ìƒíƒœ
  const [isInviteDialogOpen, setIsInviteDialogOpen] = useState(false);
  const [inviteLoading, setInviteLoading] = useState(false);
  const [inviteForm, setInviteForm] = useState({
    email: "",
    role: "employee",
    department: "",
    job_title: "",
  });

  // --- ìƒíƒœ ê´€ë¦¬: ì€í–‰ ë° íŒŒì¼ ---
  const [bankType, setBankType] = useState<string>("");
  const [manualBankName, setManualBankName] = useState<string>("");
  const [idCardFile, setIdCardFile] = useState<File | null>(null);
  const [bankbookFile, setBankbookFile] = useState<File | null>(null);
  const [isUploading, setIsUploading] = useState(false);

  const fetchMembers = async () => {
    if (!currentTenant) return;
    setLoading(true);
    try {
      const { data, error } = await supabase
        .from("tenant_memberships")
        .select(`
          id, role, department, job_title, created_at,
          profiles:user_id ( id, full_name, email, avatar_url, phone )
        `)
        .eq("tenant_id", currentTenant.tenant_id);

      if (error) throw error;
      setMembers(data || []);
    } catch (error: any) {
      console.error("Fetch error:", error);
      toast.error("ì§ì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    } finally {
      setLoading(false);
    }
  };

  const fetchInvitations = async () => {
    if (!currentTenant) return;
    try {
      const { data, error } = await supabase
        .from("employee_invitations")
        .select("*")
        .eq("tenant_id", currentTenant.tenant_id)
        .eq("status", "pending")
        .order("created_at", { ascending: false });

      if (error) throw error;
      setInvitations((data || []) as Invitation[]);
    } catch (error: any) {
      console.error("Fetch invitations error:", error);
    }
  };

  useEffect(() => {
    fetchMembers();
    fetchInvitations();
  }, [currentTenant]);
  
  // --- [í•µì‹¬ ìˆ˜ì •] ì´ˆëŒ€ ë°œì†¡ ë° ë§í¬ ë³µì‚¬ í•˜ì´ë¸Œë¦¬ë“œ ë¡œì§ ---
  const handleSendInvite = async () => {
    if (!inviteForm.email || !currentTenant || !user) {
      toast.error("ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    setInviteLoading(true);
    const emailLower = inviteForm.email.toLowerCase();
    // ì´ˆëŒ€ ìˆ˜ë½ ë§í¬ ë¯¸ë¦¬ ìƒì„±
    const signupUrl = `${window.location.origin}/auth?invite=${encodeURIComponent(emailLower)}`;

    try {
      // 1. DBì— ì´ˆëŒ€ ì •ë³´ Upsert (ì¤‘ë³µ ì‹œ ì—…ë°ì´íŠ¸)
      const { error: dbError } = await supabase
        .from("employee_invitations")
        .upsert({
          tenant_id: currentTenant.tenant_id,
          email: emailLower,
          role: inviteForm.role,
          department: inviteForm.department || null,
          job_title: inviteForm.job_title || null,
          invited_by: user.id,
          status: 'pending',
          updated_at: new Date().toISOString()
        }, {
          onConflict: 'tenant_id, email'
        });

      if (dbError) throw dbError;

      // 2. ì´ë©”ì¼ ë°œì†¡ ì‹œë„
      const { data: { session } } = await supabase.auth.getSession();
      
      const { error: funcError } = await supabase.functions.invoke("send-invitation-email", {
        body: {
          email: emailLower,
          companyName: currentTenant.tenant.name,
          role: inviteForm.role,
          department: inviteForm.department || undefined,
          jobTitle: inviteForm.job_title || undefined,
          signupUrl: signupUrl,
        },
        headers: {
          Authorization: `Bearer ${session?.access_token}`,
        }
      });

      // 3. ë°œì†¡ ê²°ê³¼ì— ë”°ë¥¸ ì²˜ë¦¬
      if (funcError) {
        // ë„ë©”ì¸ ì¸ì¦ ë¬¸ì œ(403) ë“±ìœ¼ë¡œ ì‹¤íŒ¨í–ˆì„ ê²½ìš°
        console.warn("ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨ (Sandbox ì œí•œ ê°€ëŠ¥ì„±):", funcError);
        
        toast.info("ì´ˆëŒ€ ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.", {
          description: "í˜„ì¬ ì´ë©”ì¼ ë°œì†¡ ì œí•œ ìƒíƒœì…ë‹ˆë‹¤. ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§í¬ë¥¼ ë³µì‚¬í•´ ì§ì ‘ ì „ë‹¬í•˜ì„¸ìš”.",
          duration: 10000,
          action: {
            label: "ë§í¬ ë³µì‚¬",
            onClick: () => {
              navigator.clipboard.writeText(signupUrl);
              toast.success("ì´ˆëŒ€ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
            },
          },
        });
      } else {
        toast.success(`${emailLower}ë¡œ ì´ˆëŒ€ ë©”ì¼ì„ ë³´ëƒˆìŠµë‹ˆë‹¤.`);
      }

      setIsInviteDialogOpen(false);
      fetchInvitations();
    } catch (error: any) {
      console.error("Invite Error:", error);
      toast.error("ì´ˆëŒ€ ì‹¤íŒ¨: " + (error.message || "ì„œë²„ ì˜¤ë¥˜"));
    } finally {
      setInviteLoading(false);
    }
  };

  const handleCancelInvite = async (invitationId: string) => {
    try {
      const { error } = await supabase
        .from("employee_invitations")
        .delete()
        .eq("id", invitationId);

      if (error) throw error;
      toast.success("ì´ˆëŒ€ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.");
      fetchInvitations();
    } catch (error: any) {
      toast.error("ì´ˆëŒ€ ì·¨ì†Œ ì‹¤íŒ¨: " + error.message);
    }
  };

  const handleRowClick = (member: any) => {
    setSelectedMember(member);
    setIsEditOpen(true);
    setBankType("");
    setManualBankName("");
    setIdCardFile(null);
    setBankbookFile(null);
  };

  const handleSave = async () => {
    setIsUploading(true);
    try {
      // íŒŒì¼ ì—…ë¡œë“œ ë° DB ì—…ë°ì´íŠ¸ ë¡œì§ (ìƒëµ)
      toast.success("ì¸ì‚¬ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
      setIsEditOpen(false);
    } catch (error) {
      toast.error("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    } finally {
      setIsUploading(false);
    }
  };

  if (!isCompanyAdmin) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        <div className="text-center space-y-4">
          <AlertCircle className="w-12 h-12 text-destructive mx-auto" />
          <p className="text-muted-foreground font-medium">ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</p>
          <Button onClick={() => window.history.back()} variant="outline">ë’¤ë¡œ ê°€ê¸°</Button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />

      <main className="pt-24 pb-16 px-4 max-w-7xl mx-auto">
        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
          <div>
            <h1 className="text-3xl font-bold tracking-tight flex items-center gap-3">
              <Users className="w-8 h-8 text-primary" /> ì¸ì‚¬ ê´€ë¦¬
            </h1>
            <p className="text-muted-foreground mt-1">ì„ì§ì› ìƒì„¸ ì •ë³´ ë° ì¦ë¹™ ì„œë¥˜ë¥¼ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
          </div>
          <Button variant="hero" className="gap-2" size="lg" onClick={() => setIsInviteDialogOpen(true)}>
            <UserPlus className="w-5 h-5" /> ì§ì› ì´ˆëŒ€í•˜ê¸°
          </Button>
        </div>

        {/* ìš”ì•½ ì¹´ë“œ ì˜ì—­ */}
        <div className="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
          <Card className="glass-card shadow-sm border-primary/10">
            <CardContent className="pt-6">
              <div className="flex items-center justify-between">
                <p className="text-sm font-medium text-muted-foreground">ì „ì²´ ì„ì§ì›</p>
                <Users className="w-4 h-4 text-primary" />
              </div>
              <div className="text-2xl font-bold mt-2">{members.length}ëª…</div>
            </CardContent>
          </Card>
          <Card className="glass-card shadow-sm border-primary/10">
            <CardContent className="pt-6">
              <div className="flex items-center justify-between">
                <p className="text-sm font-medium text-muted-foreground">ëŒ€ê¸°ì¤‘ ì´ˆëŒ€</p>
                <Send className="w-4 h-4 text-primary" />
              </div>
              <div className="text-2xl font-bold mt-2">{invitations.length}ê±´</div>
            </CardContent>
          </Card>
          {/* ... ë‚˜ë¨¸ì§€ ì¹´ë“œ ìƒëµ ... */}
        </div>

        {/* ëŒ€ê¸° ì¤‘ì¸ ì´ˆëŒ€ ëª©ë¡ (ë§í¬ ë³µì‚¬ ê¸°ëŠ¥ í¬í•¨) */}
        {invitations.length > 0 && (
          <Card className="glass-card mb-8 border-primary/20">
            <CardHeader className="pb-3">
              <CardTitle className="flex items-center gap-2 text-lg">
                <Send className="w-5 h-5 text-primary" /> ëŒ€ê¸° ì¤‘ì¸ ì´ˆëŒ€
              </CardTitle>
              <CardDescription>ì´ë©”ì¼ ë°œì†¡ì´ ì‹¤íŒ¨í•œ ê²½ìš° ë§í¬ë¥¼ ë³µì‚¬í•˜ì—¬ ì „ë‹¬í•˜ì„¸ìš”.</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-2">
                {invitations.map((invite) => (
                  <div key={invite.id} className="flex items-center justify-between p-3 rounded-lg bg-secondary/30 border border-border/50 group">
                    <div className="flex items-center gap-4">
                      <div className="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center">
                        <Mail className="w-5 h-5 text-primary" />
                      </div>
                      <div>
                        <div className="text-sm font-bold flex items-center gap-2">
                          {invite.email}
                          <Badge variant="outline" className="text-[10px]">
                            {invite.role === 'company_admin' ? 'ê´€ë¦¬ì' : invite.role === 'manager' ? 'ë§¤ë‹ˆì €' : 'ì‚¬ì›'}
                          </Badge>
                        </div>
                        <div className="text-xs text-muted-foreground">
                          {invite.department && `${invite.department} Â· `}
                          {invite.job_title && `${invite.job_title} Â· `}
                          ì´ˆëŒ€ì¼: {new Date(invite.created_at).toLocaleDateString()}
                        </div>
                      </div>
                    </div>
                    <div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                      <Button
                        variant="ghost"
                        size="sm"
                        className="h-8 gap-1 text-primary hover:text-primary hover:bg-primary/5"
                        onClick={() => {
                          const url = `${window.location.origin}/auth?invite=${encodeURIComponent(invite.email)}`;
                          navigator.clipboard.writeText(url);
                          toast.success("ì´ˆëŒ€ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
                        }}
                      >
                        <Copy className="w-3.5 h-3.5" /> ë§í¬ ë³µì‚¬
                      </Button>
                      <Button
                        variant="ghost"
                        size="sm"
                        className="h-8 gap-1 text-destructive hover:text-destructive hover:bg-destructive/5"
                        onClick={() => handleCancelInvite(invite.id)}
                      >
                        <X className="w-3.5 h-3.5" /> ì·¨ì†Œ
                      </Button>
                    </div>
                  </div>
                ))}
              </div>
            </CardContent>
          </Card>
        )}

        {/* ë©”ì¸ ì§ì› í…Œì´ë¸” */}
        <div className="glass-card overflow-hidden shadow-sm border border-border">
          <Table>
            <TableHeader className="bg-secondary/50">
              <TableRow>
                <TableHead className="w-[200px]">ì„±ëª…</TableHead>
                <TableHead>ë¶€ì„œ / ì§ê¸‰</TableHead>
                <TableHead>ì´ë©”ì¼</TableHead>
                <TableHead>ê¶Œí•œ</TableHead>
                <TableHead>ìƒíƒœ</TableHead>
                <TableHead className="text-right">ê´€ë¦¬</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {loading ? (
                <TableRow><TableCell colSpan={6} className="h-32 text-center"><Loader2 className="w-8 h-8 animate-spin mx-auto text-primary" /></TableCell></TableRow>
              ) : members.map((member) => (
                <TableRow key={member.id} className="cursor-pointer hover:bg-secondary/30 transition-colors" onClick={() => handleRowClick(member)}>
                  <TableCell>
                    <div className="flex items-center gap-3">
                      <Avatar className="w-9 h-9 border">
                        <AvatarImage src={member.profiles?.avatar_url} />
                        <AvatarFallback className="bg-primary/10 text-primary">{member.profiles?.full_name?.charAt(0)}</AvatarFallback>
                      </Avatar>
                      <span className="font-bold">{member.profiles?.full_name}</span>
                    </div>
                  </TableCell>
                  <TableCell>
                    <div className="flex flex-col">
                      <span className="text-sm font-medium">{member.department || "-"}</span>
                      <span className="text-xs text-muted-foreground">{member.job_title || "-"}</span>
                    </div>
                  </TableCell>
                  <TableCell className="text-sm text-muted-foreground">{member.profiles?.email}</TableCell>
                  <TableCell>
                    <Badge variant={member.role === "company_admin" ? "default" : "secondary"} className="text-[10px]">
                      {member.role === "company_admin" ? "ê´€ë¦¬ì" : member.role === "manager" ? "ë§¤ë‹ˆì €" : "ì§ì›"}
                    </Badge>
                  </TableCell>
                  <TableCell><Badge className="bg-green-500/10 text-green-600 border-green-500/20">ì¬ì§ì¤‘</Badge></TableCell>
                  <TableCell className="text-right">
                    <Button variant="ghost" size="sm">ìƒì„¸</Button>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </div>

        {/* ìƒì„¸ ìˆ˜ì • Sheet */}
        <Sheet open={isEditOpen} onOpenChange={setIsEditOpen}>
          <SheetContent className="sm:max-w-3xl p-0 overflow-hidden flex flex-col bg-card">
            <SheetHeader className="p-6 border-b bg-secondary/10">
              <SheetTitle className="text-2xl font-bold flex items-center gap-2">
                <User className="w-6 h-6 text-primary" /> ì„ì§ì› ì¸ì‚¬ ê¸°ë¡ ì¹´ë“œ
              </SheetTitle>
              <SheetDescription>ê°œì¸ ì¸ì ì‚¬í•­, ê¸‰ì—¬ ê³„ì¢Œ ë° ì¦ë¹™ ì„œë¥˜ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</SheetDescription>
            </SheetHeader>

            <ScrollArea className="flex-1 p-6">
              <div className="space-y-10 pb-10">
                {/* 1. ì¸ì‚¬ ì •ë³´ */}
                <section className="space-y-4">
                  <h4 className="text-sm font-bold flex items-center gap-2 text-primary uppercase tracking-wider">
                    <Briefcase className="w-4 h-4" /> ì¸ì‚¬ ì •ë³´
                  </h4>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="space-y-2"><Label>ë¶€ì„œ</Label><Input defaultValue={selectedMember?.department} /></div>
                    <div className="space-y-2"><Label>ì§í•¨</Label><Input defaultValue={selectedMember?.job_title} /></div>
                  </div>
                </section>

                <Separator />

                {/* 2. ì¦ë¹™ ì„œë¥˜ ì—…ë¡œë“œ */}
                <section className="space-y-4">
                  <h4 className="text-sm font-bold flex items-center gap-2 text-primary uppercase tracking-wider">
                    <FileImage className="w-4 h-4" /> ì¦ë¹™ ì„œë¥˜ ë° íŒŒì¼
                  </h4>
                  <div className="grid grid-cols-2 gap-6">
                    <div className="space-y-2">
                      <Label className="text-xs">ì‹ ë¶„ì¦ ì‚¬ë³¸</Label>
                      <label className="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-secondary/10 hover:bg-secondary/20 transition-colors">
                        <UploadCloud className="w-6 h-6 text-muted-foreground mb-2" />
                        <p className="text-[10px] text-muted-foreground">{idCardFile ? idCardFile.name : "íŒŒì¼ ì„ íƒ"}</p>
                        <input type="file" className="hidden" onChange={(e) => setIdCardFile(e.target.files?.[0] || null)} />
                      </label>
                    </div>
                    <div className="space-y-2">
                      <Label className="text-xs">í†µì¥ ì‚¬ë³¸</Label>
                      <label className="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-secondary/10 hover:bg-secondary/20 transition-colors">
                        <UploadCloud className="w-6 h-6 text-muted-foreground mb-2" />
                        <p className="text-[10px] text-muted-foreground">{bankbookFile ? bankbookFile.name : "íŒŒì¼ ì„ íƒ"}</p>
                        <input type="file" className="hidden" onChange={(e) => setBankbookFile(e.target.files?.[0] || null)} />
                      </label>
                    </div>
                  </div>
                </section>
              </div>
            </ScrollArea>

            <div className="p-6 border-t bg-secondary/20 flex gap-2">
              <Button variant="outline" className="flex-1" onClick={() => setIsEditOpen(false)}>ì·¨ì†Œ</Button>
              <Button variant="hero" className="flex-1" disabled={isUploading} onClick={handleSave}>
                {isUploading ? <Loader2 className="w-4 h-4 animate-spin mr-2" /> : "ì €ì¥í•˜ê¸°"}
              </Button>
            </div>
          </SheetContent>
        </Sheet>

        {/* ì§ì› ì´ˆëŒ€ ë‹¤ì´ì–¼ë¡œê·¸ */}
        <Dialog open={isInviteDialogOpen} onOpenChange={setIsInviteDialogOpen}>
          <DialogContent className="sm:max-w-md">
            <DialogHeader>
              <DialogTitle className="flex items-center gap-2">
                <UserPlus className="w-5 h-5 text-primary" /> ì§ì› ì´ˆëŒ€í•˜ê¸°
              </DialogTitle>
              <DialogDescription>
                ì´ë©”ì¼ ë°œì†¡ì´ ì œí•œë  ê²½ìš°, ì´ˆëŒ€ ì™„ë£Œ í›„ ë§í¬ë¥¼ ì§ì ‘ ë³µì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
              </DialogDescription>
            </DialogHeader>
            <div className="space-y-4 py-4">
              <div className="space-y-2">
                <Label htmlFor="invite-email">ì´ë©”ì¼ ì£¼ì†Œ *</Label>
                <Input
                  id="invite-email"
                  type="email"
                  placeholder="ë³¸ì¸ ì´ë©”ì¼ë¡œ í…ŒìŠ¤íŠ¸ ê¶Œì¥"
                  value={inviteForm.email}
                  onChange={(e) => setInviteForm({ ...inviteForm, email: e.target.value })}
                />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label>ê¶Œí•œ</Label>
                  <Select value={inviteForm.role} onValueChange={(val) => setInviteForm({ ...inviteForm, role: val })}>
                    <SelectTrigger><SelectValue /></SelectTrigger>
                    <SelectContent>
                      <SelectItem value="employee">ì‚¬ì›</SelectItem>
                      <SelectItem value="manager">ë§¤ë‹ˆì €</SelectItem>
                      <SelectItem value="company_admin">ê´€ë¦¬ì</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                <div className="space-y-2">
                  <Label>ë¶€ì„œ</Label>
                  <Input placeholder="ë¶€ì„œëª…" value={inviteForm.department} onChange={(e) => setInviteForm({ ...inviteForm, department: e.target.value })} />
                </div>
              </div>
            </div>
            <DialogFooter>
              <Button variant="outline" onClick={() => setIsInviteDialogOpen(false)}>ì·¨ì†Œ</Button>
              <Button onClick={handleSendInvite} disabled={inviteLoading || !inviteForm.email}>
                {inviteLoading ? <Loader2 className="w-4 h-4 mr-2 animate-spin" /> : <Send className="w-4 h-4 mr-2" />}
                ì´ˆëŒ€ ë° ë§í¬ ìƒì„±
              </Button>
            </DialogFooter>
          </DialogContent>
        </Dialog>
      </main>
    </div>
  );
};

export default HRManagement;


============================================================
File Path: src/pages/admin/KeywordManagement.tsx
============================================================
import { useState, useEffect } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import {
  Table, TableBody, TableCell, TableHead, TableHeader, TableRow,
} from "@/components/ui/table";
import {
  Sheet, SheetContent, SheetHeader, SheetTitle, SheetFooter, SheetClose
} from "@/components/ui/sheet";
import {
  Select, SelectContent, SelectItem, SelectTrigger, SelectValue
} from "@/components/ui/select";
import {
  AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent,
  AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { Switch } from "@/components/ui/switch";
import { toast } from "sonner";
import {
  Hash, Plus, Search, Loader2, Save, Edit2, Trash2, AlertCircle, Tags, ArrowUpDown
} from "lucide-react";

interface Keyword {
  id: string;
  tenant_id: string;
  keyword: string;
  category: string | null;
  priority: number;
  is_active: boolean;
  created_at: string;
}

const categoryOptions = ["ë¸Œëœë“œ", "ì œí’ˆ", "ì´ë²¤íŠ¸", "ì¸ë¬¼", "ê¸°íƒ€"];

const KeywordManagement = () => {
  const { currentTenant, isCompanyAdmin, isSuperAdmin } = useAuth();
  const [keywords, setKeywords] = useState<Keyword[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState("");
  const [filterCategory, setFilterCategory] = useState("");

  const [isSheetOpen, setIsSheetOpen] = useState(false);
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [currentKeyword, setCurrentKeyword] = useState<Keyword | null>(null);
  const [isSaving, setIsSaving] = useState(false);

  const [formData, setFormData] = useState({
    keyword: "",
    category: "",
    priority: 0,
    is_active: true,
  });

  const fetchKeywords = async () => {
    if (!currentTenant) return;
    setLoading(true);

    let query = supabase
      .from("keywords")
      .select("*")
      .eq("tenant_id", currentTenant.tenant_id)
      .order("priority", { ascending: false });

    if (searchQuery) {
      query = query.ilike("keyword", `%${searchQuery}%`);
    }
    if (filterCategory && filterCategory !== "ALL") {
      query = query.eq("category", filterCategory);
    }

    const { data, error } = await query;
    if (error) {
      toast.error("í‚¤ì›Œë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    } else {
      setKeywords(data || []);
    }
    setLoading(false);
  };

  useEffect(() => {
    fetchKeywords();
  }, [currentTenant, searchQuery, filterCategory]);

  const handleSave = async () => {
    if (!formData.keyword || !currentTenant) {
      toast.error("í‚¤ì›Œë“œëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.");
      return;
    }
    setIsSaving(true);

    try {
      const payload = {
        tenant_id: currentTenant.tenant_id,
        keyword: formData.keyword,
        category: formData.category || null,
        priority: formData.priority,
        is_active: formData.is_active,
      };

      if (currentKeyword) {
        const { error } = await supabase
          .from("keywords")
          .update(payload)
          .eq("id", currentKeyword.id);
        if (error) throw error;
        toast.success("í‚¤ì›Œë“œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
      } else {
        const { error } = await supabase
          .from("keywords")
          .insert(payload);
        if (error) throw error;
        toast.success("í‚¤ì›Œë“œê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }
      setIsSheetOpen(false);
      fetchKeywords();
    } catch (error: any) {
      toast.error(`ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setIsSaving(false);
    }
  };

  const handleDelete = async () => {
    if (!currentKeyword) return;
    setIsSaving(true);
    try {
      const { error } = await supabase
        .from("keywords")
        .delete()
        .eq("id", currentKeyword.id);
      if (error) throw error;
      toast.success("í‚¤ì›Œë“œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
      setIsDeleteDialogOpen(false);
      fetchKeywords();
    } catch (error: any) {
      toast.error(`ì‚­ì œ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setIsSaving(false);
      setCurrentKeyword(null);
    }
  };

  const handleNewKeyword = () => {
    setCurrentKeyword(null);
    setFormData({ keyword: "", category: "", priority: 0, is_active: true });
    setIsSheetOpen(true);
  };

  const handleEditKeyword = (kw: Keyword) => {
    setCurrentKeyword(kw);
    setFormData({
      keyword: kw.keyword,
      category: kw.category || "",
      priority: kw.priority,
      is_active: kw.is_active,
    });
    setIsSheetOpen(true);
  };

  if (!isCompanyAdmin) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        <div className="text-center space-y-4">
          <AlertCircle className="w-12 h-12 text-destructive mx-auto" />
          <p className="text-muted-foreground font-medium">ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</p>
          <Button onClick={() => window.history.back()} variant="outline">ë’¤ë¡œ ê°€ê¸°</Button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />
      <main className="pt-24 pb-16 px-4 max-w-7xl mx-auto">
        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
          <div>
            <h1 className="text-3xl font-bold tracking-tight flex items-center gap-3">
              <Tags className="w-8 h-8 text-primary" /> í‚¤ì›Œë“œ ê´€ë¦¬
            </h1>
            <p className="text-muted-foreground mt-1">
              {isSuperAdmin ? "ì „ì²´ íšŒì‚¬" : currentTenant?.tenant.name}ì˜ ëª¨ë‹ˆí„°ë§ í‚¤ì›Œë“œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
            </p>
          </div>
          <Button variant="hero" className="gap-2" size="lg" onClick={handleNewKeyword}>
            <Plus className="w-5 h-5" /> í‚¤ì›Œë“œ ì¶”ê°€
          </Button>
        </div>

        {/* ìš”ì•½ ì¹´ë“œ */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
          <Card className="glass-card shadow-sm border-primary/10">
            <CardContent className="pt-6">
              <div className="flex items-center justify-between">
                <p className="text-sm font-medium text-muted-foreground">ì „ì²´ í‚¤ì›Œë“œ</p>
                <Hash className="w-4 h-4 text-primary" />
              </div>
              <div className="text-2xl font-bold mt-2">{keywords.length}ê°œ</div>
            </CardContent>
          </Card>
          <Card className="glass-card shadow-sm border-green-500/10">
            <CardContent className="pt-6">
              <div className="flex items-center justify-between">
                <p className="text-sm font-medium text-muted-foreground">í™œì„± í‚¤ì›Œë“œ</p>
                <Tags className="w-4 h-4 text-green-500" />
              </div>
              <div className="text-2xl font-bold mt-2">{keywords.filter(k => k.is_active).length}ê°œ</div>
            </CardContent>
          </Card>
          <Card className="glass-card shadow-sm border-amber-500/10">
            <CardContent className="pt-6">
              <div className="flex items-center justify-between">
                <p className="text-sm font-medium text-muted-foreground">ë¹„í™œì„± í‚¤ì›Œë“œ</p>
                <ArrowUpDown className="w-4 h-4 text-amber-500" />
              </div>
              <div className="text-2xl font-bold mt-2">{keywords.filter(k => !k.is_active).length}ê°œ</div>
            </CardContent>
          </Card>
        </div>

        {/* í•„í„°/ê²€ìƒ‰ */}
        <Card className="glass-card shadow-sm border border-border mb-8">
          <CardContent className="pt-4 flex flex-col sm:flex-row gap-4">
            <div className="relative flex-1">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
              <Input
                placeholder="í‚¤ì›Œë“œ ê²€ìƒ‰"
                className="pl-9 bg-secondary/50 border-none h-10 text-sm"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
              />
            </div>
            <Select onValueChange={setFilterCategory} value={filterCategory}>
              <SelectTrigger className="w-full sm:w-[150px] bg-secondary/50 border-none h-10">
                <SelectValue placeholder="ì¹´í…Œê³ ë¦¬ í•„í„°" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="ALL">ì „ì²´</SelectItem>
                {categoryOptions.map(c => <SelectItem key={c} value={c}>{c}</SelectItem>)}
              </SelectContent>
            </Select>
            <Button variant="outline" onClick={() => { setSearchQuery(""); setFilterCategory(""); }}>
              ì´ˆê¸°í™”
            </Button>
          </CardContent>
        </Card>

        {/* í…Œì´ë¸” */}
        <div className="glass-card overflow-hidden shadow-sm border border-border">
          <Table>
            <TableHeader className="bg-secondary/50">
              <TableRow>
                <TableHead className="w-[250px]">í‚¤ì›Œë“œ</TableHead>
                <TableHead>ì¹´í…Œê³ ë¦¬</TableHead>
                <TableHead className="text-center">ìš°ì„ ìˆœìœ„</TableHead>
                <TableHead className="text-center">ìƒíƒœ</TableHead>
                <TableHead className="text-right w-[100px]">ì•¡ì…˜</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {loading ? (
                <TableRow><TableCell colSpan={5} className="h-32 text-center"><Loader2 className="w-8 h-8 animate-spin mx-auto text-primary" /></TableCell></TableRow>
              ) : keywords.length > 0 ? (
                keywords.map((kw) => (
                  <TableRow key={kw.id} className="hover:bg-secondary/30 transition-colors">
                    <TableCell className="font-semibold">{kw.keyword}</TableCell>
                    <TableCell>
                      {kw.category ? (
                        <Badge variant="outline">{kw.category}</Badge>
                      ) : (
                        <span className="text-muted-foreground text-xs">-</span>
                      )}
                    </TableCell>
                    <TableCell className="text-center">{kw.priority}</TableCell>
                    <TableCell className="text-center">
                      <Badge variant={kw.is_active ? "default" : "secondary"}>
                        {kw.is_active ? "í™œì„±" : "ë¹„í™œì„±"}
                      </Badge>
                    </TableCell>
                    <TableCell className="text-right">
                      <Button variant="ghost" size="icon" className="w-8 h-8" onClick={() => handleEditKeyword(kw)}>
                        <Edit2 className="w-4 h-4 text-blue-500" />
                      </Button>
                      <Button variant="ghost" size="icon" className="w-8 h-8 text-destructive" onClick={() => { setCurrentKeyword(kw); setIsDeleteDialogOpen(true); }}>
                        <Trash2 className="w-4 h-4" />
                      </Button>
                    </TableCell>
                  </TableRow>
                ))
              ) : (
                <TableRow><TableCell colSpan={5} className="h-32 text-center text-muted-foreground">ë“±ë¡ëœ í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤.</TableCell></TableRow>
              )}
            </TableBody>
          </Table>
        </div>
      </main>

      {/* ì¶”ê°€/ìˆ˜ì • Sheet */}
      <Sheet open={isSheetOpen} onOpenChange={setIsSheetOpen}>
        <SheetContent className="sm:max-w-md p-0 overflow-hidden flex flex-col">
          <SheetHeader className="p-6 border-b">
            <SheetTitle className="text-xl font-bold flex items-center gap-2">
              <Tags className="w-5 h-5 text-primary" />
              {currentKeyword ? "í‚¤ì›Œë“œ ìˆ˜ì •" : "ìƒˆ í‚¤ì›Œë“œ ë“±ë¡"}
            </SheetTitle>
          </SheetHeader>
          <div className="p-6 space-y-6 overflow-y-auto flex-1">
            <div className="space-y-2">
              <Label htmlFor="keyword">í‚¤ì›Œë“œ *</Label>
              <Input
                id="keyword"
                placeholder="ì˜ˆ: ì‚¼ì„±ì „ì, ê°¤ëŸ­ì‹œ"
                value={formData.keyword}
                onChange={(e) => setFormData({ ...formData, keyword: e.target.value })}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="category">ì¹´í…Œê³ ë¦¬</Label>
              <Select value={formData.category} onValueChange={(val) => setFormData({ ...formData, category: val })}>
                <SelectTrigger id="category">
                  <SelectValue placeholder="ì¹´í…Œê³ ë¦¬ ì„ íƒ" />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="">ì„ íƒ ì•ˆ í•¨</SelectItem>
                  {categoryOptions.map(c => <SelectItem key={c} value={c}>{c}</SelectItem>)}
                </SelectContent>
              </Select>
            </div>
            <div className="space-y-2">
              <Label htmlFor="priority">ìš°ì„ ìˆœìœ„ (ë†’ì„ìˆ˜ë¡ ë¨¼ì € í‘œì‹œ)</Label>
              <Input
                id="priority"
                type="number"
                value={formData.priority}
                onChange={(e) => setFormData({ ...formData, priority: parseInt(e.target.value) || 0 })}
              />
            </div>
            <div className="flex items-center justify-between">
              <Label htmlFor="is_active">í™œì„± ìƒíƒœ</Label>
              <Switch
                id="is_active"
                checked={formData.is_active}
                onCheckedChange={(checked) => setFormData({ ...formData, is_active: checked })}
              />
            </div>
          </div>
          <SheetFooter className="p-6 border-t">
            <SheetClose asChild>
              <Button variant="outline" disabled={isSaving}>ì·¨ì†Œ</Button>
            </SheetClose>
            <Button onClick={handleSave} disabled={isSaving || !formData.keyword}>
              {isSaving ? <Loader2 className="w-4 h-4 mr-2 animate-spin" /> : <Save className="w-4 h-4 mr-2" />}
              {currentKeyword ? "ìˆ˜ì • ì™„ë£Œ" : "ë“±ë¡"}
            </Button>
          </SheetFooter>
        </SheetContent>
      </Sheet>

      {/* ì‚­ì œ í™•ì¸ Dialog */}
      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="text-destructive font-bold text-xl">í‚¤ì›Œë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</AlertDialogTitle>
            <AlertDialogDescription>
              "{currentKeyword?.keyword}" í‚¤ì›Œë“œê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel disabled={isSaving}>ì·¨ì†Œ</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} disabled={isSaving} className="bg-destructive text-destructive-foreground hover:bg-destructive/90">
              {isSaving ? <Loader2 className="w-4 h-4 animate-spin mr-2" /> : null}ì‚­ì œ
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
};

export default KeywordManagement;



============================================================
File Path: src/pages/admin/MediaPitching.tsx
============================================================
import { useState, useEffect } from "react";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Badge } from "@/components/ui/badge";
import { Checkbox } from "@/components/ui/checkbox";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Separator } from "@/components/ui/separator";
import { Card } from "@/components/ui/card";
import { supabase } from "@/integrations/supabase/client";
import { toast } from "sonner";
import { 
  Send, Users, FileText, CheckCircle2, AlertCircle, 
  Search, Filter, Loader2, RefreshCw, Mail, Sparkles, XCircle 
} from "lucide-react";

// íƒ€ì… ì •ì˜
interface Reporter {
  id: string;
  media_company: string;
  reporter_name: string;
  contact_email: string;
  purpose: string | null;
}

interface SendingLog {
  id: string;
  reporter_name: string;
  email: string;
  status: "pending" | "success" | "failed";
  timestamp: string;
}

const MediaPitching = () => {
  // --- ìƒíƒœ ê´€ë¦¬ ---
  const [reporters, setReporters] = useState<Reporter[]>([]);
  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());
  const [searchQuery, setSearchQuery] = useState("");
  const [emailSubject, setEmailSubject] = useState("");
  const [emailBody, setEmailBody] = useState(`ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ, {{ì–¸ë¡ ì‚¬ëª…}} {{ê¸°ìëª…}} ê¸°ìë‹˜.\n\n[ë³´ë„ìë£Œ í•µì‹¬ ë‚´ìš© ìš”ì•½]\n\nê·€ì‚¬ì˜ ë¬´ê¶í•œ ë°œì „ì„ ê¸°ì›í•©ë‹ˆë‹¤.`);
  
  // ë°œì†¡ ê´€ë ¨ ìƒíƒœ
  const [isSending, setIsSending] = useState(false);
  const [sendingLogs, setSendingLogs] = useState<SendingLog[]>([]);
  const [showResults, setShowResults] = useState(false);

  // AI ì²˜ë¦¬ ìƒíƒœ
  const [isPolishing, setIsPolishing] = useState(false);

  // --- ë°ì´í„° ë¡œë“œ ---
  useEffect(() => {
    const fetchReporters = async () => {
      const { data, error } = await supabase
        .from("press_contacts")
        .select("*")
        .order("media_company");
      
      if (data) setReporters(data);
    };
    fetchReporters();
  }, []);

  // --- í•„í„°ë§ ë¡œì§ ---
  const filteredReporters = reporters.filter(r => 
    r.media_company.includes(searchQuery) || 
    r.reporter_name.includes(searchQuery) ||
    (r.purpose && r.purpose.includes(searchQuery))
  );

  // --- í•¸ë“¤ëŸ¬ ---
  const toggleSelection = (id: string) => {
    const newSet = new Set(selectedIds);
    if (newSet.has(id)) newSet.delete(id);
    else newSet.add(id);
    setSelectedIds(newSet);
  };

  const toggleSelectAll = () => {
    if (selectedIds.size === filteredReporters.length) {
      setSelectedIds(new Set());
    } else {
      setSelectedIds(new Set(filteredReporters.map(r => r.id)));
    }
  };

  // --- AI ë¬¸ì¥ ë‹¤ë“¬ê¸° í•¸ë“¤ëŸ¬ (Edge Function í˜¸ì¶œ) ---
  const handleAIPolish = async () => {
    // ë³¸ë¬¸ì´ ë¹„ì–´ìˆìœ¼ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
    if (!emailBody.trim()) {
      toast.error("ë‹¤ë“¬ì„ ë‚´ìš©ì„ ë³¸ë¬¸ì— ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    setIsPolishing(true);
    
    try {
      // Supabase Edge Function í˜¸ì¶œ ('polish-text')
      const { data, error } = await supabase.functions.invoke('polish-text', {
        body: { text: emailBody }
      });

      if (error) {
        throw new Error(error.message || "AI ì„œë²„ í†µì‹  ì˜¤ë¥˜");
      }

      // ê²°ê³¼ ì²˜ë¦¬
      if (data && data.result) {
        setEmailBody(data.result); // ë³¸ë¬¸ì„ AI ê²°ê³¼ë¡œ êµì²´
        toast.success("AIê°€ ë¬¸ì¥ì„ ë” ì„¸ë ¨ë˜ê²Œ ë‹¤ë“¬ì—ˆìŠµë‹ˆë‹¤!");
      } else {
        throw new Error("AI ì‘ë‹µì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      }

    } catch (error: any) {
      console.error("AI Polish Error:", error);
      toast.error(`AI ìš”ì²­ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setIsPolishing(false);
    }
  };

  // --- ë°œì†¡ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” Edge Function í˜¸ì¶œ) ---
  const handleBulkSend = async () => {
    if (!emailSubject.trim() || !emailBody.trim()) {
      toast.error("ì œëª©ê³¼ ë³¸ë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }
    if (selectedIds.size === 0) {
      toast.error("ë°œì†¡í•  ê¸°ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
      return;
    }

    setShowResults(true);
    setIsSending(true);
    
    // 1. ë°œì†¡ ëŒ€ê¸° ëª©ë¡ ìƒì„±
    const targetReporters = reporters.filter(r => selectedIds.has(r.id));
    const initialLogs: SendingLog[] = targetReporters.map(r => ({
      id: r.id,
      reporter_name: r.reporter_name,
      email: r.contact_email,
      status: "pending",
      timestamp: new Date().toLocaleTimeString()
    }));
    setSendingLogs(initialLogs);

    // 2. ìˆœì°¨ ë°œì†¡ ì‹œë®¬ë ˆì´ì…˜
    for (let i = 0; i < initialLogs.length; i++) {
      await new Promise(resolve => setTimeout(resolve, 800)); // 0.8ì´ˆ ë”œë ˆì´ ì‹œë®¬ë ˆì´ì…˜

      setSendingLogs(prev => {
        const newLogs = [...prev];
        // 90% ì„±ê³µ í™•ë¥  ì‹œë®¬ë ˆì´ì…˜
        const isSuccess = Math.random() > 0.1;
        newLogs[i] = { 
          ...newLogs[i], 
          status: isSuccess ? "success" : "failed",
          timestamp: new Date().toLocaleTimeString()
        };
        return newLogs;
      });
    }

    setIsSending(false);
    toast.success("ë°œì†¡ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
  };

  return (
    <div className="min-h-screen bg-background flex flex-col">
      <Header />
      
      <main className="flex-1 pt-16 px-4 pb-4 h-[calc(100vh-theme(spacing.4))]">
        <div className="h-full max-w-[1600px] mx-auto flex flex-col">
          {/* Top Bar */}
          <div className="flex items-center justify-between py-4 shrink-0">
            <div>
              <h1 className="text-2xl font-bold flex items-center gap-2">
                <Mail className="w-6 h-6 text-primary" /> ë¯¸ë””ì–´ í”¼ì¹­ ì„¼í„°
              </h1>
              <p className="text-muted-foreground text-sm">ìŠˆí¼ ì–´ë“œë¯¼ì´ ê´€ë¦¬í•˜ëŠ” ë¯¸ë””ì–´ í’€ì„ í™œìš©í•´ ë³´ë„ìë£Œë¥¼ ë°°í¬í•©ë‹ˆë‹¤.</p>
            </div>
            <div className="flex gap-2">
               <Button variant="outline" onClick={() => {setShowResults(false); setSendingLogs([]);}}>
                <RefreshCw className="w-4 h-4 mr-2" /> ì´ˆê¸°í™”
               </Button>
            </div>
          </div>

          {/* 3-Column Layout */}
          <div className="flex-1 grid grid-cols-1 lg:grid-cols-12 gap-4 min-h-0">
            
            {/* Panel 1: ì‘ì„± (Write) - 4/12 */}
            <Card className="lg:col-span-4 flex flex-col overflow-hidden border-t-4 border-t-primary shadow-sm h-full">
              <div className="p-4 border-b bg-secondary/20 flex justify-between items-center shrink-0">
                <h3 className="font-bold flex items-center gap-2">
                  <FileText className="w-4 h-4 text-primary" /> 1. ë³´ë„ìë£Œ ì‘ì„±
                </h3>
                <Badge variant="outline" className="text-xs">Variable Supported</Badge>
              </div>
              <div className="flex-1 p-4 flex flex-col gap-4 overflow-y-auto">
                <div className="space-y-2">














                  
                  <label className="text-sm font-medium">ì´ë©”ì¼ ì œëª©</label>
                  <Input 
                    placeholder="[ë³´ë„ìë£Œ] OOO ë°°ìš° ì „ì† ê³„ì•½ ì²´ê²° ê¸°ì‚¬" 
                    value={emailSubject}
                    onChange={(e) => setEmailSubject(e.target.value)}
                    className="font-medium"
                  />
                </div>
                <div className="space-y-2 flex-1 flex flex-col">
                  <div className="flex justify-between items-center">
                    <label className="text-sm font-medium">ì´ë©”ì¼ ë³¸ë¬¸</label>
                    <Button 
                      variant="ghost" 
                      size="sm" 
                      className="h-6 text-xs text-purple-600 hover:text-purple-700 hover:bg-purple-50"
                      onClick={handleAIPolish} // AI í•¨ìˆ˜ ì—°ê²°
                      disabled={isPolishing}   // ë¡œë”© ì¤‘ ë¹„í™œì„±í™”
                    >
                      {isPolishing ? (
                        <>
                          <Loader2 className="w-3 h-3 mr-1 animate-spin" /> ë‹¤ë“¬ëŠ” ì¤‘...
                        </>
                      ) : (
                        <>
                          <Sparkles className="w-3 h-3 mr-1" /> AI ë¬¸ì¥ ë‹¤ë“¬ê¸°
                        </>
                      )}
                    </Button>
                  </div>
                  <Textarea 
                    placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." 
                    className="flex-1 min-h-[300px] resize-none leading-relaxed"
                    value={emailBody}
                    onChange={(e) => setEmailBody(e.target.value)}
                    disabled={isPolishing} // AI ì²˜ë¦¬ ì¤‘ ì…ë ¥ ë°©ì§€
                  />
                  <div className="text-xs text-muted-foreground bg-secondary/50 p-2 rounded">
                    <span className="font-bold">Tip:</span> <code>{'{{ê¸°ìëª…}}'}</code>, <code>{'{{ì–¸ë¡ ì‚¬ëª…}}'}</code>ì„ ì…ë ¥í•˜ë©´ ë°œì†¡ ì‹œ ìë™ìœ¼ë¡œ ëŒ€ìƒì˜ ì •ë³´ë¡œ ì¹˜í™˜ë©ë‹ˆë‹¤.
                  </div>
                </div>
                <div className="pt-2 border-t">
                  <label className="text-sm font-medium mb-2 block">ì²¨ë¶€íŒŒì¼</label>
                  <div className="border-2 border-dashed rounded-lg p-4 text-center text-sm text-muted-foreground hover:bg-secondary/50 cursor-pointer transition-colors">
                    í´ë¦­í•˜ì—¬ ë³´ë„ìë£Œ(PDF, Word) ë° ì´ë¯¸ì§€ ì—…ë¡œë“œ
                  </div>
                </div>
              </div>
            </Card>

            {/* Panel 2: ì„ íƒ (Select) - 4/12 */}
            <Card className="lg:col-span-4 flex flex-col overflow-hidden border-t-4 border-t-blue-500 shadow-sm h-full">
              <div className="p-4 border-b bg-secondary/20 shrink-0">
                <h3 className="font-bold flex items-center gap-2 mb-3">
                  <Users className="w-4 h-4 text-blue-500" /> 2. ìˆ˜ì‹  ê¸°ì ì„ íƒ
                </h3>
                <div className="flex gap-2">
                  <div className="relative flex-1">
                    <Search className="absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground" />
                    <Input 
                      placeholder="ì–¸ë¡ ì‚¬, ê¸°ìëª… ê²€ìƒ‰" 
                      className="pl-8 h-9 text-sm"
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                    />
                  </div>
                  <Button variant="ghost" size="icon" className="h-9 w-9 shrink-0">
                    <Filter className="w-4 h-4" />
                  </Button>
                </div>
              </div>

              {/* List Header */}
              <div className="px-4 py-2 border-b bg-white flex items-center justify-between text-sm shrink-0">
                <div className="flex items-center gap-2">
                  <Checkbox 
                    checked={selectedIds.size === filteredReporters.length && filteredReporters.length > 0}
                    onCheckedChange={toggleSelectAll}
                  />
                  <span className="font-medium text-muted-foreground">ì „ì²´ ì„ íƒ ({filteredReporters.length})</span>
                </div>
                <span className="text-blue-600 font-bold">{selectedIds.size}ëª… ì„ íƒë¨</span>
              </div>

              <ScrollArea className="flex-1 bg-slate-50">
                <div className="divide-y divide-border">
                  {filteredReporters.length === 0 ? (
                    <div className="p-8 text-center text-muted-foreground text-sm">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
                  ) : (
                    filteredReporters.map((reporter) => (
                      <div 
                        key={reporter.id} 
                        className={`p-3 flex items-start gap-3 transition-colors hover:bg-white ${selectedIds.has(reporter.id) ? 'bg-blue-50/60' : ''}`}
                        onClick={() => toggleSelection(reporter.id)}
                      >
                        <Checkbox 
                          checked={selectedIds.has(reporter.id)}
                          className="mt-1"
                        />
                        <div className="flex-1 min-w-0 cursor-pointer">
                          <div className="flex items-center justify-between mb-0.5">
                            <span className="font-semibold text-sm truncate">{reporter.media_company}</span>
                            {reporter.purpose && <Badge variant="secondary" className="text-[10px] h-5">{reporter.purpose}</Badge>}
                          </div>
                          <div className="text-sm font-medium">{reporter.reporter_name} ê¸°ì</div>
                          <div className="text-xs text-muted-foreground truncate">{reporter.contact_email}</div>
                        </div>
                      </div>
                    ))
                  )}
                </div>
              </ScrollArea>
            </Card>

            {/* Panel 3: ê²°ê³¼ (Result) - 4/12 */}
            <Card className="lg:col-span-4 flex flex-col overflow-hidden border-t-4 border-t-green-500 shadow-sm h-full">
              <div className="p-4 border-b bg-secondary/20 shrink-0">
                <h3 className="font-bold flex items-center gap-2">
                  {showResults ? (
                     <><Send className="w-4 h-4 text-green-600 animate-pulse" /> 3. ë°œì†¡ í˜„í™©</>
                  ) : (
                     <><CheckCircle2 className="w-4 h-4 text-green-600" /> 3. ë°œì†¡ ë° ê²°ê³¼</>
                  )}
                </h3>
              </div>

              {/* A. ë°œì†¡ ì „ ë¯¸ë¦¬ë³´ê¸° ìƒíƒœ */}
              {!showResults ? (
                <div className="flex-1 p-6 flex flex-col items-center justify-center text-center space-y-4 bg-slate-50/50">
                  <div className="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-2">
                    <Send className="w-8 h-8 text-green-600 ml-1" />
                  </div>
                  <div>
                    <h4 className="text-lg font-bold">ë°œì†¡ ì¤€ë¹„ ì™„ë£Œ</h4>
                    <p className="text-sm text-muted-foreground mt-1">
                      ì´ <span className="text-foreground font-bold">{selectedIds.size}ëª…</span>ì˜ ê¸°ìì—ê²Œ ì´ë©”ì¼ì„ ë°œì†¡í•©ë‹ˆë‹¤.<br/>
                      ë‚´ìš©ì„ ë§ˆì§€ë§‰ìœ¼ë¡œ í™•ì¸í•´ì£¼ì„¸ìš”.
                    </p>
                  </div>
                  
                  <div className="w-full max-w-xs bg-white p-4 rounded-lg border text-left text-xs shadow-sm mt-4">
                    <p className="font-bold mb-1 truncate">ë°›ëŠ”ì‚¬ëŒ: {Array.from(selectedIds).length}ëª… (ê°œë³„ ë°œì†¡)</p>
                    <p className="font-bold mb-2 truncate">ì œëª©: {emailSubject || "(ì œëª© ì—†ìŒ)"}</p>
                    <div className="text-muted-foreground line-clamp-3">
                      {emailBody.replace("{{ê¸°ìëª…}}", "í™ê¸¸ë™").replace("{{ì–¸ë¡ ì‚¬ëª…}}", "OOì¼ë³´")}
                    </div>
                  </div>

                  <Button 
                    size="lg" 
                    className="w-full max-w-xs mt-6 bg-green-600 hover:bg-green-700"
                    onClick={handleBulkSend}
                    disabled={selectedIds.size === 0}
                  >
                    ì¼ê´„ ë°œì†¡ ì‹œì‘
                  </Button>
                </div>
              ) : (
                /* B. ë°œì†¡ ì¤‘/ì™„ë£Œ ë¡œê·¸ ìƒíƒœ */
                <div className="flex-1 flex flex-col h-full">
                  <div className="p-3 bg-slate-100 text-xs font-medium flex justify-between shrink-0">
                    <span>ì²˜ë¦¬ ìƒíƒœ: {isSending ? "ì „ì†¡ ì¤‘..." : "ì™„ë£Œ"}</span>
                    <span>
                      ì„±ê³µ <span className="text-green-600">{sendingLogs.filter(l => l.status === 'success').length}</span> / 
                      ì‹¤íŒ¨ <span className="text-red-600">{sendingLogs.filter(l => l.status === 'failed').length}</span>
                    </span>
                  </div>
                  <ScrollArea className="flex-1">
                    <div className="divide-y divide-border">
                      {sendingLogs.map((log) => (
                        <div key={log.id} className="p-3 flex items-center justify-between text-sm">
                          <div className="flex items-center gap-3">
                            {log.status === "pending" && <Loader2 className="w-4 h-4 text-muted-foreground animate-spin" />}
                            {log.status === "success" && <CheckCircle2 className="w-4 h-4 text-green-500" />}
                            {log.status === "failed" && <XCircle className="w-4 h-4 text-red-500" />}
                            <div>
                              <div className="font-medium">{log.reporter_name}</div>
                              <div className="text-xs text-muted-foreground">{log.email}</div>
                            </div>
                          </div>
                          <div className="text-xs text-right">
                             <span className={`
                                px-2 py-0.5 rounded-full text-[10px] font-bold
                                ${log.status === 'success' ? 'bg-green-100 text-green-700' : 
                                  log.status === 'failed' ? 'bg-red-100 text-red-700' : 'bg-slate-100 text-slate-500'}
                             `}>
                               {log.status === 'pending' ? 'ëŒ€ê¸°ì¤‘' : log.status === 'success' ? 'ë°œì†¡ì„±ê³µ' : 'ì˜¤ë¥˜'}
                             </span>
                             <div className="text-[10px] text-muted-foreground mt-0.5">{log.timestamp}</div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </ScrollArea>
                  {!isSending && (
                    <div className="p-4 border-t bg-white shrink-0">
                      <Button className="w-full" variant="outline" onClick={() => setShowResults(false)}>
                        ì¶”ê°€ ë°œì†¡í•˜ê¸°
                      </Button>
                    </div>
                  )}
                </div>
              )}
            </Card>
          </div>
        </div>
      </main>
    </div>
  );
};

export default MediaPitching;


============================================================
File Path: src/pages/admin/ProfileManagement.tsx
============================================================
import { useState, useEffect, useRef } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { useReactToPrint } from "react-to-print";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Separator } from "@/components/ui/separator";
import { Badge } from "@/components/ui/badge";
import { Loader2, Printer, Search, User, Briefcase, FileText, CheckCircle2 } from "lucide-react";
import { toast } from "sonner";

// --- Types ---
interface Artist {
  id: string;
  name: string;
  birth_date: string;
  phone_mobile?: string; // DB ì»¬ëŸ¼ì´ ì—†ë‹¤ë©´ contact_phone ë“±ìœ¼ë¡œ ë§¤í•‘ í•„ìš”. ì—¬ê¸°ì„  ì„ì‹œ.
  address: string;
  resident_number: string; // ì£¼ë¯¼ë²ˆí˜¸
  id_card_url: string;     // ì‹ ë¶„ì¦ ì´ë¯¸ì§€
  id_card_masked_url: string;
}

interface Employee {
  id: string;
  full_name: string;
  phone: string;
  email: string;
  birth_date?: string; // í”„ë¡œí•„ í…Œì´ë¸”ì— ì—†ë‹¤ë©´ ì¶”ê°€ ì…ë ¥ í•„ìš”
  department?: string;
  id_card_url?: string; // ì§ì› ì‹ ë¶„ì¦ (ê°€ì •)
}

// --- Document Component (ì¸ì‡„ìš© í…œí”Œë¦¿) ---
const PortalDocTemplate = ({ 
  type, 
  artist, 
  employee, 
  tenantName,
  extraInfo 
}: { 
  type: "naver" | "daum"; 
  artist: Artist | null; 
  employee: Employee | null; 
  tenantName: string;
  extraInfo: { empBirth: string; empAddress: string; relation: string; date: string }
}) => {
  if (!artist || !employee) return <div className="p-10 text-center">ì •ë³´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>;

  const commonTableStyle = "w-full border-collapse border border-black text-sm mb-6";
  const thStyle = "border border-black bg-gray-100 p-2 text-center font-bold break-keep";
  const tdStyle = "border border-black p-2";

  // ë‚ ì§œ í¬ë§·
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth() + 1;
  const day = today.getDate();
  
  // ìœ„ì„ ê¸°ê°„ ê³„ì‚° (ê¸°ë³¸ 1ë…„ ~ 3ë…„)
  const startDate = `${year}ë…„ ${month}ì›” ${day}ì¼`;
  const endDate = `${year + 3}ë…„ ${month}ì›” ${day}ì¼`;

  return (
    <div className="w-[210mm] min-h-[297mm] bg-white text-black font-serif box-border p-[20mm] leading-normal relative">
      
      {/* --- PAGE 1: ìœ„ì„ì¥ --- */}
      <div className="h-[297mm] flex flex-col relative">
        <h1 className="text-3xl font-bold text-center mb-10 underline underline-offset-8">
          {type === "daum" ? "ìœ„ ì„ ì¥" : "ì¸ë¬¼ì •ë³´ ë“± ê´€ë¦¬ ìœ„ì„ì¥"}
        </h1>

        {type === "daum" ? (
          /* === DAUM FORM === */
          <>
            <p className="mb-2 text-sm font-bold text-red-600"># í¸ì§‘ëŒ€ìƒ ì¸ë¬¼ì´ ê°œì¸ì¸ ê²½ìš° ê°œì¸ìš© ìœ„ì„ì¥</p>
            <table className={commonTableStyle}>
              <tbody>
                <tr>
                  <th className={thStyle} rowSpan={4} style={{ width: '20%' }}>ìœ„ì„ì¸<br/>(ë³¸ì¸)</th>
                  <th className={thStyle}>ì„±ëª…</th>
                  <td className={tdStyle}>{artist.name} (ì¸)</td>
                  <th className={thStyle}>ìƒë…„ì›”ì¼</th>
                  <td className={tdStyle}>{artist.birth_date}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ì£¼ì†Œ</th>
                  <td className={tdStyle} colSpan={3}>{artist.address}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ì „í™”ë²ˆí˜¸</th>
                  <td className={tdStyle} colSpan={3}>{artist.phone_mobile || "-"}</td>
                </tr>
                <tr>
                  <th className={thStyle}>í”„ë¡œí•„ ì´ë¦„</th>
                  <td className={tdStyle} colSpan={3}>{artist.name}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ìœ„ì„ê¸°ê°„</th>
                  <td className={tdStyle} colSpan={4}>
                    {startDate} ë¶€í„° {endDate} ê¹Œì§€ (ìµœì¥ 3ë…„ ì´ë‚´)
                    <div className="text-xs text-gray-500 mt-1">
                      â€» ìœ„ì„ê¸°ê°„ì€ ì¸ë¬¼ê²€ìƒ‰ ë“± ì„œë¹„ìŠ¤ ìš´ì˜ ì •ì±…ì— ë”°ë¦„
                    </div>
                  </td>
                </tr>
                <tr>
                  <th className={thStyle}>ì´ìš©ì„œë¹„ìŠ¤</th>
                  <td className={tdStyle} colSpan={4}>ë§ˆì´í”„ë¡œí•„(ì¸ë¬¼ê²€ìƒ‰ í”„ë¡œí•„ ìˆ˜ì • ì„œë¹„ìŠ¤)</td>
                </tr>
              </tbody>
            </table>

            <table className={commonTableStyle}>
              <tbody>
                <tr>
                  <th className={thStyle} rowSpan={3} style={{ width: '20%' }}>ìˆ˜ì„ì¸<br/>(ëŒ€ë¦¬ì¸)</th>
                  <th className={thStyle}>ì„±ëª…</th>
                  <td className={tdStyle}>{employee.full_name} (ì¸)</td>
                  <th className={thStyle}>ìƒë…„ì›”ì¼</th>
                  <td className={tdStyle}>{extraInfo.empBirth}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ì£¼ì†Œ</th>
                  <td className={tdStyle} colSpan={3}>{extraInfo.empAddress}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ìœ„ì„ì¸ê³¼ì˜ ê´€ê³„</th>
                  <td className={tdStyle} colSpan={3}>{extraInfo.relation} ({tenantName})</td>
                </tr>
              </tbody>
            </table>

            <div className="text-sm leading-relaxed mb-8 text-justify">
              ìƒê¸° ìœ„ì„ì¸ <b>{artist.name}</b> ì€(ëŠ”) ì¸ë¬¼ê²€ìƒ‰ì„ í¬í•¨í•˜ì—¬, Daum/Kakaoì—ì„œ ìš´ì˜í•˜ëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ì—ì„œ 
              ì‚¬ìš©ë˜ê²Œ í•  ëª©ì ìœ¼ë¡œ ìœ„ì„ì¸ì˜ í”„ë¡œí•„ ì •ë³´ë¥¼ ë§ˆì´í”„ë¡œí•„ ì„œë¹„ìŠ¤ë¥¼ í†µí•˜ì—¬ ì œê³µí•¨ê³¼ ê´€ë ¨í•œ 
              ëª¨ë“  ê¶Œí•œ(ê°œì¸ì •ë³´ì˜ ì—´ëŒ, ì œê³µ, ë“±ë¡, ì •ì •, ì‚­ì œ ë“±)ì„ ìˆ˜ì„ì¸ <b>{employee.full_name}</b> ì—ê²Œ ìœ„ì„í•©ë‹ˆë‹¤.
              <br/><br/>
              ìœ„ì„ ê¸°ê°„ ì¤‘ ìˆ˜ì„ì¸ì˜ ìš”ì²­ìœ¼ë¡œ ìˆ˜ì •, ë“±ë¡, ì‚­ì œë˜ëŠ” í”„ë¡œí•„ ì •ë³´ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¬¸ì œëŠ” 
              ìœ„ì„ì¸ ë³¸ì¸ì´ ëª¨ë“  ì±…ì„ì„ ì§€ê³ , ì„œë¹„ìŠ¤ ì œê³µì‚¬ì— ë¯¼, í˜•ì‚¬ìƒ ì–´ë– í•œ ì´ì˜ë„ ì œê¸°í•˜ì§€ ì•Šì„ ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.
            </div>
          </>
        ) : (
          /* === NAVER FORM === */
          <>
            <table className={commonTableStyle}>
              <tbody>
                <tr>
                  <th className={thStyle} rowSpan={2} style={{ width: '20%' }}>ë³¸ì¸<br/>(ìœ„ì„ì¸)</th>
                  <th className={thStyle}>ë³¸ëª…</th>
                  <td className={tdStyle}>{artist.name}</td>
                  <th className={thStyle}>ìƒë…„ì›”ì¼</th>
                  <td className={tdStyle}>{artist.birth_date}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ì—°ë½ì²˜</th>
                  <td className={tdStyle} colSpan={3}>{artist.phone_mobile || "-"}</td>
                </tr>
                <tr>
                  <th className={thStyle} rowSpan={2}>ìœ„ì„ë‚´ìš©</th>
                  <td className={tdStyle} colSpan={4}>
                    - ë„¤ì´ë²„ ì¸ë¬¼ì •ë³´ ì„œë¹„ìŠ¤ ë“±ë¡, ìˆ˜ì •, ì‚­ì œ ì‹ ì²­ì— ê´€í•œ ì¼ì²´ì˜ ê¶Œí•œ ìœ„ì„<br/>
                    - ë„¤ì´ë²„(ì£¼)ë¥¼ ìƒëŒ€ë¡œ ë³¸ì¸ì˜ ëª…ì˜ˆ, ì‚¬ìƒí™œ, ì €ì‘ê¶Œ ë“± ê¶Œë¦¬ë¥¼ ì¹¨í•´í•˜ëŠ” ê²Œì‹œë¬¼ ì¤‘ë‹¨ ìš”ì²­ ë“±
                  </td>
                </tr>
                <tr>
                  <td className={tdStyle} colSpan={4}>
                    <b>ìœ„ì„ê¸°ê°„:</b> {startDate} ~ {endDate} (ìµœì¥ 3ë…„)
                  </td>
                </tr>
              </tbody>
            </table>

            <table className={commonTableStyle}>
              <tbody>
                <tr>
                  <th className={thStyle} rowSpan={3} style={{ width: '20%' }}>ëŒ€ë¦¬ì¸<br/>(ìˆ˜ì„ì¸)</th>
                  <th className={thStyle}>ì„±ëª…</th>
                  <td className={tdStyle}>{employee.full_name}</td>
                  <th className={thStyle}>ìƒë…„ì›”ì¼</th>
                  <td className={tdStyle}>{extraInfo.empBirth}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ì—°ë½ì²˜</th>
                  <td className={tdStyle}>{employee.phone}</td>
                  <th className={thStyle}>ê´€ê³„</th>
                  <td className={tdStyle}>{extraInfo.relation}</td>
                </tr>
                <tr>
                  <th className={thStyle}>ì •ë³´ìˆ˜ì§‘ ë™ì˜</th>
                  <td className={tdStyle} colSpan={3}>
                    [ V ] ë™ì˜í•©ë‹ˆë‹¤. (ëŒ€ë¦¬ì¸ì˜ ì´ë¦„, ìƒë…„ì›”ì¼, ì—°ë½ì²˜ ìˆ˜ì§‘ ë° ì´ìš©)
                  </td>
                </tr>
              </tbody>
            </table>

            <div className="text-sm leading-relaxed mb-8 mt-4">
              1. ë³¸ì¸(ìœ„ì„ì¸)ì€ ë„¤ì´ë²„ ì¸ë¬¼ì •ë³´ ë“± ì„œë¹„ìŠ¤ì—ì„œì˜ ë³¸ì¸ì˜ ì¸ë¬¼ì •ë³´ ë“±ì˜ ê´€ë¦¬ì— ê´€í•˜ì—¬ ìƒê¸° ìœ„ì„ë‚´ìš©ìƒì˜ ì¼ì²´ì˜ ì—…ë¬´ë¥¼ ìƒê¸° ëŒ€ë¦¬ì¸ì—ê²Œ ìœ„ì„í•©ë‹ˆë‹¤.<br/>
              2. ë³¸ì¸(ìœ„ì„ì¸)ì€ ëŒ€ë¦¬ì¸ì´ ê·¸ì˜ ê´€ë¦¬ê¶Œí•œì´ ìœ íš¨í•˜ê²Œ ì¡´ì†í•˜ëŠ” ê¸°ê°„ ì¤‘ ë„¤ì´ë²„(ì£¼)ë¥¼ ìƒëŒ€ë¡œ ì‹ ì²­ ë˜ëŠ” ìš”ì²­í•œ ì‚¬í•­ì´ ì¶”í›„ ì‚¬ì‹¤ì´ ì•„ë‹˜ì´ ë°í˜€ì§ˆ ê²½ìš° ê·¸ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì±…ì„ì„ ë³¸ì¸ì´ ë¶€ë‹´í•  ê²ƒì„ì„ í™•ì¸í•©ë‹ˆë‹¤.
            </div>
          </>
        )}

        {/* Footer Date & Sign */}
        <div className="mt-auto text-center mb-20">
          <p className="text-xl font-bold mb-8">{year}ë…„ {month}ì›” {day}ì¼</p>
          <div className="flex justify-center items-center gap-4 text-lg">
            <span>ìœ„ì„ì¸(ë³¸ì¸): </span>
            <span className="font-bold text-xl">{artist.name}</span>
            <span className="text-gray-400 border-b border-gray-400 w-24 inline-block text-right text-xs">(ì¸/ì„œëª…)</span>
          </div>
        </div>
      </div>

      {/* --- PAGE 2: ì¦ë¹™ ì„œë¥˜ (ìë™ ì²¨ë¶€) --- */}
      <div className="h-[297mm] flex flex-col page-break-before-always pt-10">
        <h2 className="text-2xl font-bold border-b-2 border-black pb-2 mb-6">ì²¨ë¶€ ì„œë¥˜ (ì¦ë¹™)</h2>
        
        <div className="grid grid-cols-1 gap-10">
          {/* 1. ë°°ìš° ì‹ ë¶„ì¦ */}
          <div className="border border-gray-300 p-4 rounded-lg">
            <h3 className="text-lg font-bold mb-2 flex items-center gap-2">
              <span className="bg-black text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">1</span> 
              ìœ„ì„ì¸(ë°°ìš°) ì‹ ë¶„ì¦ ì‚¬ë³¸
            </h3>
            <p className="text-xs text-gray-500 mb-4">* ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ë’·ìë¦¬ëŠ” ë§ˆìŠ¤í‚¹ ì²˜ë¦¬ëœ ì‚¬ë³¸ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
            <div className="h-[300px] bg-gray-50 flex items-center justify-center border-2 border-dashed border-gray-200">
              {artist.id_card_masked_url || artist.id_card_url ? (
                <img 
                  src={artist.id_card_masked_url || artist.id_card_url} 
                  className="max-h-full max-w-full object-contain" 
                  alt="Artist ID" 
                />
              ) : (
                <span className="text-gray-400">ì‹ ë¶„ì¦ ì´ë¯¸ì§€ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</span>
              )}
            </div>
          </div>

          {/* 2. ëŒ€ë¦¬ì¸ ì‹ ë¶„ì¦ */}
          <div className="border border-gray-300 p-4 rounded-lg">
            <h3 className="text-lg font-bold mb-2 flex items-center gap-2">
              <span className="bg-black text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">2</span> 
              ìˆ˜ì„ì¸(ëŒ€ë¦¬ì¸) ì‹ ë¶„ì¦ ì‚¬ë³¸
            </h3>
            <div className="h-[300px] bg-gray-50 flex items-center justify-center border-2 border-dashed border-gray-200">
               {/* ì‹¤ì œ êµ¬í˜„ ì‹œ ì§ì› í…Œì´ë¸”ì˜ ì‹ ë¶„ì¦ URL ì‚¬ìš© */}
               <div className="text-center text-gray-400">
                 <p>ëŒ€ë¦¬ì¸ ì‹ ë¶„ì¦ (ë“±ë¡ëœ íŒŒì¼ ì—†ìŒ)</p>
                 <p className="text-xs mt-1">ì¸ì‡„ í›„ ì‚¬ë³¸ì„ ë¶€ì°©í•´ì£¼ì„¸ìš”.</p>
               </div>
            </div>
          </div>

          {/* 3. ì¬ì§ì¦ëª…ì„œ */}
          <div className="border border-gray-300 p-4 rounded-lg">
            <h3 className="text-lg font-bold mb-2 flex items-center gap-2">
              <span className="bg-black text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">3</span> 
              ì¬ì§ì¦ëª…ì„œ (ì†Œì†ì‚¬)
            </h3>
            <div className="h-[200px] bg-gray-50 flex items-center justify-center border-2 border-dashed border-gray-200">
                <div className="text-center text-gray-400">
                 <p>ì¬ì§ì¦ëª…ì„œ</p>
                 <p className="text-xs mt-1">ì¸ì‡„ í›„ ì²¨ë¶€í•´ì£¼ì„¸ìš”.</p>
               </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// --- Main Page Component ---
const ProfileManagement = () => {
  const { currentTenant } = useAuth();
  const [loading, setLoading] = useState(true);
  
  // Data
  const [artists, setArtists] = useState<Artist[]>([]);
  const [employees, setEmployees] = useState<Employee[]>([]);
  
  // Selection State
  const [selectedArtistId, setSelectedArtistId] = useState<string>("");
  const [selectedEmployeeId, setSelectedEmployeeId] = useState<string>("");
  
  // Extra Info Inputs (DBì— ì—†ëŠ” ì •ë³´ ì…ë ¥ìš©)
  const [extraInfo, setExtraInfo] = useState({
    empBirth: "",
    empAddress: "",
    relation: "ì†Œì†ì‚¬ ë‹´ë‹¹ì",
    date: new Date().toISOString().split('T')[0]
  });

  const printRef = useRef<HTMLDivElement>(null);
  const [activeTab, setActiveTab] = useState<"naver" | "daum">("naver");

  // Fetch Data
  useEffect(() => {
    const fetchData = async () => {
      if (!currentTenant) return;
      setLoading(true);
      
      // 1. Get Artists
      const { data: artistData } = await supabase
        .from("artists")
        .select("id, name, birth_date, address, resident_number, id_card_url, id_card_masked_url")
        .eq("tenant_id", currentTenant.tenant_id)
        .eq("is_active", true);

      // 2. Get Employees (Managers/Admins)
      const { data: memberData } = await supabase
        .from("tenant_memberships")
        .select(`
          user_id, role, department,
          profiles:user_id ( full_name, phone, email )
        `)
        .eq("tenant_id", currentTenant.tenant_id);

      if (artistData) setArtists(artistData as any);
      
      if (memberData) {
        const formattedEmployees = memberData.map((m: any) => ({
          id: m.user_id,
          full_name: m.profiles?.full_name,
          phone: m.profiles?.phone,
          email: m.profiles?.email,
          department: m.department
        }));
        setEmployees(formattedEmployees);
      }
      setLoading(false);
    };
    fetchData();
  }, [currentTenant]);

  const selectedArtist = artists.find(a => a.id === selectedArtistId) || null;
  const selectedEmployee = employees.find(e => e.id === selectedEmployeeId) || null;

  const handlePrint = useReactToPrint({
    // @ts-ignore
    contentRef: printRef,
    documentTitle: `${selectedArtist?.name}_${activeTab}_ìœ„ì„ì¥`,
  });

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />
      <main className="pt-24 pb-16 px-4 max-w-7xl mx-auto">
        
        {/* Header */}
        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
          <div>
            <h1 className="text-3xl font-bold tracking-tight flex items-center gap-3">
              <User className="w-8 h-8 text-primary" /> ì¸ë¬¼ì •ë³´ ë“±ë¡ ê´€ë¦¬
            </h1>
            <p className="text-muted-foreground mt-1">
              ë„¤ì´ë²„, ë‹¤ìŒ(ì¹´ì¹´ì˜¤) ì¸ë¬¼ê²€ìƒ‰ ë“±ë¡ì„ ìœ„í•œ ìœ„ì„ì¥ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
            </p>
          </div>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
          
          {/* Left: Controls */}
          <div className="lg:col-span-4 space-y-6">
            <Card className="glass-card">
              <CardHeader>
                <CardTitle className="text-lg">1. ëŒ€ìƒ ì„ íƒ</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="space-y-2">
                  <Label>ìœ„ì„ì¸ (ë°°ìš°/ì•„í‹°ìŠ¤íŠ¸)</Label>
                  <Select value={selectedArtistId} onValueChange={setSelectedArtistId}>
                    <SelectTrigger><SelectValue placeholder="ë°°ìš° ì„ íƒ" /></SelectTrigger>
                    <SelectContent>
                      {artists.map(a => <SelectItem key={a.id} value={a.id}>{a.name}</SelectItem>)}
                    </SelectContent>
                  </Select>
                  {selectedArtist && (
                    <div className="text-xs text-muted-foreground bg-secondary/30 p-2 rounded">
                      ìƒë…„ì›”ì¼: {selectedArtist.birth_date} <br/>
                      ì‹ ë¶„ì¦: {selectedArtist.id_card_url ? "ë“±ë¡ë¨ âœ…" : "ë¯¸ë“±ë¡ âŒ"}
                    </div>
                  )}
                </div>

                <Separator />

                <div className="space-y-2">
                  <Label>ìˆ˜ì„ì¸ (ë‹´ë‹¹ ë§¤ë‹ˆì €)</Label>
                  <Select value={selectedEmployeeId} onValueChange={setSelectedEmployeeId}>
                    <SelectTrigger><SelectValue placeholder="ë‹´ë‹¹ì ì„ íƒ" /></SelectTrigger>
                    <SelectContent>
                      {employees.map(e => <SelectItem key={e.id} value={e.id}>{e.full_name} ({e.department || "ì†Œì†"})</SelectItem>)}
                    </SelectContent>
                  </Select>
                </div>
              </CardContent>
            </Card>

            <Card className="glass-card">
              <CardHeader>
                <CardTitle className="text-lg">2. ì¶”ê°€ ì •ë³´ ì…ë ¥</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="space-y-2">
                  <Label>ëŒ€ë¦¬ì¸ ìƒë…„ì›”ì¼</Label>
                  <Input 
                    type="date" 
                    value={extraInfo.empBirth} 
                    onChange={e => setExtraInfo({...extraInfo, empBirth: e.target.value})} 
                  />
                </div>
                <div className="space-y-2">
                  <Label>ëŒ€ë¦¬ì¸ ì£¼ì†Œ (íšŒì‚¬/ê°œì¸)</Label>
                  <Input 
                    placeholder="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬..." 
                    value={extraInfo.empAddress} 
                    onChange={e => setExtraInfo({...extraInfo, empAddress: e.target.value})} 
                  />
                </div>
                <div className="space-y-2">
                  <Label>ê´€ê³„</Label>
                  <Input 
                    value={extraInfo.relation} 
                    onChange={e => setExtraInfo({...extraInfo, relation: e.target.value})} 
                  />
                </div>
                
                <Button 
                  className="w-full mt-4" 
                  size="lg" 
                  onClick={() => handlePrint()}
                  disabled={!selectedArtistId || !selectedEmployeeId}
                >
                  <Printer className="w-4 h-4 mr-2" /> ìœ„ì„ì¥ ì¸ì‡„ / PDF ì €ì¥
                </Button>
              </CardContent>
            </Card>
          </div>

          {/* Right: Preview */}
          <div className="lg:col-span-8">
            <Tabs value={activeTab} onValueChange={(v: any) => setActiveTab(v)} className="w-full">
              <div className="flex items-center justify-between mb-4">
                <TabsList>
                  <TabsTrigger value="naver" className="w-32">ë„¤ì´ë²„ (Naver)</TabsTrigger>
                  <TabsTrigger value="daum" className="w-32">ë‹¤ìŒ (Daum)</TabsTrigger>
                </TabsList>
                <div className="flex gap-2">
                   <Badge variant="outline" className="gap-1">
                     <CheckCircle2 className="w-3 h-3 text-green-500" /> ìë™ì™„ì„± ì ìš©ë¨
                   </Badge>
                </div>
              </div>

              {/* ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ (ì‹¤ì œ ì¸ì‡„ë˜ëŠ” ì˜ì—­ê³¼ ë™ì¼í•˜ê²Œ ë³´ì´ë„ë¡ ìŠ¤íƒ€ì¼ë§) */}
              <div className="border rounded-xl bg-gray-100 p-8 overflow-auto max-h-[800px] shadow-inner">
                <div className="transform scale-90 origin-top"> {/* ë¯¸ë¦¬ë³´ê¸°ë¼ ì‚´ì§ ì¶•ì†Œ */}
                  <div className="bg-white shadow-xl mx-auto w-[210mm] min-h-[297mm]">
                     {/* í™”ë©´ì— ë³´ì—¬ì§€ëŠ” ë¯¸ë¦¬ë³´ê¸°ìš© (ì¸ì‡„ìš©ê³¼ ë™ì¼í•œ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©) */}
                     <PortalDocTemplate 
                        type={activeTab} 
                        artist={selectedArtist} 
                        employee={selectedEmployee} 
                        tenantName={currentTenant?.tenant.name || "ì†Œì†ì‚¬"}
                        extraInfo={extraInfo}
                     />
                  </div>
                </div>
              </div>
            </Tabs>
          </div>
        </div>

        {/* Hidden Print Container */}
        <div className="hidden">
          <div ref={printRef}>
            <PortalDocTemplate 
              type={activeTab} 
              artist={selectedArtist} 
              employee={selectedEmployee} 
              tenantName={currentTenant?.tenant.name || "ì†Œì†ì‚¬"}
              extraInfo={extraInfo}
            />
          </div>
        </div>

      </main>
    </div>
  );
};

export default ProfileManagement;


============================================================
File Path: src/pages/admin/TenantAPISettings.tsx
============================================================
import { useState, useEffect } from "react";
import { useAuth } from "@/hooks/useAuth";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { toast } from "sonner";
import { Settings, Save, Key, RefreshCw, Eye, EyeOff, AlertCircle, Plus, Loader2, Trash2 } from "lucide-react";
import {
  Sheet, SheetContent, SheetHeader, SheetTitle, SheetFooter, SheetClose
} from "@/components/ui/sheet";
import {
  Select, SelectContent, SelectItem, SelectTrigger, SelectValue
} from "@/components/ui/select";
import {
  AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent,
  AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle,
} from "@/components/ui/alert-dialog";

interface ConfigItem {
  id: string;
  tenant_id: string;
  config_key: string;
  config_value: string;
  description: string | null;
  category: string;
  is_encrypted: boolean;
}

const categoryOptions = ["general", "ai", "social", "analytics", "payment"];

const TenantAPISettings = () => {
  const { currentTenant, isCompanyAdmin, isSuperAdmin } = useAuth();
  const [configs, setConfigs] = useState<ConfigItem[]>([]);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [showKey, setShowKey] = useState<Record<string, boolean>>({});

  const [isSheetOpen, setIsSheetOpen] = useState(false);
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [currentConfig, setCurrentConfig] = useState<ConfigItem | null>(null);

  const [formData, setFormData] = useState({
    config_key: "",
    config_value: "",
    description: "",
    category: "general",
  });

  const fetchConfigs = async () => {
    if (!currentTenant) return;
    setLoading(true);
    const { data, error } = await supabase
      .from("tenant_api_configs")
      .select("*")
      .eq("tenant_id", currentTenant.tenant_id)
      .order("category");

    if (error) {
      toast.error("ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
    } else {
      setConfigs(data || []);
    }
    setLoading(false);
  };

  useEffect(() => {
    fetchConfigs();
  }, [currentTenant]);

  const handleChange = (id: string, newValue: string) => {
    setConfigs(prev => prev.map(item =>
      item.id === id ? { ...item, config_value: newValue } : item
    ));
  };

  const handleSaveValue = async (config: ConfigItem) => {
    setSaving(true);
    const { error } = await supabase
      .from("tenant_api_configs")
      .update({
        config_value: config.config_value,
        updated_at: new Date().toISOString()
      })
      .eq("id", config.id);

    if (error) {
      toast.error("ì €ì¥ ì‹¤íŒ¨");
    } else {
      toast.success("ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
    setSaving(false);
  };

  const handleAddConfig = async () => {
    if (!formData.config_key || !currentTenant) {
      toast.error("ì„¤ì • í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.");
      return;
    }
    setSaving(true);
    try {
      const { error } = await supabase
        .from("tenant_api_configs")
        .insert({
          tenant_id: currentTenant.tenant_id,
          config_key: formData.config_key,
          config_value: formData.config_value,
          description: formData.description || null,
          category: formData.category,
        });
      if (error) throw error;
      toast.success("ìƒˆ ì„¤ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.");
      setIsSheetOpen(false);
      fetchConfigs();
    } catch (error: any) {
      if (error.code === '23505') {
        toast.error("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì„¤ì • í‚¤ì…ë‹ˆë‹¤.");
      } else {
        toast.error(`ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`);
      }
    } finally {
      setSaving(false);
    }
  };

  const handleDelete = async () => {
    if (!currentConfig) return;
    setSaving(true);
    try {
      const { error } = await supabase
        .from("tenant_api_configs")
        .delete()
        .eq("id", currentConfig.id);
      if (error) throw error;
      toast.success("ì„¤ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
      setIsDeleteDialogOpen(false);
      fetchConfigs();
    } catch (error: any) {
      toast.error(`ì‚­ì œ ì‹¤íŒ¨: ${error.message}`);
    } finally {
      setSaving(false);
      setCurrentConfig(null);
    }
  };

  const toggleShow = (id: string) => {
    setShowKey(prev => ({ ...prev, [id]: !prev[id] }));
  };

  const openAddSheet = () => {
    setFormData({ config_key: "", config_value: "", description: "", category: "general" });
    setIsSheetOpen(true);
  };

  if (!isCompanyAdmin) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        <div className="text-center space-y-4">
          <AlertCircle className="w-12 h-12 text-destructive mx-auto" />
          <p className="text-muted-foreground font-medium">ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</p>
          <Button onClick={() => window.history.back()} variant="outline">ë’¤ë¡œ ê°€ê¸°</Button>
        </div>
      </div>
    );
  }

  // ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë£¹í•‘
  const groupedConfigs = configs.reduce((acc, config) => {
    const cat = config.category || "general";
    if (!acc[cat]) acc[cat] = [];
    acc[cat].push(config);
    return acc;
  }, {} as Record<string, ConfigItem[]>);

  const categoryLabels: Record<string, string> = {
    general: "ì¼ë°˜ ì„¤ì •",
    ai: "AI / LLM",
    social: "ì†Œì…œ ë¯¸ë””ì–´",
    analytics: "ë¶„ì„ ë„êµ¬",
    payment: "ê²°ì œ",
  };

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />
      <main className="pt-24 pb-16 px-4 max-w-5xl mx-auto">
        <div className="flex items-center justify-between mb-8">
          <div>
            <h1 className="text-3xl font-bold flex items-center gap-2">
              <Settings className="w-8 h-8 text-primary" /> íšŒì‚¬ API ì„¤ì •
            </h1>
            <p className="text-muted-foreground mt-2">
              {isSuperAdmin ? "ì „ì²´ íšŒì‚¬" : currentTenant?.tenant.name}ì˜ API í‚¤ì™€ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
            </p>
          </div>
          <div className="flex gap-2">
            <Button variant="outline" onClick={fetchConfigs}>
              <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} /> ìƒˆë¡œê³ ì¹¨
            </Button>
            <Button variant="hero" onClick={openAddSheet}>
              <Plus className="w-4 h-4 mr-2" /> ì„¤ì • ì¶”ê°€
            </Button>
          </div>
        </div>

        {loading ? (
          <div className="flex items-center justify-center h-64">
            <Loader2 className="w-8 h-8 animate-spin text-primary" />
          </div>
        ) : configs.length === 0 ? (
          <Card className="glass-card">
            <CardContent className="py-16 text-center text-muted-foreground">
              ë“±ë¡ëœ API ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ì„¤ì •ì„ ì¶”ê°€í•´ ë³´ì„¸ìš”.
            </CardContent>
          </Card>
        ) : (
          <div className="grid gap-6">
            {Object.entries(groupedConfigs).map(([category, items]) => (
              <Card key={category} className="glass-card border-l-4 border-l-primary/50">
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <Key className="w-5 h-5 text-primary" /> {categoryLabels[category] || category}
                  </CardTitle>
                  <CardDescription>{items.length}ê°œ ì„¤ì •</CardDescription>
                </CardHeader>
                <CardContent className="space-y-4">
                  {items.map((config) => (
                    <div key={config.id} className="grid gap-2 p-4 rounded-xl bg-secondary/20 border border-border/50">
                      <div className="flex justify-between items-center">
                        <Label className="font-bold text-sm flex items-center gap-2">
                          <Key className="w-3 h-3 text-muted-foreground" /> {config.config_key}
                        </Label>
                        <div className="flex items-center gap-2">
                          {config.description && (
                            <Badge variant="outline" className="text-[10px]">{config.description}</Badge>
                          )}
                          <Button
                            variant="ghost"
                            size="icon"
                            className="w-7 h-7 text-destructive"
                            onClick={() => { setCurrentConfig(config); setIsDeleteDialogOpen(true); }}
                          >
                            <Trash2 className="w-3 h-3" />
                          </Button>
                        </div>
                      </div>

                      <div className="flex gap-2">
                        <div className="relative flex-1">
                          <Input
                            type={showKey[config.id] ? "text" : "password"}
                            value={config.config_value}
                            onChange={(e) => handleChange(config.id, e.target.value)}
                            className="pr-10 font-mono text-sm"
                            placeholder="ê°’ì„ ì…ë ¥í•˜ì„¸ìš”"
                          />
                          <button
                            onClick={() => toggleShow(config.id)}
                            className="absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground"
                          >
                            {showKey[config.id] ? <EyeOff className="w-4 h-4" /> : <Eye className="w-4 h-4" />}
                          </button>
                        </div>
                        <Button
                          onClick={() => handleSaveValue(config)}
                          disabled={saving}
                          size="sm"
                          className="w-20"
                        >
                          {saving ? "ì €ì¥..." : <><Save className="w-4 h-4 mr-1" /> ì €ì¥</>}
                        </Button>
                      </div>
                    </div>
                  ))}
                </CardContent>
              </Card>
            ))}
          </div>
        )}
      </main>

      {/* ì„¤ì • ì¶”ê°€ Sheet */}
      <Sheet open={isSheetOpen} onOpenChange={setIsSheetOpen}>
        <SheetContent className="sm:max-w-md p-0 overflow-hidden flex flex-col">
          <SheetHeader className="p-6 border-b">
            <SheetTitle className="text-xl font-bold flex items-center gap-2">
              <Plus className="w-5 h-5 text-primary" /> ìƒˆ API ì„¤ì • ì¶”ê°€
            </SheetTitle>
          </SheetHeader>
          <div className="p-6 space-y-6 overflow-y-auto flex-1">
            <div className="space-y-2">
              <Label htmlFor="config_key">ì„¤ì • í‚¤ *</Label>
              <Input
                id="config_key"
                placeholder="ì˜ˆ: OPENAI_API_KEY"
                value={formData.config_key}
                onChange={(e) => setFormData({ ...formData, config_key: e.target.value.toUpperCase().replace(/\s/g, '_') })}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="config_value">ê°’</Label>
              <Input
                id="config_value"
                type="password"
                placeholder="API í‚¤ ë˜ëŠ” ì„¤ì •ê°’"
                value={formData.config_value}
                onChange={(e) => setFormData({ ...formData, config_value: e.target.value })}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="description">ì„¤ëª…</Label>
              <Input
                id="description"
                placeholder="ì˜ˆ: OpenAI GPT-4 API í‚¤"
                value={formData.description}
                onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="category">ì¹´í…Œê³ ë¦¬</Label>
              <Select value={formData.category} onValueChange={(val) => setFormData({ ...formData, category: val })}>
                <SelectTrigger id="category">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {categoryOptions.map(c => (
                    <SelectItem key={c} value={c}>{categoryLabels[c] || c}</SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          </div>
          <SheetFooter className="p-6 border-t">
            <SheetClose asChild>
              <Button variant="outline" disabled={saving}>ì·¨ì†Œ</Button>
            </SheetClose>
            <Button onClick={handleAddConfig} disabled={saving || !formData.config_key}>
              {saving ? <Loader2 className="w-4 h-4 mr-2 animate-spin" /> : <Plus className="w-4 h-4 mr-2" />}
              ì¶”ê°€
            </Button>
          </SheetFooter>
        </SheetContent>
      </Sheet>

      {/* ì‚­ì œ í™•ì¸ Dialog */}
      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="text-destructive font-bold text-xl">ì„¤ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</AlertDialogTitle>
            <AlertDialogDescription>
              "{currentConfig?.config_key}" ì„¤ì •ì´ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel disabled={saving}>ì·¨ì†Œ</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} disabled={saving} className="bg-destructive text-destructive-foreground hover:bg-destructive/90">
              {saving ? <Loader2 className="w-4 h-4 animate-spin mr-2" /> : null}ì‚­ì œ
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
};

export default TenantAPISettings;



============================================================
File Path: src/pages/admin/VehicleManagement.tsx
============================================================
import { useState, useEffect } from "react";
import { Header } from "@/components/landing/Header";
import { supabase } from "@/integrations/supabase/client";
import { useAuth } from "@/hooks/useAuth";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import { Button } from "@/components/ui/button";
import { CarFront, Plus, ShieldCheck, AlertTriangle, Phone } from "lucide-react";

const VehicleManagement = () => {
  const { currentTenant } = useAuth();
  const [vehicles, setVehicles] = useState<any[]>([]);

  useEffect(() => {
    if (currentTenant) {
      const fetchVehicles = async () => {
        const { data } = await supabase.from("vehicles").select("*").eq("tenant_id", currentTenant.tenant_id);
        if (data) setVehicles(data);
      };
      fetchVehicles();
    }
  }, [currentTenant]);

  return (
    <div className="min-h-screen bg-slate-50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-7xl mx-auto">
        <div className="flex justify-between items-center mb-8">
          <div>
            <h1 className="text-3xl font-bold flex items-center gap-3">
              <CarFront className="w-8 h-8 text-blue-600" /> ì°¨ëŸ‰ ê´€ë¦¬ ì„¼í„°
            </h1>
            <p className="text-slate-500 mt-1">íšŒì‚¬ ì°¨ëŸ‰ ë¦¬ìŠ¤, ë³´í—˜ ë° ìœ ì§€ë³´ìˆ˜ ì´ë ¥ì„ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
          </div>
          <Button className="bg-blue-600 hover:bg-blue-700 gap-2">
            <Plus size={18} /> ì‹ ê·œ ì°¨ëŸ‰ ë“±ë¡
          </Button>
        </div>

        <div className="grid gap-6">
          {vehicles.map((v) => (
            <Card key={v.id} className="border-none shadow-sm overflow-hidden">
              <div className="grid grid-cols-1 md:grid-cols-4">
                <div className="p-6 bg-slate-900 text-white flex flex-col justify-center">
                  <span className="text-xs text-slate-400 uppercase font-bold">ì°¨ëŸ‰ ë²ˆí˜¸</span>
                  <h2 className="text-2xl font-black mt-1">{v.vehicle_number}</h2>
                  <div className="mt-4 flex items-center gap-2 text-sm text-blue-400">
                    <ShieldCheck size={16} /> {v.insurance_company}
                  </div>
                </div>
                <div className="col-span-3 p-6 grid grid-cols-2 md:grid-cols-3 gap-6 bg-white">
                  <div>
                    <Label className="text-slate-400 text-[10px] uppercase">ê³„ì•½ ë‹´ë‹¹ì</Label>
                    <p className="font-bold">{v.contract_manager}</p>
                    <p className="text-xs flex items-center gap-1 text-slate-500 mt-1"><Phone size={10}/> {v.contact_number}</p>
                  </div>
                  <div>
                    <Label className="text-slate-400 text-[10px] uppercase">ë¦¬ìŠ¤/í• ë¶€ ì •ë³´</Label>
                    <p className="font-bold text-blue-600">ì›” {v.monthly_fee?.toLocaleString()}ì›</p>
                    <p className="text-xs text-slate-500 mt-1">ë³´ì¦ê¸ˆ: {v.deposit?.toLocaleString()}ì›</p>
                  </div>
                  <div>
                    <Label className="text-slate-400 text-[10px] uppercase">ë³´í—˜ ê¸°ê°„</Label>
                    <p className="font-medium text-sm">{v.insurance_period}</p>
                  </div>
                  <div className="col-span-2 md:col-span-3 mt-2 p-3 bg-rose-50 rounded-lg border border-rose-100">
                    <Label className="text-rose-400 text-[10px] font-bold flex items-center gap-1">
                      <AlertTriangle size={12} /> ì‚¬ê³  ì´ë ¥ ë° íŠ¹ì´ì‚¬í•­
                    </Label>
                    <p className="text-sm text-rose-800 mt-1">{v.accident_history || "ì‚¬ê³  ì´ë ¥ ì—†ìŒ"}</p>
                  </div>
                </div>
              </div>
            </Card>
          ))}
          {vehicles.length === 0 && <div className="text-center py-20 bg-white rounded-3xl border-2 border-dashed text-slate-400 font-medium">ê´€ë¦¬ ì¤‘ì¸ ì°¨ëŸ‰ì´ ì—†ìŠµë‹ˆë‹¤.</div>}
        </div>
      </main>
    </div>
  );
};

const Label = ({ children, className }: any) => <label className={`font-bold tracking-tighter ${className}`}>{children}</label>;

export default VehicleManagement;


============================================================
File Path: src/pages/SuperAdmin/APIManagement.tsx
============================================================
import { useState, useEffect } from "react";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { toast } from "sonner";
import { 
  Settings, Save, Key, RefreshCw, Eye, EyeOff, 
  ShieldAlert, Mail, Brain, Sparkles, Cpu, 
  ArrowLeft, Terminal, Database, Globe
} from "lucide-react";
import { useNavigate } from "react-router-dom";

interface ConfigItem {
  config_key: string;
  config_value: string;
  description: string;
  category: string;
}

// ì¹´í…Œê³ ë¦¬ë³„ ë””ìì¸ ë§¤í•‘
const categoryStyles: Record<string, { icon: any, color: string, label: string }> = {
  EMAIL: { icon: <Mail className="w-5 h-5" />, color: "border-l-blue-500", label: "ì´ë©”ì¼ ì¸í”„ë¼" },
  AI_GEMINI: { icon: <Sparkles className="w-5 h-5" />, color: "border-l-orange-500", label: "Google Gemini AI" },
  AI_HUGGINGFACE: { icon: <Brain className="w-5 h-5" />, color: "border-l-yellow-500", label: "Hugging Face AI" },
  SYSTEM: { icon: <Globe className="w-5 h-5" />, color: "border-l-slate-500", label: "ì‹œìŠ¤í…œ ë„¤íŠ¸ì›Œí¬" },
};

const APIManagement = () => {
  const navigate = useNavigate();
  const [configs, setConfigs] = useState<ConfigItem[]>([]);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState<Record<string, boolean>>({});
  const [showKey, setShowKey] = useState<Record<string, boolean>>({});

  const fetchConfigs = async () => {
    setLoading(true);
    try {
      const { data, error } = await supabase
        .from("system_configs")
        .select("config_key, config_value, description, category")
        .order("category");
      
      if (error) throw error;
      setConfigs(data || []);
    } catch (error: any) {
      toast.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨");
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchConfigs();
  }, []);

  const handleChange = (key: string, newValue: string) => {
    setConfigs(prev => prev.map(item => 
      item.config_key === key ? { ...item, config_value: newValue } : item
    ));
  };

  const handleSave = async (key: string, value: string) => {
    setSaving(prev => ({ ...prev, [key]: true }));
    try {
      const { error } = await supabase
        .from("system_configs")
        .update({ 
          config_value: value, 
          updated_at: new Date().toISOString() 
        })
        .eq("config_key", key);

      if (error) throw error;
      toast.success(`${key} ì„¤ì • ì €ì¥ ì™„ë£Œ`);
    } catch (error: any) {
      toast.error("ì €ì¥ ì‹¤íŒ¨");
    } finally {
      setSaving(prev => ({ ...prev, [key]: false }));
    }
  };

  const categories = Array.from(new Set(configs.map(c => c.category)));

  return (
    <div className="min-h-screen bg-slate-50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-6xl mx-auto">
        
        <div className="flex flex-col md:flex-row md:items-center justify-between mb-10">
          <div className="flex items-center gap-4">
            <Button variant="ghost" size="icon" onClick={() => navigate("/super-admin")}>
              <ArrowLeft className="w-5 h-5" />
            </Button>
            <div>
              <h1 className="text-3xl font-bold flex items-center gap-3">
                <Settings className="w-8 h-8 text-indigo-600" /> ì‹œìŠ¤í…œ ë§ˆìŠ¤í„° API ê´€ë¦¬
              </h1>
              <p className="text-slate-500 mt-1">í”Œë«í¼ ì „ì²´ì—ì„œ ì‚¬ìš©í•˜ëŠ” AI ëª¨ë¸, ë©”ì¼ ì„œë²„, ì¸í”„ë¼ í‚¤ë¥¼ í†µí•© í†µì œí•©ë‹ˆë‹¤.</p>
            </div>
          </div>
          <Button variant="outline" onClick={fetchConfigs} className="bg-white">
            <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} /> ë°ì´í„° ë™ê¸°í™”
          </Button>
        </div>

        <div className="space-y-12">
          {categories.map(cat => (
            <section key={cat} className="animate-in fade-in slide-in-from-bottom-3 duration-500">
              <div className="flex items-center gap-3 mb-4 px-1">
                <div className="p-2 bg-white rounded-lg shadow-sm border border-slate-100">
                  {categoryStyles[cat]?.icon || <Cpu className="w-5 h-5" />}
                </div>
                <div>
                  <h2 className="text-lg font-bold text-slate-800">{categoryStyles[cat]?.label || cat}</h2>
                  <p className="text-xs text-slate-400">Infrastructure Group: {cat}</p>
                </div>
                <div className="h-px flex-1 bg-slate-200 ml-4 opacity-50"></div>
              </div>

              <div className="grid grid-cols-1 gap-4">
                {configs.filter(c => c.category === cat).map((config) => (
                  <Card key={config.config_key} className={`border-none shadow-sm border-l-4 ${categoryStyles[cat]?.color || 'border-l-slate-300'} bg-white overflow-hidden`}>
                    <CardContent className="p-5 flex flex-col lg:flex-row lg:items-center gap-6">
                      <div className="lg:w-1/4">
                        <div className="flex items-center gap-2 mb-1">
                          <Terminal className="w-3.5 h-3.5 text-indigo-400" />
                          <span className="font-bold text-slate-900 text-sm">{config.config_key}</span>
                        </div>
                        <p className="text-[11px] text-slate-500 leading-relaxed font-medium">{config.description}</p>
                      </div>

                      <div className="flex-1 flex gap-2">
                        <div className="relative flex-1">
                          <Input
                            type={showKey[config.config_key] ? "text" : "password"}
                            value={config.config_value}
                            onChange={(e) => handleChange(config.config_key, e.target.value)}
                            className="pr-10 font-mono text-sm bg-slate-50 border-slate-200 focus:bg-white transition-all h-11"
                            placeholder="ì„¤ì •ê°’ì„ ì…ë ¥í•˜ì„¸ìš”..."
                          />
                          <button 
                            onClick={() => setShowKey(prev => ({ ...prev, [config.config_key]: !prev[config.config_key] }))}
                            className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-indigo-600 transition-colors"
                          >
                            {showKey[config.config_key] ? <EyeOff size={18} /> : <Eye size={18} />}
                          </button>
                        </div>
                        <Button 
                          onClick={() => handleSave(config.config_key, config.config_value)} 
                          disabled={saving[config.config_key]}
                          className="w-24 font-bold h-11 shadow-sm"
                        >
                          {saving[config.config_key] ? <RefreshCw className="w-4 h-4 animate-spin" /> : <><Save className="w-4 h-4 mr-2"/>ì €ì¥</>}
                        </Button>
                      </div>
                    </CardContent>
                  </Card>
                ))}
              </div>
            </section>
          ))}
        </div>

        {/* í•˜ë‹¨ ë³´ì•ˆ ê°€ì´ë“œ */}
        <div className="mt-16 bg-slate-900 rounded-3xl p-8 text-white relative overflow-hidden shadow-2xl">
          <div className="absolute -top-10 -right-10 opacity-10">
             <ShieldAlert className="w-64 h-64" />
          </div>
          <div className="relative z-10">
            <h3 className="text-xl font-bold flex items-center gap-2 mb-4">
               <ShieldAlert className="text-amber-400" /> ìŠˆí¼ ì–´ë“œë¯¼ ë³´ì•ˆ í”„ë¡œí† ì½œ
            </h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
               <div className="space-y-3">
                  <p className="text-sm text-slate-300 font-bold">1. ë°ì´í„° ê°€ìš©ì„±</p>
                  <p className="text-xs text-slate-400 leading-relaxed">
                    ì´ê³³ì—ì„œ ë³€ê²½ëœ API í‚¤ì™€ ëª¨ë¸ ì„¤ì •ì€ Edge Function ë° ëª¨ë“  ì„œë¹„ìŠ¤ í˜ì´ì§€ì— ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤. ì˜ëª»ëœ ëª¨ë¸ IDë¥¼ ì…ë ¥í•  ê²½ìš° ì‹œìŠ¤í…œ ì¥ì• ì˜ ì›ì¸ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                  </p>
               </div>
               <div className="space-y-3">
                  <p className="text-sm text-slate-300 font-bold">2. ëª¨ë¸ ì„¤ì • íŒ</p>
                  <p className="text-xs text-slate-400 leading-relaxed">
                    Hugging Face ëª¨ë¸ IDëŠ” <code>author/model-name</code> í˜•ì‹ì„ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤. Gemini API í‚¤ëŠ” Google Cloud Consoleì—ì„œ ë°œê¸‰ë°›ì€ ìµœì‹  ë²„ì „ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                  </p>
               </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  );
};

export default APIManagement;


============================================================
File Path: src/pages/SuperAdmin/MessageManagement.tsx
============================================================
import { useState, useEffect } from "react";
import { supabase } from "@/integrations/supabase/client";
import { Header } from "@/components/landing/Header";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Label } from "@/components/ui/label"; // UI ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©
import { MessageSquare, Mail, Eye, Save, Image as ImageIcon, ArrowLeft } from "lucide-react";
import { toast } from "sonner";
import { useNavigate } from "react-router-dom";

const MessageManagement = () => {
  const navigate = useNavigate();
  const [templates, setTemplates] = useState<any[]>([]);
  const [selectedKey, setSelectedKey] = useState("invite_sns");
  const [editingTemplate, setEditingTemplate] = useState<any>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchTemplates();
  }, []);

  const fetchTemplates = async () => {
    setLoading(true);
    try {
      const { data } = await supabase.from("notification_templates").select("*");
      if (data && data.length > 0) {
        setTemplates(data);
        const current = data.find(t => t.template_key === selectedKey) || data[0];
        setEditingTemplate(current);
      }
    } catch (err) {
      console.error(err);
    } finally {
      setLoading(false);
    }
  };

  const handleUpdate = async () => {
    if (!editingTemplate) return;
    const { error } = await supabase
      .from("notification_templates")
      .update({
        title: editingTemplate.title,
        content: editingTemplate.content,
        image_url: editingTemplate.image_url,
        updated_at: new Date().toISOString()
      })
      .eq("template_key", selectedKey);

    if (error) toast.error("ì €ì¥ ì‹¤íŒ¨");
    else toast.success("í…œí”Œë¦¿ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.");
  };

  const renderPreview = (text: string) => {
    if (!text) return "";
    return text
      .replace("{{company_name}}", "ì—ì½”ê¸€ë¡œë²Œê·¸ë£¹")
      .replace("{{user_name}}", "ì„ìˆ˜ì—°");
  };

  if (loading) return <div className="min-h-screen flex items-center justify-center">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>;
  if (!editingTemplate) return <div className="p-10 text-center">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. SQLì„ ë¨¼ì € ì‹¤í–‰í•´ì£¼ì„¸ìš”.</div>;

  return (
    <div className="min-h-screen bg-slate-50">
      <Header />
      <main className="pt-28 pb-16 px-6 max-w-7xl mx-auto">
        <div className="flex items-center justify-between mb-8">
          <div className="flex items-center gap-4">
            <Button variant="ghost" size="icon" onClick={() => navigate("/super-admin")}>
              <ArrowLeft className="w-5 h-5" />
            </Button>
            <div>
              <h1 className="text-3xl font-bold tracking-tight flex items-center gap-3">
                <MessageSquare className="w-8 h-8 text-primary" /> ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ê´€ë¦¬
              </h1>
              <p className="text-slate-500 mt-1">SNS ê³µìœ  ì¹´ë“œ ë° ì´ë©”ì¼ ë¬¸êµ¬ë¥¼ ë™ì ìœ¼ë¡œ ì œì–´í•©ë‹ˆë‹¤.</p>
            </div>
          </div>
          <Button onClick={handleUpdate} className="gap-2 px-8 h-12 shadow-lg">
            <Save className="w-5 h-5" /> ì„¤ì • ì €ì¥í•˜ê¸°
          </Button>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
          <div className="lg:col-span-7 space-y-6">
            <Tabs value={selectedKey} onValueChange={(val) => {
                setSelectedKey(val);
                const found = templates.find(t => t.template_key === val);
                if (found) setEditingTemplate(found);
            }}>
              <TabsList className="grid w-full grid-cols-2 h-12 bg-white border">
                <TabsTrigger value="invite_sns" className="gap-2">SNS ì´ˆëŒ€ ì¹´ë“œ</TabsTrigger>
                <TabsTrigger value="welcome_email" className="gap-2">í™˜ì˜ ì´ë©”ì¼</TabsTrigger>
              </TabsList>

              <Card className="mt-6 border-none shadow-sm">
                <CardHeader>
                  <CardTitle className="text-lg">ë¬¸êµ¬ í¸ì§‘ê¸°</CardTitle>
                  <CardDescription className="flex flex-wrap gap-2 mt-2">
                    ì‚¬ìš© ê°€ëŠ¥ ë³€ìˆ˜: 
                    {editingTemplate.placeholders?.map((p: string) => (
                      <Badge key={p} variant="secondary" className="font-mono text-primary">{`{{${p}}}`}</Badge>
                    ))}
                  </CardDescription>
                </CardHeader>
                <CardContent className="space-y-6">
                  <div className="space-y-2">
                    <Label className="text-slate-500">ì œëª© (Title)</Label>
                    <Input 
                      value={editingTemplate.title} 
                      onChange={e => setEditingTemplate({...editingTemplate, title: e.target.value})} 
                    />
                  </div>
                  <div className="space-y-2">
                    <Label className="text-slate-500">ë‚´ìš© (Content / Description)</Label>
                    <Textarea 
                      rows={5}
                      value={editingTemplate.content} 
                      onChange={e => setEditingTemplate({...editingTemplate, content: e.target.value})} 
                    />
                  </div>
                  <div className="space-y-2">
                    <Label className="text-slate-500">ê³µìœ  ì´ë¯¸ì§€ URL</Label>
                    <div className="flex gap-2">
                      <Input 
                        value={editingTemplate.image_url || ""} 
                        onChange={e => setEditingTemplate({...editingTemplate, image_url: e.target.value})} 
                        placeholder="https://..."
                      />
                    </div>
                  </div>
                </CardContent>
              </Card>
            </Tabs>
          </div>

          {/* ì˜¤ë¥¸ìª½: ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ */}
          <div className="lg:col-span-5">
            <div className="sticky top-32 space-y-4">
              <Label className="flex items-center gap-2 text-slate-400 mb-2"><Eye className="w-4 h-4"/> ì‹¤ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜</Label>
              {selectedKey === 'invite_sns' ? (
                /* ì¹´í†¡ ìŠ¤íƒ€ì¼ */
                <div className="flex items-start gap-2">
                  <div className="w-9 h-9 rounded-xl bg-slate-300 shrink-0" />
                  <div className="space-y-1">
                    <p className="text-[11px] text-slate-500 ml-1">Boteda OS</p>
                    <div className="bg-[#fef01b] p-3 rounded-2xl rounded-tl-none shadow-sm max-w-[280px]">
                        <div className="bg-white rounded-lg overflow-hidden border border-slate-100">
                            <div className="aspect-[1.9/1] bg-slate-50 flex items-center justify-center overflow-hidden">
                                {editingTemplate.image_url ? 
                                  <img src={editingTemplate.image_url} className="w-full h-full object-cover" alt="preview" /> : 
                                  <ImageIcon className="text-slate-200 w-12 h-12" />
                                }
                            </div>
                            <div className="p-3">
                                <div className="font-bold text-[13px] leading-snug text-slate-900">
                                  {renderPreview(editingTemplate.title)}
                                </div>
                                <div className="text-[11px] text-slate-500 mt-1 line-clamp-2 leading-normal">
                                  {renderPreview(editingTemplate.content)}
                                </div>
                                <div className="text-[9px] text-slate-300 mt-2 pt-1 border-t">boteda-os.com</div>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
              ) : (
                /* ì´ë©”ì¼ ìŠ¤íƒ€ì¼ */
                <div className="bg-white border rounded-xl shadow-sm p-6 text-sm">
                  <div className="border-b pb-3 mb-4">
                      <p className="text-[10px] text-slate-400 uppercase font-bold mb-1">Subject</p>
                      <p className="font-bold text-slate-800">{renderPreview(editingTemplate.title)}</p>
                  </div>
                  <div className="whitespace-pre-wrap text-slate-600 leading-relaxed min-h-[100px]">
                      {renderPreview(editingTemplate.content)}
                  </div>
                  <div className="mt-8 pt-4 border-t text-center">
                      <Button className="bg-primary text-white px-10 rounded-full h-10">ì‹œìŠ¤í…œ ì ‘ì†í•˜ê¸°</Button>
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>
      </main>
    </div>
  );
};

export default MessageManagement;


============================================================
File Path: src/pages/SuperAdmin/PressContacts.tsx
============================================================
import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { Header } from "@/components/landing/Header";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
  Table, TableBody, TableCell, TableHead, TableHeader, TableRow,
} from "@/components/ui/table";
import {
  Sheet, SheetContent, SheetHeader, SheetTitle, SheetClose, SheetFooter
} from "@/components/ui/sheet";
import {
  Select, SelectContent, SelectItem, SelectTrigger, SelectValue
} from "@/components/ui/select";
import {
  AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent,
  AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { supabase } from "@/integrations/supabase/client";
import { toast } from "sonner";
import {
  Users, Plus, Search, Filter, MoreHorizontal, Mail, Phone, Globe,
  Loader2, Save, Edit2, Trash2, ArrowLeft, Terminal
} from "lucide-react";
import { Tables } from "@/integrations/supabase/types";

// DB íƒ€ì… ì •ì˜
type PressContact = Tables<'press_contacts'>;

// ëª©ì  ì˜µì…˜ (Select ì˜¤ë¥˜ ë°©ì§€ë¥¼ ìœ„í•´ 'ì „ì²´' ë° 'ì„ íƒ ì•ˆ í•¨' í•­ëª©ì€ ë³„ë„ë¡œ ê´€ë¦¬)
const purposeOptions = ["PR (ì–¸ë¡  í™ë³´)", "ë¸Œëœë“œ ë§ˆì¼€íŒ…", "ê´‘ê³  ì œíœ´", "ê¸°íƒ€"];

const PressContacts = () => {
  const navigate = useNavigate();
  // user ê°ì²´ëŠ” useAuthì—ì„œ ê°€ì ¸ì˜¤ì§€ ì•Šì•„ë„ ë˜ì§€ë§Œ, currentTenantê°€ í•„ìš”í•˜ë‹¤ë©´ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤.
  // ì´ í˜ì´ì§€ëŠ” requireSuperAdminì´ë¯€ë¡œ user ì •ë³´ëŠ” ë³´í˜¸ë©ë‹ˆë‹¤.
  const [contacts, setContacts] = useState<PressContact[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState("");
  // filterPurposeì˜ ì´ˆê¸°ê°’ì€ ë¹ˆ ë¬¸ìì—´("")ì´ë©°, ì´ëŠ” 'ì „ì²´'ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
  const [filterPurpose, setFilterPurpose] = useState<string>("");
  
  // Sheet ë° Dialog ìƒíƒœ
  const [isSheetOpen, setIsSheetOpen] = useState(false);
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [currentContact, setCurrentContact] = useState<PressContact | null>(null);
  const [isSaving, setIsSaving] = useState(false);

  // í¼ ë°ì´í„° ìƒíƒœ
  const [formData, setFormData] = useState({
    media_company: "",
    reporter_name: "",
    contact_phone: "",
    contact_email: "",
    purpose: "", // DBì— nullì´ ë“¤ì–´ê°€ì•¼ í•˜ë¯€ë¡œ ""ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©
  });

  // --- ë°ì´í„° ë¡œë“œ ---
  const fetchContacts = async () => {
    setLoading(true);
    let query = supabase.from("press_contacts").select("*").order("created_at", { ascending: false });
    
    // ê²€ìƒ‰ ì¿¼ë¦¬ ì ìš© (ì–¸ë¡ ì‚¬, ê¸°ìëª… OR ì¡°ê±´ ê²€ìƒ‰)
    if (searchQuery) {
      query = query.or(`media_company.ilike.%${searchQuery}%,reporter_name.ilike.%${searchQuery}%`);
    }
    // ëª©ì  í•„í„° ì ìš©: filterPurposeê°€ ""ì¼ ë•ŒëŠ” ì „ì²´ ì¡°íšŒ
    if (filterPurpose && filterPurpose !== "ALL") { // ALLì€ í•„í„°ë§ ì „ì²´ í•­ëª©ì„ ìœ„í•œ ì„ì‹œ ê°’
      query = query.eq("purpose", filterPurpose);
    }
    // 'ì„ íƒ ì•ˆ í•¨' í•­ëª©ì€ purposeê°€ nullì¸ ê²½ìš°ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
    if (filterPurpose === "N/A") {
      query = query.is("purpose", null);
    }


    const { data, error } = await query;
    
    if (error) {
      console.error("Error fetching press contacts:", error);
      // RLS ì—ëŸ¬ëŠ” ë³´í†µ ê¶Œí•œ ë¬¸ì œ(is_sys_super_admin í•¨ìˆ˜ ì˜¤ë¥˜ ë“±)ì´ë¯€ë¡œ ë””ë²„ê¹… ì•ˆë‚´
      toast.error("ì—°ë½ì²˜ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (DB/RLS ì •ì±… í™•ì¸ í•„ìš”)");
    } else {
      setContacts(data as PressContact[]);
    }
    setLoading(false);
  };

  // --- useEffect: ë°ì´í„° ë¡œë“œ ë° ì‹¤ì‹œê°„ êµ¬ë… ---
  useEffect(() => {
    fetchContacts();
    
    // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ êµ¬ë…: DB ë³€ê²½ ì‹œ ëª©ë¡ ìë™ ê°±ì‹ 
    const channel = supabase
      .channel('press_contacts_changes')
      .on('postgres_changes', 
        { event: '*', schema: 'public', table: 'press_contacts' }, 
        () => fetchContacts()
      )
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, [searchQuery, filterPurpose]); // ê²€ìƒ‰/í•„í„° ë³€ê²½ ì‹œ ì¬ì¡°íšŒ

  // --- CRUD í•¸ë“¤ëŸ¬: ì €ì¥ (Create/Update) ---
  const handleSave = async () => {
    if (!formData.media_company || !formData.reporter_name || !formData.contact_email) {
      toast.error("ì–¸ë¡ ì‚¬, ê¸°ìëª…, ì´ë©”ì¼ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.");
      return;
    }

    setIsSaving(true);
    try {
      // DBì— ì €ì¥í•  ìµœì¢… í˜ì´ë¡œë“œ
      const payload: Omit<PressContact, 'id' | 'created_at' | 'updated_at' | 'created_by'> = { 
        media_company: formData.media_company,
        reporter_name: formData.reporter_name,
        contact_email: formData.contact_email,
        contact_phone: formData.contact_phone || null,
        // purposeê°€ ""ì´ë©´ DBì— NULLì´ ë“¤ì–´ê°€ë„ë¡ ì²˜ë¦¬í•©ë‹ˆë‹¤.
        purpose: formData.purpose === "N/A" || !formData.purpose ? null : formData.purpose, 
      };

      if (currentContact) {
        // Update ëª¨ë“œ
        const { error } = await supabase
          .from("press_contacts")
          .update(payload)
          .eq("id", currentContact.id);
        if (error) throw error;
        toast.success(`${formData.media_company} ê¸°ì ì •ë³´ë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.`);
      } else {
        // Create ëª¨ë“œ
        const { error } = await supabase
          .from("press_contacts")
          .insert(payload);
        if (error) throw error;
        toast.success(`${formData.media_company} ê¸°ì ì •ë³´ë¥¼ ìƒˆë¡œ ë“±ë¡í–ˆìŠµë‹ˆë‹¤.`);
      }

      setIsSheetOpen(false);
    } catch (error: any) {
      console.error("Save error:", error);
      let errorMessage = error.message;
      if (error.code === '23505' && errorMessage.includes('contact_email')) {
          errorMessage = "ì´ë¯¸ ë“±ë¡ëœ ì´ë©”ì¼ ì£¼ì†Œì…ë‹ˆë‹¤. ì´ë©”ì¼ ì£¼ì†ŒëŠ” ì¤‘ë³µë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
      }
      toast.error(`ì €ì¥ ì‹¤íŒ¨: ${errorMessage}`);
    } finally {
      setIsSaving(false);
    }
  };

  // --- CRUD í•¸ë“¤ëŸ¬: ì‚­ì œ (Delete) ---
  const handleDelete = async () => {
    if (!currentContact) return;
    setIsSaving(true);
    try {
      const { error } = await supabase
        .from("press_contacts")
        .delete()
        .eq("id", currentContact.id);
      if (error) throw error;
      toast.success(`${currentContact.reporter_name} ê¸°ì ì •ë³´ë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.`);
      setIsDeleteDialogOpen(false);
    } catch (error: any) {
      toast.error(`ì‚­ì œ ì‹¤íŒ¨: ${error.message || "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}`);
    } finally {
      setIsSaving(false);
      setCurrentContact(null);
    }
  };

  // --- UI ìƒí˜¸ì‘ìš© ---
  const handleNewContact = () => {
    setCurrentContact(null);
    // í¼ ì´ˆê¸°í™” ì‹œ purposeëŠ” ë¹ˆ ë¬¸ìì—´("")ë¡œ ì´ˆê¸°í™”
    setFormData({ media_company: "", reporter_name: "", contact_phone: "", contact_email: "", purpose: "" }); 
    setIsSheetOpen(true);
  };

  const handleEditContact = (contact: PressContact) => {
    setCurrentContact(contact);
    // í¼ì— í˜„ì¬ ì—°ë½ì²˜ ì •ë³´ ì±„ìš°ê¸°: purposeê°€ nullì´ë©´ ë¹ˆ ë¬¸ìì—´("")ë¡œ ì±„ì›€
    setFormData({
      media_company: contact.media_company,
      reporter_name: contact.reporter_name,
      contact_phone: contact.contact_phone || "",
      contact_email: contact.contact_email,
      purpose: contact.purpose || "",
    });
    setIsSheetOpen(true);
  };

  const handleOpenDelete = (contact: PressContact) => {
    setCurrentContact(contact);
    setIsDeleteDialogOpen(true);
  };

  return (
    <div className="min-h-screen bg-background text-foreground">
      <Header />

      <main className="pt-24 pb-16 px-4 max-w-7xl mx-auto">
        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
          <div className="flex items-center gap-3">
            <button onClick={() => navigate("/super-admin")} className="text-muted-foreground hover:text-foreground">
              <ArrowLeft className="w-5 h-5" />
            </button>
            <div>
              <h1 className="text-3xl font-bold tracking-tight flex items-center gap-2">
                <Terminal className="w-6 h-6 text-primary" /> ë¯¸ë””ì–´ ì—°ë½ì²˜ ê´€ë¦¬
              </h1>
              <p className="text-muted-foreground mt-1">
                ì „ ê³ ê°ì‚¬ê°€ ê³µìœ í•  ìˆ˜ ìˆëŠ” ì–¸ë¡ ì‚¬/ê¸°ì í†µí•© ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤.
              </p>
            </div>
          </div>
          
          <Button variant="hero" className="gap-2" size="lg" onClick={handleNewContact}>
            <Plus className="w-5 h-5" /> ìƒˆ ì—°ë½ì²˜ ë“±ë¡
          </Button>
        </div>

        {/* í•„í„° ë° ê²€ìƒ‰ ë°” */}
        <Card className="glass-card shadow-sm border border-border mb-8">
          <CardContent className="pt-4 flex flex-col sm:flex-row gap-4">
            <div className="relative flex-1">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" />
              <Input 
                placeholder="ì–¸ë¡ ì‚¬, ê¸°ìëª…ìœ¼ë¡œ ê²€ìƒ‰" 
                className="pl-9 bg-secondary/50 border-none h-10 text-sm"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
              />
            </div>
            
            {/* [ìˆ˜ì • ë°˜ì˜] Select ì˜¤ë¥˜ ìˆ˜ì • ë° í•„í„°ë§ ë¡œì§ ê°•í™” */}
            <div className="flex items-center gap-2 w-full sm:w-auto">
              <Filter className="w-4 h-4 text-muted-foreground shrink-0" />
              <Select onValueChange={setFilterPurpose} value={filterPurpose}>
                <SelectTrigger className="w-full sm:w-[150px] bg-secondary/50 border-none h-10">
                  <SelectValue placeholder="ëª©ì  í•„í„°" />
                </SelectTrigger>
                <SelectContent>
                  {/* [ìˆ˜ì •] ë¹ˆ ë¬¸ìì—´ ëŒ€ì‹  ìœ íš¨í•œ ê°’ì„ ì‚¬ìš©í•˜ê±°ë‚˜, ì•„ì˜ˆ ì œê±° */}
                  {/* 'ì „ì²´'ì™€ 'ì„ íƒ ì•ˆ í•¨'ì„ í•„í„°ë§ ì˜µì…˜ìœ¼ë¡œ ëª…ì‹œ */}
                  <SelectItem value="ALL">ì „ì²´ ëª©ì </SelectItem> 
                  <SelectItem value="N/A">ëª©ì  ë¯¸ì§€ì •</SelectItem> 
                  {purposeOptions.map(p => <SelectItem key={p} value={p}>{p}</SelectItem>)}
                </SelectContent>
              </Select>
            </div>
                        
            <Button variant="outline" className="w-full sm:w-auto" onClick={() => { setSearchQuery(""); setFilterPurpose(""); }}>
              ì´ˆê¸°í™”
            </Button>
          </CardContent>
        </Card>

        {/* ì—°ë½ì²˜ ëª©ë¡ í…Œì´ë¸” */}
        <div className="glass-card overflow-hidden shadow-sm border border-border">
          <Table>
            <TableHeader className="bg-secondary/50">
              <TableRow>
                <TableHead className="w-[150px]">ì–¸ë¡ ì‚¬</TableHead>
                <TableHead className="w-[120px]">ê¸°ìëª…</TableHead>
                <TableHead>ì´ë©”ì¼</TableHead>
                <TableHead>ì—°ë½ì²˜</TableHead>
                <TableHead className="w-[150px]">ëª©ì </TableHead>
                <TableHead className="text-right w-[80px]">ì•¡ì…˜</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {loading ? (
                <TableRow><TableCell colSpan={6} className="h-32 text-center"><Loader2 className="w-8 h-8 animate-spin mx-auto text-primary" /></TableCell></TableRow>
              ) : contacts.length > 0 ? (
                contacts.map((contact) => (
                  <TableRow key={contact.id} className="hover:bg-secondary/30 transition-colors">
                    <TableCell className="font-semibold text-sm">{contact.media_company}</TableCell>
                    <TableCell className="text-sm">{contact.reporter_name}</TableCell>
                    <TableCell className="text-sm text-primary flex items-center gap-2">
                        <Mail className="w-3 h-3 text-muted-foreground" />
                        {contact.contact_email}
                    </TableCell>
                    <TableCell className="text-sm text-muted-foreground flex items-center gap-2">
                        <Phone className="w-3 h-3" />
                        {contact.contact_phone || "-"}
                    </TableCell>
                    <TableCell className="text-xs text-muted-foreground">{contact.purpose || "ë¯¸ì§€ì •"}</TableCell>
                    <TableCell className="text-right">
                        <Button variant="ghost" size="icon" className="w-8 h-8" onClick={() => handleEditContact(contact)}>
                            <Edit2 className="w-4 h-4 text-blue-500" />
                        </Button>
                        <Button variant="ghost" size="icon" className="w-8 h-8 text-destructive" onClick={() => handleOpenDelete(contact)}>
                            <Trash2 className="w-4 h-4" />
                        </Button>
                    </TableCell>
                  </TableRow>
                ))
              ) : (
                <TableRow><TableCell colSpan={6} className="h-32 text-center text-muted-foreground">ë“±ë¡ëœ ë¯¸ë””ì–´ ì—°ë½ì²˜ê°€ ì—†ìŠµë‹ˆë‹¤.</TableCell></TableRow>
              )}
            </TableBody>
          </Table>
        </div>
      </main>
      
      {/* --- ì—°ë½ì²˜ ì¶”ê°€/ìˆ˜ì • Sheet --- */}
      <Sheet open={isSheetOpen} onOpenChange={setIsSheetOpen}>
        <SheetContent className="sm:max-w-md p-0 overflow-hidden flex flex-col">
          <SheetHeader className="p-6 border-b">
            <SheetTitle className="text-xl font-bold flex items-center gap-2">
                <Users className="w-5 h-5 text-primary" /> 
                {currentContact ? "ì—°ë½ì²˜ ìˆ˜ì •" : "ìƒˆ ì—°ë½ì²˜ ë“±ë¡"}
            </SheetTitle>
          </SheetHeader>
          <div className="p-6 space-y-6 overflow-y-auto flex-1">
            <div className="space-y-2">
              <Label htmlFor="media_company">ì–¸ë¡ ì‚¬/ë§¤ì²´ëª… *</Label>
              <Input 
                id="media_company" 
                placeholder="ì˜ˆ: ì¡°ì„ ì¼ë³´, ë¸”ë¡œí„°" 
                value={formData.media_company} 
                onChange={(e) => setFormData({...formData, media_company: e.target.value})}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="reporter_name">ê¸°ìëª… *</Label>
              <Input 
                id="reporter_name" 
                placeholder="ì˜ˆ: í™ê¸¸ë™" 
                value={formData.reporter_name} 
                onChange={(e) => setFormData({...formData, reporter_name: e.target.value})}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="contact_email">ì´ë©”ì¼ *</Label>
              <Input 
                id="contact_email" 
                type="email"
                placeholder="reporter@media.com" 
                value={formData.contact_email} 
                onChange={(e) => setFormData({...formData, contact_email: e.target.value})}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="contact_phone">ì—°ë½ì²˜</Label>
              <Input 
                id="contact_phone" 
                placeholder="010-0000-0000" 
                value={formData.contact_phone} 
                onChange={(e) => setFormData({...formData, contact_phone: e.target.value})}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="purpose">ëª©ì  (í•„í„°ë§ ìš©ë„)</Label>
              <Select value={formData.purpose} onValueChange={(val) => setFormData({...formData, purpose: val})}>
                <SelectTrigger id="purpose">
                  <SelectValue placeholder="ëª©ì  ì„ íƒ" />
                </SelectTrigger>
                <SelectContent>
                  {/* [ìˆ˜ì •] Select ì˜¤ë¥˜ë¥¼ ë§‰ê¸° ìœ„í•´ ìœ íš¨í•œ ê°’('N/A')ì„ ì‚¬ìš©í•˜ê³ , 
                       DBì—ëŠ” nullì´ ë“¤ì–´ê°€ë„ë¡ í•¸ë“¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤. */}
                  <SelectItem value="N/A">ì„ íƒ ì•ˆ í•¨</SelectItem> 
                  {purposeOptions.map(p => <SelectItem key={p} value={p}>{p}</SelectItem>)}
                </SelectContent>
              </Select>
            </div>
          </div>
          <SheetFooter className="p-6 border-t">
            <SheetClose asChild>
              <Button variant="outline" disabled={isSaving}>ì·¨ì†Œ</Button>
            </SheetClose>
            <Button onClick={handleSave} disabled={isSaving || !formData.media_company || !formData.reporter_name || !formData.contact_email}>
              {isSaving ? <Loader2 className="w-4 h-4 mr-2 animate-spin" /> : <Save className="w-4 h-4 mr-2" />}
              {currentContact ? "ìˆ˜ì • ì™„ë£Œ" : "ë“±ë¡"}
            </Button>
          </SheetFooter>
        </SheetContent>
      </Sheet>

      {/* --- ì‚­ì œ í™•ì¸ AlertDialog --- */}
      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="text-destructive font-bold text-xl">ì—°ë½ì²˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</AlertDialogTitle>
            <AlertDialogDescription className="py-2">
              **{currentContact?.reporter_name} ê¸°ì ({currentContact?.media_company})**ì˜ ì—°ë½ì²˜ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel disabled={isSaving}>ì·¨ì†Œ</AlertDialogCancel>
            <AlertDialogAction 
                onClick={handleDelete} 
                disabled={isSaving} 
                className="bg-destructive hover:bg-destructive/90 text-destructive-foreground"
            >
              {isSaving ? <Loader2 className="w-4 h-4 mr-2 animate-spin" /> : <Trash2 className="w-4 h-4 mr-2" />}
              ì‚­ì œ í™•ì •
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>

    </div>
  );
};

export default PressContacts;


============================================================
File Path: src/test/example.test.ts
============================================================
import { describe, it, expect } from "vitest";

describe("example", () => {
  it("should pass", () => {
    expect(true).toBe(true);
  });
});



============================================================
File Path: src/test/setup.ts
============================================================
import "@testing-library/jest-dom";

Object.defineProperty(window, "matchMedia", {
  writable: true,
  value: (query: string) => ({
    matches: false,
    media: query,
    onchange: null,
    addListener: () => {},
    removeListener: () => {},
    addEventListener: () => {},
    removeEventListener: () => {},
    dispatchEvent: () => {},
  }),
});

